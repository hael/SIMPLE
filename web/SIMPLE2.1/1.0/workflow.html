<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><!-- InstanceBegin template="/Templates/template.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- InstanceBeginEditable name="doctitle" -->
<title>overview of single-particle cryo-electron microscopy reconstruction with SIMPLE</title>
<!-- InstanceEndEditable -->
<style type="text/css">
body,td,th {
	color: #FFFFFF;
}
body {
	background-image: url(../images/fractal.jpg);
	background-attachment: fixed;
	margin-top: 0px;
	margin-right: 0px;
	margin-bottom: 0px;
	margin-left: 0px;
	background-color: rgb(0,0,0);
	background-repeat: repeat;
}
</style>
<link href="../common_styles.css" rel="stylesheet" type="text/css">
<script src="../SpryAssets/SpryMenuBar.js" type="text/javascript"></script>
<link href="../SpryAssets/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css">
<!-- InstanceBeginEditable name="head" -->
<style type="text/css"></style>
<script src="SpryAssets/SpryAccordion.js" type="text/javascript"></script>
<link href="SpryAssets/SpryAccordion.css" rel="stylesheet" type="text/css">
<!-- InstanceEndEditable -->
<script type="text/xml">
<!--
<oa:widgets>
  <oa:widget wid="2149022" binding="#OAWidget" />
</oa:widgets>
-->
</script>
<style type="text/css">
a:link {
	color: rgb(153,0,51);
}
a:visited {
	color: rgb(187,0,62);
}
a:hover {
	color: rgb(187,0,62);
}
a:active {
	color: rgb(187,0,62);
}
h1,h2,h3,h4,h5,h6 {
	font-family: Verdana, Geneva, sans-serif;
}
h1 {
	color: rgb(0,0,0);
}
h2 {
	font-size: 18px;
	color: rgb(153,0,0);
}
</style>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31924791-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<link rel="shortcut icon" href="http://simplecryoem.com/favicon.ico" >
</head>

<body bgcolor="#000000">
<a name="top"></a>
<div class="logo_div"><img src="../images/SIMPLE_banner.png" alt="SIMPLE banner" width="830" height="110" align="absmiddle"></div>
<div class="nav_div">
  <ul id="MenuBar1" class="MenuBarHorizontal">
    <li><a href="../index.html">About</a>    </li>
    <li><a href="../download_form.html">Download</a></li>
    <li><a href="../workflow.html">Workflow</a></li>
    <li><a href="../manuals.html">Manuals</a></li>
    <li><a href="../structures.html">Structures</a></li>
    <li><a href="../references.html">References</a></li>
    <li><a href="../contact.html">Contact </a></li>
  </ul>
</div>
<!-- InstanceBeginEditable name="EditRegion1" -->
<div class="content_div">
  <h1>Overview of single-particle reconstruction with SIMPLE 1.0</h1>
  <p class="text">&nbsp; <strong>SIMPLE 1.0</strong> is not a standalone suite for single-particle reconstruction, but complements existing developments. It is assumed that the windowed single-particle images represent 2D projections, and therefore, that the projection slice theorem applies (Bracewell, 1956). This requires correction of the micrographs due to the contrast transfer function (CTF) of the electron microscope and particle windowing using other software. In addition, the windowed projections should be roughly centered in the box. Many program suites are available for dealing with these and other matters (Frank et al., 1996; Hohn et al., 2007; Ludtke et al., 1999; Sorzano et al., 2004). In EMAN, the envelope component of the CTF, describing the fall-off of the signal with resolution, is parameterized and then used in the class averaging procedure in the refinement. Some implementations only phase-corrects the micrographs, ignoring the envelope function initially. Instead, the final refined maps are B-factor sharpened. SIMPLE 1.0 has so far been use in combination with the latter approach, assuming the same resolution fall-off for all micrographs. The <strong>SIMPLE 1.0</strong> workflow is divided into four phases: </p>
  <p class="text">&nbsp;</p>
  <div id="Accordion1">
    <div class="AccordionPanel">
      <div class="AccordionPanelTab">1) CTF correction and particle windowing</div>
      <div class="AccordionPanelContent"><p>&nbsp; We usually execute phase (1) by parameterizing the CTF with <a href="http://http://grigoriefflab.janelia.org/ctf" title="Ctffind3 software" target="_new">Ctffid3</a> (Mindell and Grigorieff, 2003), doing CTF phase correction of the micrographs in <a href="http://www.wadsworth.org/spider_doc/spider/docs/spider.html" title="Spider software" target="_new">Spider</a> (Frank et al., 1996), and using EMAN&rsquo;s (Ludtke et al., 1999) program <a href="http://blake.bcm.edu/emanwiki/EMAN1/Programs/Boxer" title="boxer software" target="_new">BOXER</a> for particle windowing. <a href="http://blake.bcm.edu/emanwiki/EMAN2" title="EMAN software" target="_new">EMAN</a>&rsquo;s graphical user interface is used for quick inspection of volumes and class averages. <a href="http://www.cgl.ucsf.edu/chimera/" title="chimera software" target="_new">UCSF Chimera</a> is used for more detailed analysis of the reconstructed volumes (Pettersen et al., 2004). Phases (2)-(4) are executed with <strong>SIMPLE 1.0</strong>.</p></div>
    </div>
    <div class="AccordionPanel">
      <div class="AccordionPanelTab">2) Ab initio reconstruction</div>
      <div class="AccordionPanelContent">
        <p>&nbsp; Program <strong>cluster</strong> aligns the images with the reference-free 2D alignment algorithm, clusters them, and calculates class averages. The outputted class averages are inputted to program <strong>origami,</strong> which optimizes the spectral ensemble common line correlation with simulated annealing (<a href="http://www.ncbi.nlm.nih.gov/pubmed/20637414" target="_new">Elmlund et al., 2010</a>). The search space of the annealing is composed of projection directions <em>only</em>. Consequently, many thousands of class averages can be aligned in a few hours on a present generation workstation. The annealing is restarted three times on random starting configurations. The best of the three solutions is subjected to further optimization. The second optimization step includes the additional origin shift and conformational state parameters in a greedy adaptive local search-based scheme, steering a differential evolution optimizer (Das et al., 2009; Feo and Resende, 1995). Output from <strong>origami </strong>consists of alignment documents and reconstructed volumes. <strong>Origami</strong> offers the possibility to partition the data over multiple state groups. At this stage, however, it is seldom meaningful to attempt heterogeneity analysis, since the in-plane alignment is too crude for the classification to provide the required resolution. For implementation details, see the open SIMPLE 1.0 source code (classes <em>simple_comlin, simple_comlin_corr, simple_rfree_search, simple_sa_opt </em>and <em>simple_de_opt</em>).</p></div>
    </div>
    <div class="AccordionPanel">
      <div class="AccordionPanelTab">3) Heterogeneity analysis via bijective orientation search<a name="hetanal"></a></div>
      <div class="AccordionPanelContent">
        <p>&nbsp; Accurate in-plane alignment is required for the unsupervised classification to produce homogeneous class averages (<a href="http://www.ncbi.nlm.nih.gov/pubmed/20637414" target="_new">Elmlund et al., 2010</a>). The approximate in-plane alignment obtained by the reference-free 2D alignment algorithm therefore needs refinement. In <strong>SIMPLE 1.0</strong>, projection matching onto the <em>ab initio </em>reconstruction is applied to refine the in-plane degrees of freedom. The continuous, Fourier-based projection matching executed by programs <strong>cycler </strong>or <strong>align </strong>searches all degrees of freedom. The refined in-plane parameters are inputted to program <strong>cluster</strong> that generates class averages with improved resolution. These averages are again subjected to <em>ab initio</em> alignment and heterogeneity analysis in program <strong>origami</strong><em>,</em> which searches projection directions and state assignments <em>only</em>. After the first approximate <em>ab initio </em>reconstruction has been obtained, a single iteration of bijective orientation search is composed of:</p>
        <ol>
          <li>Projection matching to align the data in-plane (programs <strong>align</strong> or <strong>cycler</strong>)</li>
          <li>Probabilistic PCA, clustering of feature vectors, and calculation of class averages (program <strong>cluster</strong>)</li>
          <li>Reference-free common lines-based search over projection directions and state assignments  <em>only. </em>Volume reconstruction by Fourier gridding (program <strong>origami</strong>)</li>
        </ol>
      <p>The process is iterated until the structural features of the reconstructions and the number of states is consistent between successive rounds. Partitioning the data into different number of state groups is fast and usually uncovers the suitable number of states to reconstruct. The bijective orientation search method reduces computational complexity, is free from reference bias, and enables efficient reconstruction of flexible single-particles. After convergence, single-particle refinement is applied as has been done by others to improve the resolution of the maps.</p></div>
    </div>
    <div class="AccordionPanel">
      <div class="AccordionPanelTab">4) Refinement</div>
      <div class="AccordionPanelContent">
      <p>The <strong>align</strong>, <strong>reconstruct</strong>, and <strong>automask</strong> programs are iterated to accomplish  high-resolution refinement. Program <strong>cycler</strong> combines these components  into a single executable that is suitable for shared-memory  multi-processor architectures, since the parallelization is based on the  OpenMP protocol. For clusters we recommend distributed execution via  <strong>partition_master.pl</strong> found in the <strong>apps</strong> folder.</p></div>
    </div>
  </div>
  <p class="text">&nbsp;</p>
  <p class="text">  <img src="images/heterogeneity_analysis_by_SIMPLE.png" alt="heterogeneity analysis by SIMPLE" width="650" height="600" align="middle"></p>
 <p class="text">&nbsp;</p>
 <p class="text"><strong><a name="constraints"></a>Heterogeneity analysis via bijective orientation search.</strong> Programs, flow of data, constraints, and parameters. <em>N</em> is number of   images, <em>C</em> is number of clusters. The 3D reference-based alignment searches all degrees of freedom: the Euler angles, the origin shifts, and the state assignments. The reference-based output is used to align the data in-plane before image clustering. Class averages are subjected to reference-free common lines-based assignment of projection directions and states. A first approximate 3D alignment is obtained in a discrete angular space composed of projection directions <em>only</em>, subject to the constraint that no two averages are allowed to occupy the same direction. A differential evolution algorithm searches the remaining parameters. Unbiased volumes are reconstructed and used for another round of projection matching.</p>
  <h2 class="h2_manual" align="center"><a href="#top">top</a></h2>
  <p>&nbsp;</p>
</div>
<script type="text/javascript">
var Accordion1 = new Spry.Widget.Accordion("Accordion1", { useFixedPanelHeights: false, defaultPanel: -1 });
</script>
<!-- InstanceEndEditable -->
<h1>&nbsp;</h1>
<script type="text/javascript">
var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgDown:"SpryAssets/SpryMenuBarDownHover.gif", imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
</script>
</body>
<!-- InstanceEnd --></html>
