FLNAME=`basename $1 .f90`

MODDIR=../../../trunk/modules/compiled/GFORT/
OBJDIR=../../../trunk/modules/compiled/GFORT/

ROOT_MAGMA=/home/fbonnet/PostDoc/SourceCode_2/TB_Sim/trunk/modules

MAGMADIR_LIB=magma_1.0.0-rc4/lib
MAGMADIR_SOURCE=magma_1.0.0-rc4/src
MAGMADIR_MAGMABLAS=magma_1.0.0-rc4/magmablas

ROOTDIR=/local/fbonnet/

SHARE_LIB=/NVIDIA_GPU_Computing_SDK/shared/lib/
OPENCL_COMMON_LIB=/NVIDIA_GPU_Computing_SDK/OpenCL/common/lib/

OPENCL_COMMON=/NVIDIA_GPU_Computing_SDK/OpenCL/common/obj/release
OPENCC_COMMON=/NVIDIA_GPU_Computing_SDK/C/common/obj/x86_64/release
OPENCL_SHAREDDIR=/NVIDIA_GPU_Computing_SDK/shared/obj/x86_64/release/

OPTION="-ffree-form -cpp -O3 -fPIC -fno-second-underscore -DBENCH -DMAGMA"
gfortran $OPTION -I $MODDIR -c $FLNAME.o $FLNAME.f90

gfortran -o $FLNAME                                          \
       	    $FLNAME.o                                        \
            $OBJDIR/*.o                                      \
            $OBJDIR/lapack95/*.o                             \
            $OBJDIR/Zgetri/lapack/complex16/*.o              \
            $OBJDIR/Zgetri/lapack/util/*.o                   \
	    -lblas                                           \
	    -llapack                                         \
            -lstdc++                                         \
	    -lrt                                             \
	    -lOpenCL                                         \
	    -L $ROOTDIR/$SHARE_LIB -lshrutil_x86_64          \
	    -L $ROOTDIR/$OPENCL_COMMON_LIB -loclUtil_x86_64  \
	    -L $ROOT_MAGMA/$MAGMADIR_LIB -lmagma             \
	    -L $ROOT_MAGMA/$MAGMADIR_LIB -lmagmablas	     \
	    -lcuda                                           \
            -lcublas                                         \
            -llapack                                         \
	    -lpthread                                        \
            -lcudart                                         \
	    -lm                                              \
	    -L /usr/local/cuda/lib64

#$ROOTDIR/$OPENCL_COMMON/oclUtils.cpp.o $ROOTDIR/$OPENCL_SHAREDDIR/shrUtils.cpp.o $ROOTDIR/$OPENCL_SHAREDDIR/cmd_arg_reader.cpp.o
