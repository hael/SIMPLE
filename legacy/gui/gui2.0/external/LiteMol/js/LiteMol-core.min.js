var __LiteMol_Core=function(){"use strict";/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   3.2.1
 */
var t=function(t){"use strict";function e(t){return typeof t==="function"||typeof t==="object"&&t!==null}function r(t){return typeof t==="function"}function n(t){return typeof t==="object"&&t!==null}var i;if(!Array.isArray){i=function(t){return Object.prototype.toString.call(t)==="[object Array]"}}else{i=Array.isArray}var o=i;var s=0;var a;var u;var c=function t(e,r){C[s]=e;C[s+1]=r;s+=2;if(s===2){if(u){u(x)}else{I()}}};function f(t){u=t}function l(t){c=t}var h=typeof window!=="undefined"?window:undefined;var d=h||{};var p=d.MutationObserver||d.WebKitMutationObserver;var v=typeof self==="undefined"&&typeof process!=="undefined"&&{}.toString.call(process)==="[object process]";var m=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function g(){return function(){process.nextTick(x)}}function y(){return function(){a(x)}}function b(){var t=0;var e=new p(x);var r=document.createTextNode("");e.observe(r,{characterData:true});return function(){r.data=t=++t%2}}function _(){var t=new MessageChannel;t.port1.onmessage=x;return function(){t.port2.postMessage(0)}}function w(){return function(){setTimeout(x,1)}}var C=new Array(1e3);function x(){for(var t=0;t<s;t+=2){var e=C[t];var r=C[t+1];e(r);C[t]=undefined;C[t+1]=undefined}s=0}var I;if(v){I=g()}else if(p){I=b()}else if(m){I=_()}else{I=w()}function S(t,e){var r=this;var n=new this.constructor(T);if(n[P]===undefined){et(n)}var i=r._state;if(i){var o=arguments[i-1];c(function(){K(i,n,o,r._result)})}else{H(r,n,t,e)}return n}var A=S;function k(t){var e=this;if(t&&typeof t==="object"&&t.constructor===e){return t}var r=new e(T);j(r,t);return r}var E=k;var P=Math.random().toString(36).substring(16);function T(){}var F=void 0;var M=1;var D=2;var N=new Z;function R(){return new TypeError("You cannot resolve a promise with itself")}function q(){return new TypeError("A promises callback cannot return that same promise.")}function U(t){try{return t.then}catch(t){N.error=t;return N}}function O(t,e,r,n){try{t.call(e,r,n)}catch(t){return t}}function B(t,e,r){c(function(t){var n=false;var i=O(r,e,function(r){if(n){return}n=true;if(e!==r){j(t,r)}else{X(t,r)}},function(e){if(n){return}n=true;Y(t,e)},"Settle: "+(t._label||" unknown promise"));if(!n&&i){n=true;Y(t,i)}},t)}function L(t,e){if(e._state===M){X(t,e._result)}else if(e._state===D){Y(t,e._result)}else{H(e,undefined,function(e){j(t,e)},function(e){Y(t,e)})}}function z(t,e,n){if(e.constructor===t.constructor&&n===A&&constructor.resolve===E){L(t,e)}else{if(n===N){Y(t,N.error)}else if(n===undefined){X(t,e)}else if(r(n)){B(t,e,n)}else{X(t,e)}}}function j(t,r){if(t===r){Y(t,R())}else if(e(r)){z(t,r,U(r))}else{X(t,r)}}function V(t){if(t._onerror){t._onerror(t._result)}G(t)}function X(t,e){if(t._state!==F){return}t._result=e;t._state=M;if(t._subscribers.length!==0){c(G,t)}}function Y(t,e){if(t._state!==F){return}t._state=D;t._result=e;c(V,t)}function H(t,e,r,n){var i=t._subscribers;var o=i.length;t._onerror=null;i[o]=e;i[o+M]=r;i[o+D]=n;if(o===0&&t._state){c(G,t)}}function G(t){var e=t._subscribers;var r=t._state;if(e.length===0){return}var n,i,o=t._result;for(var s=0;s<e.length;s+=3){n=e[s];i=e[s+r];if(n){K(r,n,i,o)}else{i(o)}}t._subscribers.length=0}function Z(){this.error=null}var Q=new Z;function W(t,e){try{return t(e)}catch(t){Q.error=t;return Q}}function K(t,e,n,i){var o=r(n),s,a,u,c;if(o){s=W(n,i);if(s===Q){c=true;a=s.error;s=null}else{u=true}if(e===s){Y(e,q());return}}else{s=i;u=true}if(e._state!==F){}else if(o&&u){j(e,s)}else if(c){Y(e,a)}else if(t===M){X(e,s)}else if(t===D){Y(e,s)}}function J(t,e){try{e(function e(r){j(t,r)},function e(r){Y(t,r)})}catch(e){Y(t,e)}}var $=0;function tt(){return $++}function et(t){t[P]=$++;t._state=undefined;t._result=undefined;t._subscribers=[]}function rt(t){return new ht(this,t).promise}var nt=rt;function it(t){var e=this;if(!o(t)){return new e(function(t,e){e(new TypeError("You must pass an array to race."))})}else{return new e(function(r,n){var i=t.length;for(var o=0;o<i;o++){e.resolve(t[o]).then(r,n)}})}}var ot=it;function st(t){var e=this;var r=new e(T);Y(r,t);return r}var at=st;function ut(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ct(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var ft=lt;function lt(t){this[P]=tt();this._result=this._state=undefined;this._subscribers=[];if(T!==t){typeof t!=="function"&&ut();this instanceof lt?J(this,t):ct()}}lt.all=nt;lt.race=ot;lt.resolve=E;lt.reject=at;lt._setScheduler=f;lt._setAsap=l;lt._asap=c;lt.prototype={constructor:lt,then:A,catch:function(t){return this.then(null,t)}};var ht=dt;function dt(t,e){this._instanceConstructor=t;this.promise=new t(T);if(!this.promise[P]){et(this.promise)}if(Array.isArray(e)){this._input=e;this.length=e.length;this._remaining=e.length;this._result=new Array(this.length);if(this.length===0){X(this.promise,this._result)}else{this.length=this.length||0;this._enumerate();if(this._remaining===0){X(this.promise,this._result)}}}else{Y(this.promise,pt())}}function pt(){return new Error("Array Methods must be provided an Array")}dt.prototype._enumerate=function(){var t=this.length;var e=this._input;for(var r=0;this._state===F&&r<t;r++){this._eachEntry(e[r],r)}};dt.prototype._eachEntry=function(t,e){var r=this._instanceConstructor;var n=r.resolve;if(n===E){var i=U(t);if(i===A&&t._state!==F){this._settledAt(t._state,e,t._result)}else if(typeof i!=="function"){this._remaining--;this._result[e]=t}else if(r===ft){var o=new r(T);z(o,t,i);this._willSettleAt(o,e)}else{this._willSettleAt(new r(function(e){e(t)}),e)}}else{this._willSettleAt(n(t),e)}};dt.prototype._settledAt=function(t,e,r){var n=this.promise;if(n._state===F){this._remaining--;if(t===D){Y(n,r)}else{this._result[e]=r}}if(this._remaining===0){X(n,this._result)}};dt.prototype._willSettleAt=function(t,e){var r=this;H(t,undefined,function(t){r._settledAt(M,e,t)},function(t){r._settledAt(D,e,t)})};function vt(){var t;if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}}var e=t.Promise;if(e&&Object.prototype.toString.call(e.resolve())==="[object Promise]"&&!e.cast){return}t.Promise=ft}var mt=vt;var gt={Promise:ft,polyfill:mt};mt();t.ES6Promise=gt};var e;if(typeof window!=="undefined"&&window&&window.Promise){e=window.Promise}else if(typeof global!=="undefined"&&global&&global.Promise){e=global.Promise}else{var r={};t(r);e=r.ES6Promise.Promise}
// Copyright (c) Microsoft, All rights reserved. See License.txt in the project root for license information.
/*
 * Copyright (c) Microsoft.  All rights reserved.
Microsoft Open Technologies would like to thank its contributors, a list
of whom are at http://rx.codeplex.com/wikipage?title=Contributors.

Licensed under the Apache License, Version 2.0 (the "License"); you
may not use this file except in compliance with the License. You may
obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
implied. See the License for the specific language governing permissions
and limitations under the License.
 * 
 */
var n={};(function(t,e,r){var n={function:true,object:true};function i(t){return t&&t.Object===Object?t:null}var o=n[typeof exports]&&exports&&!exports.nodeType?exports:null;var s=n[typeof module]&&module&&!module.nodeType?module:null;var a=i(o&&s&&typeof global==="object"&&global);var u=i(n[typeof self]&&self);var c=i(n[typeof window]&&window);var f=s&&s.exports===o?o:null;var l=i(n[typeof this]&&this);var h=a||c!==(l&&l.window)&&c||u||l||Function("return this")();var d={internals:{},config:{Promise:e},helpers:{}};var p=d.helpers.noop=function(){},v=d.helpers.identity=function(t){return t},m=d.helpers.defaultNow=Date.now,g=d.helpers.defaultComparer=function(t,e){return Lt(t,e)},y=d.helpers.defaultSubComparer=function(t,e){return t>e?1:t<e?-1:0},b=d.helpers.defaultKeySerializer=function(t){return t.toString()},_=d.helpers.defaultError=function(t){throw t},w=d.helpers.isPromise=function(t){return!!t&&typeof t.subscribe!=="function"&&typeof t.then==="function"},C=d.helpers.isFunction=function(){var t=function(t){return typeof t=="function"||false};if(t(/x/)){t=function(t){return typeof t=="function"&&toString.call(t)=="[object Function]"}}return t}();function x(t){var e=t.length,r=new Array(e);for(var n=0;n<e;n++){r[n]=t[n]}return r}var I={e:{}};function S(t){return function e(){try{return t.apply(this,arguments)}catch(t){I.e=t;return I}}}var A=d.internals.tryCatch=function t(e){if(!C(e)){throw new TypeError("fn must be a function")}return S(e)};function k(t){throw t}d.config.longStackSupport=false;var E=false,P=A(function(){throw new Error})();E=!!P.e&&!!P.e.stack;var T=U(),F;var M="From previous event:";function D(t,e){if(E&&e.stack&&typeof t==="object"&&t!==null&&t.stack&&t.stack.indexOf(M)===-1){var r=[];for(var n=e;!!n;n=n.source){if(n.stack){r.unshift(n.stack)}}r.unshift(t.stack);var i=r.join("\n"+M+"\n");t.stack=N(i)}}function N(t){var e=t.split("\n"),r=[];for(var n=0,i=e.length;n<i;n++){var o=e[n];if(!R(o)&&!q(o)&&o){r.push(o)}}return r.join("\n")}function R(t){var e=O(t);if(!e){return false}var r=e[0],n=e[1];return r===F&&n>=T&&n<=Ti}function q(t){return t.indexOf("(module.js:")!==-1||t.indexOf("(node.js:")!==-1}function U(){if(!E){return}try{throw new Error}catch(n){var t=n.stack.split("\n");var e=t[0].indexOf("@")>0?t[1]:t[2];var r=O(e);if(!r){return}F=r[0];return r[1]}}function O(t){var e=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(e){return[e[1],Number(e[2])]}var r=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(r){return[r[1],Number(r[2])]}var n=/.*@(.+):(\d+)$/.exec(t);if(n){return[n[1],Number(n[2])]}}var B=d.EmptyError=function(){this.message="Sequence contains no elements.";Error.call(this)};B.prototype=Object.create(Error.prototype);B.prototype.name="EmptyError";var L=d.ObjectDisposedError=function(){this.message="Object has been disposed";Error.call(this)};L.prototype=Object.create(Error.prototype);L.prototype.name="ObjectDisposedError";var z=d.ArgumentOutOfRangeError=function(){this.message="Argument out of range";Error.call(this)};z.prototype=Object.create(Error.prototype);z.prototype.name="ArgumentOutOfRangeError";var j=d.NotSupportedError=function(t){this.message=t||"This operation is not supported";Error.call(this)};j.prototype=Object.create(Error.prototype);j.prototype.name="NotSupportedError";var V=d.NotImplementedError=function(t){this.message=t||"This operation is not implemented";Error.call(this)};V.prototype=Object.create(Error.prototype);V.prototype.name="NotImplementedError";var X=d.helpers.notImplemented=function(){throw new V};var Y=d.helpers.notSupported=function(){throw new j};var H=typeof Symbol==="function"&&Symbol.iterator||"_es6shim_iterator_";if(h.Set&&typeof(new h.Set)["@@iterator"]==="function"){H="@@iterator"}var G=d.doneEnumerator={done:true,value:r};var Z=d.helpers.isIterable=function(t){return t&&t[H]!==r};var Q=d.helpers.isArrayLike=function(t){return t&&t.length!==r};d.helpers.iterator=H;var W=d.internals.bindCallback=function(t,e,r){if(typeof e==="undefined"){return t}switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}};var K=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],J=K.length;var $="[object Arguments]",tt="[object Array]",et="[object Boolean]",rt="[object Date]",nt="[object Error]",it="[object Function]",ot="[object Map]",st="[object Number]",at="[object Object]",ut="[object RegExp]",ct="[object Set]",ft="[object String]",lt="[object WeakMap]";var ht="[object ArrayBuffer]",dt="[object Float32Array]",pt="[object Float64Array]",vt="[object Int8Array]",mt="[object Int16Array]",gt="[object Int32Array]",yt="[object Uint8Array]",bt="[object Uint8ClampedArray]",_t="[object Uint16Array]",wt="[object Uint32Array]";var Ct={};Ct[dt]=Ct[pt]=Ct[vt]=Ct[mt]=Ct[gt]=Ct[yt]=Ct[bt]=Ct[_t]=Ct[wt]=true;Ct[$]=Ct[tt]=Ct[ht]=Ct[et]=Ct[rt]=Ct[nt]=Ct[it]=Ct[ot]=Ct[st]=Ct[at]=Ct[ut]=Ct[ct]=Ct[ft]=Ct[lt]=false;var xt=Object.prototype,It=xt.hasOwnProperty,St=xt.toString,At=Math.pow(2,53)-1;var kt=Object.keys||function(){var t=Object.prototype.hasOwnProperty,e=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=r.length;return function(i){if(typeof i!=="object"&&(typeof i!=="function"||i===null)){throw new TypeError("Object.keys called on non-object")}var o=[],s,a;for(s in i){if(t.call(i,s)){o.push(s)}}if(e){for(a=0;a<n;a++){if(t.call(i,r[a])){o.push(r[a])}}}return o}}();function Et(t,e,n,i,o,s){var a=kt(t),u=a.length,c=kt(e),f=c.length;if(u!==f&&!i){return false}var l=u,h;while(l--){h=a[l];if(!(i?h in e:It.call(e,h))){return false}}var d=i;while(++l<u){h=a[l];var p=t[h],v=e[h],m;if(!(m===r?n(p,v,i,o,s):m)){return false}d||(d=h==="constructor")}if(!d){var g=t.constructor,y=e.constructor;if(g!==y&&("constructor"in t&&"constructor"in e)&&!(typeof g==="function"&&g instanceof g&&typeof y==="function"&&y instanceof y)){return false}}return true}function Pt(t,e,r){switch(r){case et:case rt:return+t===+e;case nt:return t.name===e.name&&t.message===e.message;case st:return t!==+t?e!==+e:t===+e;case ut:case ft:return t===e+""}return false}var Tt=d.internals.isObject=function(t){var e=typeof t;return!!t&&(e==="object"||e==="function")};function Ft(t){return!!t&&typeof t==="object"}function Mt(t){return typeof t==="number"&&t>-1&&t%1===0&&t<=At}var Dt=function(){try{Object({toString:0}+"")}catch(t){return function(){return false}}return function(t){return typeof t.toString!=="function"&&typeof(t+"")==="string"}}();function Nt(t){return Ft(t)&&Mt(t.length)&&!!Ct[St.call(t)]}var Rt=Array.isArray||function(t){return Ft(t)&&Mt(t.length)&&St.call(t)===tt};function qt(t,e){var r=-1,n=t.length;while(++r<n){if(e(t[r],r,t)){return true}}return false}function Ut(t,e,n,i,o,s){var a=-1,u=t.length,c=e.length;if(u!==c&&!(i&&c>u)){return false}while(++a<u){var f=t[a],l=e[a],h;if(h!==r){if(h){continue}return false}if(i){if(!qt(e,function(t){return f===t||n(f,t,i,o,s)})){return false}}else if(!(f===l||n(f,l,i,o,s))){return false}}return true}function Ot(t,e,r,n,i,o){var s=Rt(t),a=Rt(e),u=tt,c=tt;if(!s){u=St.call(t);if(u===$){u=at}else if(u!==at){s=Nt(t)}}if(!a){c=St.call(e);if(c===$){c=at}}var f=u===at&&!Dt(t),l=c===at&&!Dt(e),h=u===c;if(h&&!(s||f)){return Pt(t,e,u)}if(!n){var d=f&&It.call(t,"__wrapped__"),p=l&&It.call(e,"__wrapped__");if(d||p){return r(d?t.value():t,p?e.value():e,n,i,o)}}if(!h){return false}i||(i=[]);o||(o=[]);var v=i.length;while(v--){if(i[v]===t){return o[v]===e}}i.push(t);o.push(e);var m=(s?Ut:Et)(t,e,r,n,i,o);i.pop();o.pop();return m}function Bt(t,e,r,n,i){if(t===e){return true}if(t==null||e==null||!Tt(t)&&!Ft(e)){return t!==t&&e!==e}return Ot(t,e,Bt,r,n,i)}var Lt=d.internals.isEqual=function(t,e){return Bt(t,e)};var zt={}.hasOwnProperty,jt=Array.prototype.slice;var Vt=d.internals.inherits=function(t,e){function r(){this.constructor=t}r.prototype=e.prototype;t.prototype=new r};var Xt=d.internals.addProperties=function(t){for(var e=[],r=1,n=arguments.length;r<n;r++){e.push(arguments[r])}for(var i=0,o=e.length;i<o;i++){var s=e[i];for(var a in s){t[a]=s[a]}}};var Yt=d.internals.addRef=function(t,e){return new Ci(function(r){return new ne(e.getDisposable(),t.subscribe(r))})};function Ht(t,e){var r=new Array(t);for(var n=0;n<t;n++){r[n]=e()}return r}var Gt=d.CompositeDisposable=function(){var t=[],e,r;if(Array.isArray(arguments[0])){t=arguments[0]}else{r=arguments.length;t=new Array(r);for(e=0;e<r;e++){t[e]=arguments[e]}}this.disposables=t;this.isDisposed=false;this.length=t.length};var Zt=Gt.prototype;Zt.add=function(t){if(this.isDisposed){t.dispose()}else{this.disposables.push(t);this.length++}};Zt.remove=function(t){var e=false;if(!this.isDisposed){var r=this.disposables.indexOf(t);if(r!==-1){e=true;this.disposables.splice(r,1);this.length--;t.dispose()}}return e};Zt.dispose=function(){if(!this.isDisposed){this.isDisposed=true;var t=this.disposables.length,e=new Array(t);for(var r=0;r<t;r++){e[r]=this.disposables[r]}this.disposables=[];this.length=0;for(r=0;r<t;r++){e[r].dispose()}}};var Qt=d.Disposable=function(t){this.isDisposed=false;this.action=t||p};Qt.prototype.dispose=function(){if(!this.isDisposed){this.action();this.isDisposed=true}};var Wt=Qt.create=function(t){return new Qt(t)};var Kt=Qt.empty={dispose:p};var Jt=Qt.isDisposable=function(t){return t&&C(t.dispose)};var $t=Qt.checkDisposed=function(t){if(t.isDisposed){throw new L}};var te=Qt._fixup=function(t){return Jt(t)?t:Kt};var ee=d.SingleAssignmentDisposable=function(){this.isDisposed=false;this.current=null};ee.prototype.getDisposable=function(){return this.current};ee.prototype.setDisposable=function(t){if(this.current){throw new Error("Disposable has already been assigned")}var e=this.isDisposed;!e&&(this.current=t);e&&t&&t.dispose()};ee.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=true;var t=this.current;this.current=null;t&&t.dispose()}};var re=d.SerialDisposable=function(){this.isDisposed=false;this.current=null};re.prototype.getDisposable=function(){return this.current};re.prototype.setDisposable=function(t){var e=this.isDisposed;if(!e){var r=this.current;this.current=t}r&&r.dispose();e&&t&&t.dispose()};re.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=true;var t=this.current;this.current=null}t&&t.dispose()};var ne=d.BinaryDisposable=function(t,e){this._first=t;this._second=e;this.isDisposed=false};ne.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=true;var t=this._first;this._first=null;t&&t.dispose();var e=this._second;this._second=null;e&&e.dispose()}};var ie=d.NAryDisposable=function(t){this._disposables=t;this.isDisposed=false};ie.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=true;for(var t=0,e=this._disposables.length;t<e;t++){this._disposables[t].dispose()}this._disposables.length=0}};var oe=d.RefCountDisposable=function(){function t(t){this.disposable=t;this.disposable.count++;this.isInnerDisposed=false}t.prototype.dispose=function(){if(!this.disposable.isDisposed&&!this.isInnerDisposed){this.isInnerDisposed=true;this.disposable.count--;if(this.disposable.count===0&&this.disposable.isPrimaryDisposed){this.disposable.isDisposed=true;this.disposable.underlyingDisposable.dispose()}}};function e(t){this.underlyingDisposable=t;this.isDisposed=false;this.isPrimaryDisposed=false;this.count=0}e.prototype.dispose=function(){if(!this.isDisposed&&!this.isPrimaryDisposed){this.isPrimaryDisposed=true;if(this.count===0){this.isDisposed=true;this.underlyingDisposable.dispose()}}};e.prototype.getDisposable=function(){return this.isDisposed?Kt:new t(this)};return e}();var se=d.internals.ScheduledItem=function(t,e,r,n,i){this.scheduler=t;this.state=e;this.action=r;this.dueTime=n;this.comparer=i||y;this.disposable=new ee};se.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())};se.prototype.compareTo=function(t){return this.comparer(this.dueTime,t.dueTime)};se.prototype.isCancelled=function(){return this.disposable.isDisposed};se.prototype.invokeCore=function(){return te(this.action(this.scheduler,this.state))};var ae=d.Scheduler=function(){function t(){}t.isScheduler=function(e){return e instanceof t};var e=t.prototype;e.schedule=function(t,e){throw new V};e.scheduleFuture=function(e,r,n){var i=r;i instanceof Date&&(i=i-this.now());i=t.normalize(i);if(i===0){return this.schedule(e,n)}return this._scheduleFuture(e,i,n)};e._scheduleFuture=function(t,e,r){throw new V};t.now=m;t.prototype.now=m;t.normalize=function(t){t<0&&(t=0);return t};return t}();var ue=ae.normalize,ce=ae.isScheduler;(function(t){function e(t,e){var r=e[0],n=e[1],i=new Gt;n(r,o);return i;function o(e){var r=false,s=false;var a=t.schedule(e,u);if(!s){i.add(a);r=true}function u(t,e){if(r){i.remove(a)}else{s=true}n(e,o);return Kt}}}function r(t,e){var r=e[0],n=e[1],i=new Gt;n(r,o);return i;function o(e,r){var s=false,a=false;var u=t.scheduleFuture(e,r,c);if(!a){i.add(u);s=true}function c(t,e){if(s){i.remove(u)}else{a=true}n(e,o);return Kt}}}t.scheduleRecursive=function(t,r){return this.schedule([t,r],e)};t.scheduleRecursiveFuture=function(t,e,n){return this.scheduleFuture([t,n],e,r)}})(ae.prototype);(function(t){t.schedulePeriodic=function(t,e,r){if(typeof h.setInterval==="undefined"){throw new j}e=ue(e);var n=t,i=h.setInterval(function(){n=r(n)},e);return Wt(function(){h.clearInterval(i)})}})(ae.prototype);var fe=function(t){Vt(e,t);function e(){t.call(this)}e.prototype.schedule=function(t,e){return te(e(this,t))};return e}(ae);var le=ae.immediate=new fe;var he=function(t){var e;function r(){while(e.length>0){var t=e.dequeue();!t.isCancelled()&&t.invoke()}}Vt(n,t);function n(){t.call(this)}n.prototype.schedule=function(t,n){var i=new se(this,t,n,this.now());if(!e){e=new xe(4);e.enqueue(i);var o=A(r)();e=null;if(o===I){k(o.e)}}else{e.enqueue(i)}return i.disposable};n.prototype.scheduleRequired=function(){return!e};return n}(ae);var de=ae.currentThread=new he;var pe=d.internals.SchedulePeriodicRecursive=function(){function t(t){return function e(r,n){n(0,t._period);var i=A(t._action)(t._state);if(i===I){t._cancel.dispose();k(i.e)}t._state=i}}function e(t,e,r,n){this._scheduler=t;this._state=e;this._period=r;this._action=n}e.prototype.start=function(){var e=new ee;this._cancel=e;e.setDisposable(this._scheduler.scheduleRecursiveFuture(0,this._period,t(this)));return e};return e}();var ve,me;var ge=function(){var t,e=p;if(!!h.setTimeout){t=h.setTimeout;e=h.clearTimeout}else if(!!h.WScript){t=function(t,e){h.WScript.Sleep(e);t()}}else{throw new j}return{setTimeout:t,clearTimeout:e}}();var ye=ge.setTimeout,be=ge.clearTimeout;(function(){var t=1,e={},r=false;me=function(t){delete e[t]};function n(t){if(r){ye(function(){n(t)},0)}else{var i=e[t];if(i){r=true;var o=A(i)();me(t);r=false;if(o===I){k(o.e)}}}}var i=new RegExp("^"+String(toString).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");var o=typeof(o=a&&f&&a.setImmediate)=="function"&&!i.test(o)&&o;function s(){if(!h.postMessage||h.importScripts){return false}var t=false,e=h.onmessage;h.onmessage=function(){t=true};h.postMessage("","*");h.onmessage=e;return t}if(C(o)){ve=function(r){var i=t++;e[i]=r;o(function(){n(i)});return i}}else if(typeof process!=="undefined"&&{}.toString.call(process)==="[object process]"){ve=function(r){var i=t++;e[i]=r;process.nextTick(function(){n(i)});return i}}else if(s()){var u="ms.rx.schedule"+Math.random();var c=function(t){if(typeof t.data==="string"&&t.data.substring(0,u.length)===u){n(t.data.substring(u.length))}};h.addEventListener("message",c,false);ve=function(r){var n=t++;e[n]=r;h.postMessage(u+n,"*");return n}}else if(!!h.MessageChannel){var l=new h.MessageChannel;l.port1.onmessage=function(t){n(t.data)};ve=function(r){var n=t++;e[n]=r;l.port2.postMessage(n);return n}}else if("document"in h&&"onreadystatechange"in h.document.createElement("script")){ve=function(r){var i=h.document.createElement("script");var o=t++;e[o]=r;i.onreadystatechange=function(){n(o);i.onreadystatechange=null;i.parentNode.removeChild(i);i=null};h.document.documentElement.appendChild(i);return o}}else{ve=function(r){var i=t++;e[i]=r;ye(function(){n(i)},0);return i}}})();var _e=function(t){Vt(e,t);function e(){t.call(this)}function r(t,e,r,n){return function i(){t.setDisposable(Qt._fixup(e(r,n)))}}function n(t){this._id=t;this.isDisposed=false}n.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=true;me(this._id)}};function i(t){this._id=t;this.isDisposed=false}i.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=true;be(this._id)}};e.prototype.schedule=function(t,e){var i=new ee,o=ve(r(i,e,this,t));return new ne(i,new n(o))};e.prototype._scheduleFuture=function(t,e,n){if(e===0){return this.schedule(t,n)}var o=new ee,s=ye(r(o,n,this,t),e);return new ne(o,new i(s))};function o(t,e,r){return function(){e(t,r)}}e.prototype.scheduleLongRunning=function(t,e){var r=Wt(p);ve(o(t,e,r));return r};return e}(ae);var we=ae["default"]=ae.async=new _e;function Ce(t,e){this.id=t;this.value=e}Ce.prototype.compareTo=function(t){var e=this.value.compareTo(t.value);e===0&&(e=this.id-t.id);return e};var xe=d.internals.PriorityQueue=function(t){this.items=new Array(t);this.length=0};var Ie=xe.prototype;Ie.isHigherPriority=function(t,e){return this.items[t].compareTo(this.items[e])<0};Ie.percolate=function(t){if(t>=this.length||t<0){return}var e=t-1>>1;if(e<0||e===t){return}if(this.isHigherPriority(t,e)){var r=this.items[t];this.items[t]=this.items[e];this.items[e]=r;this.percolate(e)}};Ie.heapify=function(t){+t||(t=0);if(t>=this.length||t<0){return}var e=2*t+1,r=2*t+2,n=t;if(e<this.length&&this.isHigherPriority(e,n)){n=e}if(r<this.length&&this.isHigherPriority(r,n)){n=r}if(n!==t){var i=this.items[t];this.items[t]=this.items[n];this.items[n]=i;this.heapify(n)}};Ie.peek=function(){return this.items[0].value};Ie.removeAt=function(t){this.items[t]=this.items[--this.length];this.items[this.length]=r;this.heapify()};Ie.dequeue=function(){var t=this.peek();this.removeAt(0);return t};Ie.enqueue=function(t){var e=this.length++;this.items[e]=new Ce(xe.count++,t);this.percolate(e)};Ie.remove=function(t){for(var e=0;e<this.length;e++){if(this.items[e].value===t){this.removeAt(e);return true}}return false};xe.count=0;var Se=d.Notification=function(){function t(){}t.prototype._accept=function(t,e,r){throw new V};t.prototype._acceptObserver=function(t,e,r){throw new V};t.prototype.accept=function(t,e,r){return t&&typeof t==="object"?this._acceptObserver(t):this._accept(t,e,r)};t.prototype.toObservable=function(t){var e=this;ce(t)||(t=le);return new Ci(function(r){return t.schedule(e,function(t,e){e._acceptObserver(r);e.kind==="N"&&r.onCompleted()})})};return t}();var Ae=function(t){Vt(e,t);function e(t){this.value=t;this.kind="N"}e.prototype._accept=function(t){return t(this.value)};e.prototype._acceptObserver=function(t){return t.onNext(this.value)};e.prototype.toString=function(){return"OnNext("+this.value+")"};return e}(Se);var ke=function(t){Vt(e,t);function e(t){this.error=t;this.kind="E"}e.prototype._accept=function(t,e){return e(this.error)};e.prototype._acceptObserver=function(t){return t.onError(this.error)};e.prototype.toString=function(){return"OnError("+this.error+")"};return e}(Se);var Ee=function(t){Vt(e,t);function e(){this.kind="C"}e.prototype._accept=function(t,e,r){return r()};e.prototype._acceptObserver=function(t){return t.onCompleted()};e.prototype.toString=function(){return"OnCompleted()"};return e}(Se);var Pe=Se.createOnNext=function(t){return new Ae(t)};var Te=Se.createOnError=function(t){return new ke(t)};var Fe=Se.createOnCompleted=function(){return new Ee};var Me=d.Observer=function(){};var De=Me.create=function(t,e,r){t||(t=p);e||(e=_);r||(r=p);return new Re(t,e,r)};var Ne=d.internals.AbstractObserver=function(t){Vt(e,t);function e(){this.isStopped=false}e.prototype.next=X;e.prototype.error=X;e.prototype.completed=X;e.prototype.onNext=function(t){!this.isStopped&&this.next(t)};e.prototype.onError=function(t){if(!this.isStopped){this.isStopped=true;this.error(t)}};e.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=true;this.completed()}};e.prototype.dispose=function(){this.isStopped=true};e.prototype.fail=function(t){if(!this.isStopped){this.isStopped=true;this.error(t);return true}return false};return e}(Me);var Re=d.AnonymousObserver=function(t){Vt(e,t);function e(e,r,n){t.call(this);this._onNext=e;this._onError=r;this._onCompleted=n}e.prototype.next=function(t){this._onNext(t)};e.prototype.error=function(t){this._onError(t)};e.prototype.completed=function(){this._onCompleted()};return e}(Ne);var qe;var Ue=d.Observable=function(){function t(t,e){return function(r){var n=r.onError;r.onError=function(e){D(e,t);n.call(r,e)};return e.call(t,r)}}function e(){if(d.config.longStackSupport&&E){var e=this._subscribe;var r=A(k)(new Error).e;this.stack=r.stack.substring(r.stack.indexOf("\n")+1);this._subscribe=t(this,e)}}qe=e.prototype;e.isObservable=function(t){return t&&C(t.subscribe)};qe.subscribe=qe.forEach=function(t,e,r){return this._subscribe(typeof t==="object"?t:De(t,e,r))};qe.subscribeOnNext=function(t,e){return this._subscribe(De(typeof e!=="undefined"?function(r){t.call(e,r)}:t))};qe.subscribeOnError=function(t,e){return this._subscribe(De(null,typeof e!=="undefined"?function(r){t.call(e,r)}:t))};qe.subscribeOnCompleted=function(t,e){return this._subscribe(De(null,null,typeof e!=="undefined"?function(){t.call(e)}:t))};return e}();var Oe=d.internals.ScheduledObserver=function(t){Vt(e,t);function e(e,r){t.call(this);this.scheduler=e;this.observer=r;this.isAcquired=false;this.hasFaulted=false;this.queue=[];this.disposable=new re}function r(t,e){return function(){t.onNext(e)}}function n(t,e){return function(){t.onError(e)}}function i(t){return function(){t.onCompleted()}}e.prototype.next=function(t){this.queue.push(r(this.observer,t))};e.prototype.error=function(t){this.queue.push(n(this.observer,t))};e.prototype.completed=function(){this.queue.push(i(this.observer))};function o(t,e){var r;if(t.queue.length>0){r=t.queue.shift()}else{t.isAcquired=false;return}var n=A(r)();if(n===I){t.queue=[];t.hasFaulted=true;return k(n.e)}e(t)}e.prototype.ensureActive=function(){var t=false;if(!this.hasFaulted&&this.queue.length>0){t=!this.isAcquired;this.isAcquired=true}t&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(this,o))};e.prototype.dispose=function(){t.prototype.dispose.call(this);this.disposable.dispose()};return e}(Ne);var Be=d.ObservableBase=function(t){Vt(n,t);function e(t){return t&&C(t.dispose)?t:C(t)?Wt(t):Kt}function r(t,r){var n=r[0],i=r[1];var o=A(i.subscribeCore).call(i,n);if(o===I&&!n.fail(I.e)){k(I.e)}n.setDisposable(e(o))}function n(){t.call(this)}n.prototype._subscribe=function(t){var e=new xi(t),n=[e,this];if(de.scheduleRequired()){de.schedule(n,r)}else{r(null,n)}return e};n.prototype.subscribeCore=X;return n}(Ue);var Le=d.FlatMapObservable=function(t){Vt(e,t);function e(e,r,n,i){this.resultSelector=C(n)?n:null;this.selector=W(C(r)?r:function(){return r},i,3);this.source=e;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this.selector,this.resultSelector,this))};Vt(r,Ne);function r(t,e,r,n){this.i=0;this.selector=e;this.resultSelector=r;this.source=n;this.o=t;Ne.call(this)}r.prototype._wrapResult=function(t,e,r){return this.resultSelector?t.map(function(t,n){return this.resultSelector(e,t,r,n)},this):t};r.prototype.next=function(t){var e=this.i++;var r=A(this.selector)(t,e,this.source);if(r===I){return this.o.onError(r.e)}w(r)&&(r=Yn(r));(Q(r)||Z(r))&&(r=Ue.from(r));this.o.onNext(this._wrapResult(r,t,e))};r.prototype.error=function(t){this.o.onError(t)};r.prototype.completed=function(){this.o.onCompleted()};return e}(Be);var ze=d.internals.Enumerable=function(){};function je(t){this._s=t;this.isDisposed=false}je.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=true;this._s.isDisposed=true}};var Ve=function(t){Vt(e,t);function e(e){this.sources=e;t.call(this)}function r(t,e){if(t.isDisposed){return}var r=A(t.e.next).call(t.e);if(r===I){return t.o.onError(r.e)}if(r.done){return t.o.onCompleted()}var i=r.value;w(i)&&(i=Yn(i));var o=new ee;t.subscription.setDisposable(o);o.setDisposable(i.subscribe(new n(t,e)))}e.prototype.subscribeCore=function(t){var e=new re;var n={isDisposed:false,o:t,subscription:e,e:this.sources[H]()};var i=de.scheduleRecursive(n,r);return new ie([e,i,new je(n)])};function n(t,e){this._state=t;this._recurse=e;Ne.call(this)}Vt(n,Ne);n.prototype.next=function(t){this._state.o.onNext(t)};n.prototype.error=function(t){this._state.o.onError(t)};n.prototype.completed=function(){this._recurse(this._state)};return e}(Be);ze.prototype.concat=function(){return new Ve(this)};var Xe=function(t){function e(e){this.sources=e;t.call(this)}Vt(e,t);function r(t,e){if(t.isDisposed){return}var r=A(t.e.next).call(t.e);if(r===I){return t.o.onError(r.e)}if(r.done){return t.lastError!==null?t.o.onError(t.lastError):t.o.onCompleted()}var i=r.value;w(i)&&(i=Yn(i));var o=new ee;t.subscription.setDisposable(o);o.setDisposable(i.subscribe(new n(t,e)))}e.prototype.subscribeCore=function(t){var e=new re;var n={isDisposed:false,e:this.sources[H](),subscription:e,lastError:null,o:t};var i=de.scheduleRecursive(n,r);return new ie([e,i,new je(n)])};function n(t,e){this._state=t;this._recurse=e;Ne.call(this)}Vt(n,Ne);n.prototype.next=function(t){this._state.o.onNext(t)};n.prototype.error=function(t){this._state.lastError=t;this._recurse(this._state)};n.prototype.completed=function(){this._state.o.onCompleted()};return e}(Be);ze.prototype.catchError=function(){return new Xe(this)};var Ye=function(t){Vt(e,t);function e(t,e){this.v=t;this.c=e==null?-1:e}e.prototype[H]=function(){return new r(this)};function r(t){this.v=t.v;this.l=t.c}r.prototype.next=function(){if(this.l===0){return G}if(this.l>0){this.l--}return{done:false,value:this.v}};return e}(ze);var He=ze.repeat=function(t,e){return new Ye(t,e)};var Ge=function(t){Vt(e,t);function e(t,e,r){this.s=t;this.fn=e?W(e,r,3):null}e.prototype[H]=function(){return new r(this)};function r(t){this.i=-1;this.s=t.s;this.l=this.s.length;this.fn=t.fn}r.prototype.next=function(){return++this.i<this.l?{done:false,value:!this.fn?this.s[this.i]:this.fn(this.s[this.i],this.i,this.s)}:G};return e}(ze);var Ze=ze.of=function(t,e,r){return new Ge(t,e,r)};var Qe=function(t){Vt(e,t);function e(e){this.source=e;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t))};Vt(r,Ne);function r(t){this.o=t;this.a=[];Ne.call(this)}r.prototype.next=function(t){this.a.push(t)};r.prototype.error=function(t){this.o.onError(t)};r.prototype.completed=function(){this.o.onNext(this.a);this.o.onCompleted()};return e}(Be);qe.toArray=function(){return new Qe(this)};Ue.create=function(t,e){return new Ci(t,e)};var We=function(t){Vt(e,t);function e(e){this._f=e;t.call(this)}e.prototype.subscribeCore=function(t){var e=A(this._f)();if(e===I){return Ar(e.e).subscribe(t)}w(e)&&(e=Yn(e));return e.subscribe(t)};return e}(Be);var Ke=Ue.defer=function(t){return new We(t)};var Je=function(t){Vt(e,t);function e(e){this.scheduler=e;t.call(this)}e.prototype.subscribeCore=function(t){var e=new r(t,this.scheduler);return e.run()};function r(t,e){this.observer=t;this.scheduler=e}function n(t,e){e.onCompleted();return Kt}r.prototype.run=function(){var t=this.observer;return this.scheduler===le?n(null,t):this.scheduler.schedule(t,n)};return e}(Be);var $e=new Je(le);var tr=Ue.empty=function(t){ce(t)||(t=le);return t===le?$e:new Je(t)};var er=function(t){Vt(e,t);function e(e,r,n){this._iterable=e;this._fn=r;this._scheduler=n;t.call(this)}function r(t,e,r){return function n(i,o){var s=A(e.next).call(e);if(s===I){return t.onError(s.e)}if(s.done){return t.onCompleted()}var a=s.value;if(C(r)){a=A(r)(a,i);if(a===I){return t.onError(a.e)}}t.onNext(a);o(i+1)}}e.prototype.subscribeCore=function(t){var e=Object(this._iterable),n=cr(e);return this._scheduler.scheduleRecursive(0,r(t,n,this._fn))};return e}(Be);var rr=Math.pow(2,53)-1;function nr(t){this._s=t}nr.prototype[H]=function(){return new ir(this._s)};function ir(t){this._s=t;this._l=t.length;this._i=0}ir.prototype[H]=function(){return this};ir.prototype.next=function(){return this._i<this._l?{done:false,value:this._s.charAt(this._i++)}:G};function or(t){this._a=t}or.prototype[H]=function(){return new sr(this._a)};function sr(t){this._a=t;this._l=lr(t);this._i=0}sr.prototype[H]=function(){return this};sr.prototype.next=function(){return this._i<this._l?{done:false,value:this._a[this._i++]}:G};function ar(t){return typeof t==="number"&&h.isFinite(t)}function ur(t){return t!==t}function cr(t){var e=t[H],n;if(!e&&typeof t==="string"){n=new nr(t);return n[H]()}if(!e&&t.length!==r){n=new or(t);return n[H]()}if(!e){throw new TypeError("Object is not iterable")}return t[H]()}function fr(t){var e=+t;if(e===0){return e}if(isNaN(e)){return e}return e<0?-1:1}function lr(t){var e=+t.length;if(isNaN(e)){return 0}if(e===0||!ar(e)){return e}e=fr(e)*Math.floor(Math.abs(e));if(e<=0){return 0}if(e>rr){return rr}return e}var hr=Ue.from=function(t,e,r,n){if(t==null){throw new Error("iterable cannot be null.")}if(e&&!C(e)){throw new Error("mapFn when provided must be a function")}if(e){var i=W(e,r,2)}ce(n)||(n=de);return new er(t,i,n)};var dr=function(t){Vt(e,t);function e(e,r){this._args=e;this._scheduler=r;t.call(this)}function r(t,e){var r=e.length;return function n(i,o){if(i<r){t.onNext(e[i]);o(i+1)}else{t.onCompleted()}}}e.prototype.subscribeCore=function(t){return this._scheduler.scheduleRecursive(0,r(t,this._args))};return e}(Be);var pr=Ue.fromArray=function(t,e){ce(e)||(e=de);return new dr(t,e)};var vr=function(t){Vt(e,t);function e(){t.call(this)}e.prototype.subscribeCore=function(t){return Kt};return e}(Be);var mr=new vr;var gr=Ue.never=function(){return mr};function yr(t,e){ce(t)||(t=de);return new dr(e,t)}Ue.of=function(){var t=arguments.length,e=new Array(t);for(var r=0;r<t;r++){e[r]=arguments[r]}return new dr(e,de)};Ue.ofWithScheduler=function(t){var e=arguments.length,r=new Array(e-1);for(var n=1;n<e;n++){r[n-1]=arguments[n]}return new dr(r,t)};var br=function(t){Vt(e,t);function e(e,r){this._o=e;this._keys=Object.keys(e);this._scheduler=r;t.call(this)}function r(t,e,r){return function n(i,o){if(i<r.length){var s=r[i];t.onNext([s,e[s]]);o(i+1)}else{t.onCompleted()}}}e.prototype.subscribeCore=function(t){return this._scheduler.scheduleRecursive(0,r(t,this._o,this._keys))};return e}(Be);Ue.pairs=function(t,e){e||(e=de);return new br(t,e)};var _r=function(t){Vt(e,t);function e(e,r,n){this.start=e;this.rangeCount=r;this.scheduler=n;t.call(this)}function r(t,e,r){return function n(i,o){if(i<e){r.onNext(t+i);o(i+1)}else{r.onCompleted()}}}e.prototype.subscribeCore=function(t){return this.scheduler.scheduleRecursive(0,r(this.start,this.rangeCount,t))};return e}(Be);Ue.range=function(t,e,r){ce(r)||(r=de);return new _r(t,e,r)};var wr=function(t){Vt(e,t);function e(e,r,n){this.value=e;this.repeatCount=r==null?-1:r;this.scheduler=n;t.call(this)}e.prototype.subscribeCore=function(t){var e=new Cr(t,this);return e.run()};return e}(Be);function Cr(t,e){this.observer=t;this.parent=e}Cr.prototype.run=function(){var t=this.observer,e=this.parent.value;function r(r,n){if(r===-1||r>0){t.onNext(e);r>0&&r--}if(r===0){return t.onCompleted()}n(r)}return this.parent.scheduler.scheduleRecursive(this.parent.repeatCount,r)};Ue.repeat=function(t,e,r){ce(r)||(r=de);return new wr(t,e,r)};var xr=function(t){Vt(e,t);function e(e,r){this._value=e;this._scheduler=r;t.call(this)}e.prototype.subscribeCore=function(t){var e=[this._value,t];return this._scheduler===le?r(null,e):this._scheduler.schedule(e,r)};function r(t,e){var r=e[0],n=e[1];n.onNext(r);n.onCompleted()
;return Kt}return e}(Be);var Ir=Ue["return"]=Ue.just=function(t,e){ce(e)||(e=le);return new xr(t,e)};var Sr=function(t){Vt(e,t);function e(e,r){this._error=e;this._scheduler=r;t.call(this)}e.prototype.subscribeCore=function(t){var e=[this._error,t];return this._scheduler===le?r(null,e):this._scheduler.schedule(e,r)};function r(t,e){var r=e[0],n=e[1];n.onError(r);return Kt}return e}(Be);var Ar=Ue["throw"]=function(t,e){ce(e)||(e=le);return new Sr(t,e)};var kr=function(t){Vt(e,t);function e(e,r){this.source=e;this._fn=r;t.call(this)}e.prototype.subscribeCore=function(t){var e=new ee,r=new re;r.setDisposable(e);e.setDisposable(this.source.subscribe(new Er(t,r,this._fn)));return r};return e}(Be);var Er=function(t){Vt(e,t);function e(e,r,n){this._o=e;this._s=r;this._fn=n;t.call(this)}e.prototype.next=function(t){this._o.onNext(t)};e.prototype.completed=function(){return this._o.onCompleted()};e.prototype.error=function(t){var e=A(this._fn)(t);if(e===I){return this._o.onError(e.e)}w(e)&&(e=Yn(e));var r=new ee;this._s.setDisposable(r);r.setDisposable(e.subscribe(this._o))};return e}(Ne);qe["catch"]=function(t){return C(t)?new kr(this,t):Pr([this,t])};var Pr=Ue["catch"]=function(){var t;if(Array.isArray(arguments[0])){t=arguments[0]}else{var e=arguments.length;t=new Array(e);for(var r=0;r<e;r++){t[r]=arguments[r]}}return Ze(t).catchError()};qe.combineLatest=function(){var t=arguments.length,e=new Array(t);for(var r=0;r<t;r++){e[r]=arguments[r]}if(Array.isArray(e[0])){e[0].unshift(this)}else{e.unshift(this)}return Nr.apply(this,e)};function Tr(){return false}function Fr(){var t=arguments.length,e=new Array(t);for(var r=0;r<t;r++){e[r]=arguments[r]}return e}var Mr=function(t){Vt(e,t);function e(e,r){this._params=e;this._cb=r;t.call(this)}e.prototype.subscribeCore=function(t){var e=this._params.length,r=new Array(e);var n={hasValue:Ht(e,Tr),hasValueAll:false,isDone:Ht(e,Tr),values:new Array(e)};for(var i=0;i<e;i++){var o=this._params[i],s=new ee;r[i]=s;w(o)&&(o=Yn(o));s.setDisposable(o.subscribe(new Dr(t,i,this._cb,n)))}return new ie(r)};return e}(Be);var Dr=function(t){Vt(e,t);function e(e,r,n,i){this._o=e;this._i=r;this._cb=n;this._state=i;t.call(this)}function r(t){return function(e,r){return r!==t}}e.prototype.next=function(t){this._state.values[this._i]=t;this._state.hasValue[this._i]=true;if(this._state.hasValueAll||(this._state.hasValueAll=this._state.hasValue.every(v))){var e=A(this._cb).apply(null,this._state.values);if(e===I){return this._o.onError(e.e)}this._o.onNext(e)}else if(this._state.isDone.filter(r(this._i)).every(v)){this._o.onCompleted()}};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=function(){this._state.isDone[this._i]=true;this._state.isDone.every(v)&&this._o.onCompleted()};return e}(Ne);var Nr=Ue.combineLatest=function(){var t=arguments.length,e=new Array(t);for(var r=0;r<t;r++){e[r]=arguments[r]}var n=C(e[t-1])?e.pop():Fr;Array.isArray(e[0])&&(e=e[0]);return new Mr(e,n)};qe.concat=function(){for(var t=[],e=0,r=arguments.length;e<r;e++){t.push(arguments[e])}t.unshift(this);return Ur.apply(null,t)};var Rr=function(t){Vt(e,t);function e(e,r){this._s=e;this._fn=r;t.call(this)}e.prototype.next=function(t){this._s.o.onNext(t)};e.prototype.error=function(t){this._s.o.onError(t)};e.prototype.completed=function(){this._s.i++;this._fn(this._s)};return e}(Ne);var qr=function(t){Vt(e,t);function e(e){this._sources=e;t.call(this)}function r(t,e){if(t.disposable.isDisposed){return}if(t.i===t.sources.length){return t.o.onCompleted()}var r=t.sources[t.i];w(r)&&(r=Yn(r));var n=new ee;t.subscription.setDisposable(n);n.setDisposable(r.subscribe(new Rr(t,e)))}e.prototype.subscribeCore=function(t){var e=new re;var n=Wt(p);var i={o:t,i:0,subscription:e,disposable:n,sources:this._sources};var o=le.scheduleRecursive(i,r);return new ie([e,n,o])};return e}(Be);var Ur=Ue.concat=function(){var t;if(Array.isArray(arguments[0])){t=arguments[0]}else{t=new Array(arguments.length);for(var e=0,r=arguments.length;e<r;e++){t[e]=arguments[e]}}return new qr(t)};qe.concatAll=function(){return this.merge(1)};var Or=function(t){Vt(e,t);function e(e,r){this.source=e;this.maxConcurrent=r;t.call(this)}e.prototype.subscribeCore=function(t){var e=new Gt;e.add(this.source.subscribe(new Br(t,this.maxConcurrent,e)));return e};return e}(Be);var Br=function(t){function e(e,r,n){this.o=e;this.max=r;this.g=n;this.done=false;this.q=[];this.activeCount=0;t.call(this)}Vt(e,t);e.prototype.handleSubscribe=function(t){var e=new ee;this.g.add(e);w(t)&&(t=Yn(t));e.setDisposable(t.subscribe(new r(this,e)))};e.prototype.next=function(t){if(this.activeCount<this.max){this.activeCount++;this.handleSubscribe(t)}else{this.q.push(t)}};e.prototype.error=function(t){this.o.onError(t)};e.prototype.completed=function(){this.done=true;this.activeCount===0&&this.o.onCompleted()};function r(e,r){this.parent=e;this.sad=r;t.call(this)}Vt(r,t);r.prototype.next=function(t){this.parent.o.onNext(t)};r.prototype.error=function(t){this.parent.o.onError(t)};r.prototype.completed=function(){this.parent.g.remove(this.sad);if(this.parent.q.length>0){this.parent.handleSubscribe(this.parent.q.shift())}else{this.parent.activeCount--;this.parent.done&&this.parent.activeCount===0&&this.parent.o.onCompleted()}};return e}(Ne);qe.merge=function(t){return typeof t!=="number"?Lr(this,t):new Or(this,t)};var Lr=Ue.merge=function(){var t,e=[],r,n=arguments.length;if(!arguments[0]){t=le;for(r=1;r<n;r++){e.push(arguments[r])}}else if(ce(arguments[0])){t=arguments[0];for(r=1;r<n;r++){e.push(arguments[r])}}else{t=le;for(r=0;r<n;r++){e.push(arguments[r])}}if(Array.isArray(e[0])){e=e[0]}return yr(t,e).mergeAll()};var zr=d.CompositeError=function(t){this.innerErrors=t;this.message="This contains multiple errors. Check the innerErrors";Error.call(this)};zr.prototype=Object.create(Error.prototype);zr.prototype.name="CompositeError";var jr=function(t){Vt(e,t);function e(e){this.source=e;t.call(this)}e.prototype.subscribeCore=function(t){var e=new Gt,r=new ee,n={isStopped:false,errors:[],o:t};e.add(r);r.setDisposable(this.source.subscribe(new Vr(e,n)));return e};return e}(Be);var Vr=function(t){Vt(e,t);function e(e,r){this._group=e;this._state=r;t.call(this)}function r(t,e){if(e.length===0){t.onCompleted()}else if(e.length===1){t.onError(e[0])}else{t.onError(new zr(e))}}e.prototype.next=function(t){var e=new ee;this._group.add(e);w(t)&&(t=Yn(t));e.setDisposable(t.subscribe(new n(e,this._group,this._state)))};e.prototype.error=function(t){this._state.errors.push(t);this._state.isStopped=true;this._group.length===1&&r(this._state.o,this._state.errors)};e.prototype.completed=function(){this._state.isStopped=true;this._group.length===1&&r(this._state.o,this._state.errors)};Vt(n,t);function n(e,r,n){this._inner=e;this._group=r;this._state=n;t.call(this)}n.prototype.next=function(t){this._state.o.onNext(t)};n.prototype.error=function(t){this._state.errors.push(t);this._group.remove(this._inner);this._state.isStopped&&this._group.length===1&&r(this._state.o,this._state.errors)};n.prototype.completed=function(){this._group.remove(this._inner);this._state.isStopped&&this._group.length===1&&r(this._state.o,this._state.errors)};return e}(Ne);Ue.mergeDelayError=function(){var t;if(Array.isArray(arguments[0])){t=arguments[0]}else{var e=arguments.length;t=new Array(e);for(var r=0;r<e;r++){t[r]=arguments[r]}}var n=yr(null,t);return new jr(n)};var Xr=function(t){Vt(e,t);function e(e){this.source=e;t.call(this)}e.prototype.subscribeCore=function(t){var e=new Gt,r=new ee;e.add(r);r.setDisposable(this.source.subscribe(new Yr(t,e)));return e};return e}(Be);var Yr=function(t){function e(e,r){this.o=e;this.g=r;this.done=false;t.call(this)}Vt(e,t);e.prototype.next=function(t){var e=new ee;this.g.add(e);w(t)&&(t=Yn(t));e.setDisposable(t.subscribe(new r(this,e)))};e.prototype.error=function(t){this.o.onError(t)};e.prototype.completed=function(){this.done=true;this.g.length===1&&this.o.onCompleted()};function r(e,r){this.parent=e;this.sad=r;t.call(this)}Vt(r,t);r.prototype.next=function(t){this.parent.o.onNext(t)};r.prototype.error=function(t){this.parent.o.onError(t)};r.prototype.completed=function(){this.parent.g.remove(this.sad);this.parent.done&&this.parent.g.length===1&&this.parent.o.onCompleted()};return e}(Ne);qe.mergeAll=function(){return new Xr(this)};var Hr=function(t){Vt(e,t);function e(e,r){this._s=e;this._o=w(r)?Yn(r):r;this._open=false;t.call(this)}e.prototype.subscribeCore=function(t){var e=new ee;e.setDisposable(this._s.subscribe(new Gr(t,this)));w(this._o)&&(this._o=Yn(this._o));var r=new ee;r.setDisposable(this._o.subscribe(new Zr(t,this,r)));return new ne(e,r)};return e}(Be);var Gr=function(t){Vt(e,t);function e(e,r){this._o=e;this._p=r;t.call(this)}e.prototype.next=function(t){this._p._open&&this._o.onNext(t)};e.prototype.error=function(t){this._o.onError(t)};e.prototype.onCompleted=function(){this._p._open&&this._o.onCompleted()};return e}(Ne);var Zr=function(t){Vt(e,t);function e(e,r,n){this._o=e;this._p=r;this._r=n;t.call(this)}e.prototype.next=function(){this._p._open=true;this._r.dispose()};e.prototype.error=function(t){this._o.onError(t)};e.prototype.onCompleted=function(){this._r.dispose()};return e}(Ne);qe.skipUntil=function(t){return new Hr(this,t)};var Qr=function(t){Vt(e,t);function e(e){this.source=e;t.call(this)}e.prototype.subscribeCore=function(t){var e=new re,n=this.source.subscribe(new r(t,e));return new ne(n,e)};Vt(r,Ne);function r(t,e){this.o=t;this.inner=e;this.stopped=false;this.latest=0;this.hasLatest=false;Ne.call(this)}r.prototype.next=function(t){var e=new ee,r=++this.latest;this.hasLatest=true;this.inner.setDisposable(e);w(t)&&(t=Yn(t));e.setDisposable(t.subscribe(new n(this,r)))};r.prototype.error=function(t){this.o.onError(t)};r.prototype.completed=function(){this.stopped=true;!this.hasLatest&&this.o.onCompleted()};Vt(n,Ne);function n(t,e){this.parent=t;this.id=e;Ne.call(this)}n.prototype.next=function(t){this.parent.latest===this.id&&this.parent.o.onNext(t)};n.prototype.error=function(t){this.parent.latest===this.id&&this.parent.o.onError(t)};n.prototype.completed=function(){if(this.parent.latest===this.id){this.parent.hasLatest=false;this.parent.stopped&&this.parent.o.onCompleted()}};return e}(Be);qe["switch"]=qe.switchLatest=function(){return new Qr(this)};var Wr=function(t){Vt(e,t);function e(e,r){this.source=e;this.other=w(r)?Yn(r):r;t.call(this)}e.prototype.subscribeCore=function(t){return new ne(this.source.subscribe(t),this.other.subscribe(new Kr(t)))};return e}(Be);var Kr=function(t){Vt(e,t);function e(e){this._o=e;t.call(this)}e.prototype.next=function(){this._o.onCompleted()};e.prototype.error=function(t){this._o.onError(t)};e.prototype.onCompleted=p;return e}(Ne);qe.takeUntil=function(t){return new Wr(this,t)};function Tr(){return false}function Fr(){var t=arguments.length,e=new Array(t);for(var r=0;r<t;r++){e[r]=arguments[r]}return e}var Jr=function(t){Vt(e,t);function e(e,r,n){this._s=e;this._ss=r;this._cb=n;t.call(this)}e.prototype.subscribeCore=function(t){var e=this._ss.length;var r={hasValue:Ht(e,Tr),hasValueAll:false,values:new Array(e)};var n=this._ss.length,i=new Array(n+1);for(var o=0;o<n;o++){var s=this._ss[o],a=new ee;w(s)&&(s=Yn(s));a.setDisposable(s.subscribe(new $r(t,o,r)));i[o]=a}var u=new ee;u.setDisposable(this._s.subscribe(new tn(t,this._cb,r)));i[n]=u;return new ie(i)};return e}(Be);var $r=function(t){Vt(e,t);function e(e,r,n){this._o=e;this._i=r;this._state=n;t.call(this)}e.prototype.next=function(t){this._state.values[this._i]=t;this._state.hasValue[this._i]=true;this._state.hasValueAll=this._state.hasValue.every(v)};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=p;return e}(Ne);var tn=function(t){Vt(e,t);function e(e,r,n){this._o=e;this._cb=r;this._state=n;t.call(this)}e.prototype.next=function(t){var e=[t].concat(this._state.values);if(!this._state.hasValueAll){return}var r=A(this._cb).apply(null,e);if(r===I){return this._o.onError(r.e)}this._o.onNext(r)};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=function(){this._o.onCompleted()};return e}(Ne);qe.withLatestFrom=function(){if(arguments.length===0){throw new Error("invalid arguments")}var t=arguments.length,e=new Array(t);for(var r=0;r<t;r++){e[r]=arguments[r]}var n=C(e[t-1])?e.pop():Fr;Array.isArray(e[0])&&(e=e[0]);return new Jr(this,e,n)};function Tr(){return false}function en(){return[]}var rn=function(t){Vt(e,t);function e(e,r){this._s=e;this._cb=r;t.call(this)}e.prototype.subscribeCore=function(t){var e=this._s.length,r=new Array(e),n=Ht(e,Tr),i=Ht(e,en);for(var o=0;o<e;o++){var s=this._s[o],a=new ee;r[o]=a;w(s)&&(s=Yn(s));a.setDisposable(s.subscribe(new nn(t,o,this,i,n)))}return new ie(r)};return e}(Be);var nn=function(t){Vt(e,t);function e(e,r,n,i,o){this._o=e;this._i=r;this._p=n;this._q=i;this._d=o;t.call(this)}function r(t){return t.length>0}function n(t){return t.shift()}function i(t){return function(e,r){return r!==t}}e.prototype.next=function(t){this._q[this._i].push(t);if(this._q.every(r)){var e=this._q.map(n);var o=A(this._p._cb).apply(null,e);if(o===I){return this._o.onError(o.e)}this._o.onNext(o)}else if(this._d.filter(i(this._i)).every(v)){this._o.onCompleted()}};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=function(){this._d[this._i]=true;this._d.every(v)&&this._o.onCompleted()};return e}(Ne);qe.zip=function(){if(arguments.length===0){throw new Error("invalid arguments")}var t=arguments.length,e=new Array(t);for(var r=0;r<t;r++){e[r]=arguments[r]}var n=C(e[t-1])?e.pop():Fr;Array.isArray(e[0])&&(e=e[0]);var i=this;e.unshift(i);return new rn(e,n)};Ue.zip=function(){var t=arguments.length,e=new Array(t);for(var r=0;r<t;r++){e[r]=arguments[r]}if(Array.isArray(e[0])){e=C(e[1])?e[0].concat(e[1]):e[0]}var n=e.shift();return n.zip.apply(n,e)};function Tr(){return false}function en(){return[]}function Fr(){var t=arguments.length,e=new Array(t);for(var r=0;r<t;r++){e[r]=arguments[r]}return e}var on=function(t){Vt(e,t);function e(e,r){this.sources=e;this._cb=r;t.call(this)}e.prototype.subscribeCore=function(t){var e=this.sources,r=e.length,n=new Array(r);var i={q:Ht(r,en),done:Ht(r,Tr),cb:this._cb,o:t};for(var o=0;o<r;o++){(function(t){var r=e[t],o=new ee;(Q(r)||Z(r))&&(r=hr(r));n[t]=o;o.setDisposable(r.subscribe(new sn(i,t)))})(o)}return new ie(n)};return e}(Be);var sn=function(t){Vt(e,t);function e(e,r){this._s=e;this._i=r;t.call(this)}function r(t){return t.length>0}function n(t){return t.shift()}function i(t){return function(e,r){return r!==t}}e.prototype.next=function(t){this._s.q[this._i].push(t);if(this._s.q.every(r)){var e=this._s.q.map(n),o=A(this._s.cb).apply(null,e);if(o===I){return this._s.o.onError(o.e)}this._s.o.onNext(o)}else if(this._s.done.filter(i(this._i)).every(v)){this._s.o.onCompleted()}};e.prototype.error=function(t){this._s.o.onError(t)};e.prototype.completed=function(){this._s.done[this._i]=true;this._s.done.every(v)&&this._s.o.onCompleted()};return e}(Ne);qe.zipIterable=function(){if(arguments.length===0){throw new Error("invalid arguments")}var t=arguments.length,e=new Array(t);for(var r=0;r<t;r++){e[r]=arguments[r]}var n=C(e[t-1])?e.pop():Fr;var i=this;e.unshift(i);return new on(e,n)};function an(t){return function e(r){return t.subscribe(r)}}qe.asObservable=function(){return new Ci(an(this),this)};var un=function(t){Vt(e,t);function e(e){this.source=e;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new cn(t))};return e}(Be);var cn=function(t){Vt(e,t);function e(e){this._o=e;t.call(this)}e.prototype.next=function(t){t.accept(this._o)};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=function(){this._o.onCompleted()};return e}(Ne);qe.dematerialize=function(){return new un(this)};var fn=function(t){Vt(e,t);function e(e,r,n){this.source=e;this.keyFn=r;this.comparer=n;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new ln(t,this.keyFn,this.comparer))};return e}(Be);var ln=function(t){Vt(e,t);function e(e,r,n){this.o=e;this.keyFn=r;this.comparer=n;this.hasCurrentKey=false;this.currentKey=null;t.call(this)}e.prototype.next=function(t){var e=t,r;if(C(this.keyFn)){e=A(this.keyFn)(t);if(e===I){return this.o.onError(e.e)}}if(this.hasCurrentKey){r=A(this.comparer)(this.currentKey,e);if(r===I){return this.o.onError(r.e)}}if(!this.hasCurrentKey||!r){this.hasCurrentKey=true;this.currentKey=e;this.o.onNext(t)}};e.prototype.error=function(t){this.o.onError(t)};e.prototype.completed=function(){this.o.onCompleted()};return e}(Ne);qe.distinctUntilChanged=function(t,e){e||(e=g);return new fn(this,t,e)};var hn=function(t){Vt(e,t);function e(e,r,n,i){this.source=e;this._oN=r;this._oE=n;this._oC=i;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this))};Vt(r,Ne);function r(t,e){this.o=t;this.t=!e._oN||C(e._oN)?De(e._oN||p,e._oE||p,e._oC||p):e._oN;this.isStopped=false;Ne.call(this)}r.prototype.next=function(t){var e=A(this.t.onNext).call(this.t,t);if(e===I){this.o.onError(e.e)}this.o.onNext(t)};r.prototype.error=function(t){var e=A(this.t.onError).call(this.t,t);if(e===I){return this.o.onError(e.e)}this.o.onError(t)};r.prototype.completed=function(){var t=A(this.t.onCompleted).call(this.t);if(t===I){return this.o.onError(t.e)}this.o.onCompleted()};return e}(Be);qe["do"]=qe.tap=qe.doAction=function(t,e,r){return new hn(this,t,e,r)};qe.doOnNext=qe.tapOnNext=function(t,e){return this.tap(typeof e!=="undefined"?function(r){t.call(e,r)}:t)};qe.doOnError=qe.tapOnError=function(t,e){return this.tap(p,typeof e!=="undefined"?function(r){t.call(e,r)}:t)};qe.doOnCompleted=qe.tapOnCompleted=function(t,e){return this.tap(p,null,typeof e!=="undefined"?function(){t.call(e)}:t)};var dn=function(t){Vt(e,t);function e(e,r,n){this.source=e;this._fn=W(r,n,0);t.call(this)}e.prototype.subscribeCore=function(t){var e=A(this.source.subscribe).call(this.source,t);if(e===I){this._fn();k(e.e)}return new r(e,this._fn)};function r(t,e){this.isDisposed=false;this._s=t;this._fn=e}r.prototype.dispose=function(){if(!this.isDisposed){var t=A(this._s.dispose).call(this._s);this._fn();t===I&&k(t.e)}};return e}(Be);qe["finally"]=function(t,e){return new dn(this,t,e)};var pn=function(t){Vt(e,t);function e(e){this.source=e;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t))};function r(t){this.o=t;this.isStopped=false}r.prototype.onNext=p;r.prototype.onError=function(t){if(!this.isStopped){this.isStopped=true;this.o.onError(t)}};r.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=true;this.o.onCompleted()}};r.prototype.dispose=function(){this.isStopped=true};r.prototype.fail=function(t){if(!this.isStopped){this.isStopped=true;this.observer.onError(t);return true}return false};return e}(Be);qe.ignoreElements=function(){return new pn(this)};var vn=function(t){Vt(e,t);function e(e,r){this.source=e;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new mn(t))};return e}(Be);var mn=function(t){Vt(e,t);function e(e){this._o=e;t.call(this)}e.prototype.next=function(t){this._o.onNext(Pe(t))};e.prototype.error=function(t){this._o.onNext(Te(t));this._o.onCompleted()};e.prototype.completed=function(){this._o.onNext(Fe());this._o.onCompleted()};return e}(Ne);qe.materialize=function(){return new vn(this)};qe.repeat=function(t){return He(this,t).concat()};qe.retry=function(t){return He(this,t).catchError()};function gn(t){return{"@@iterator":function(){return{next:function(){return{done:false,value:t}}}}}}var yn=function(t){function e(t){return{isDisposed:false,dispose:function(){if(!this.isDisposed){this.isDisposed=true;t.isDisposed=true}}}}function r(e,r){this.source=e;this._notifier=r;t.call(this)}Vt(r,t);r.prototype.subscribeCore=function(t){var r=new Si,n=new Si,i=this._notifier(r),o=i.subscribe(n);var s=this.source["@@iterator"]();var a={isDisposed:false},u,c=new re;var f=de.scheduleRecursive(null,function(e,i){if(a.isDisposed){return}var o=s.next();if(o.done){if(u){t.onError(u)}else{t.onCompleted()}return}var f=o.value;w(f)&&(f=Yn(f));var l=new ee;var h=new ee;c.setDisposable(new ne(h,l));l.setDisposable(f.subscribe(function(e){t.onNext(e)},function(e){h.setDisposable(n.subscribe(i,function(e){t.onError(e)},function(){t.onCompleted()}));r.onNext(e);l.dispose()},function(){t.onCompleted()}))});return new ie([o,c,f,e(a)])};return r}(Be);qe.retryWhen=function(t){return new yn(gn(this),t)};function gn(t){return{"@@iterator":function(){return{next:function(){return{done:false,value:t}}}}}}var bn=function(t){function e(t){return{isDisposed:false,dispose:function(){if(!this.isDisposed){this.isDisposed=true;t.isDisposed=true}}}}function r(e,r){this.source=e;this._notifier=r;t.call(this)}Vt(r,t);r.prototype.subscribeCore=function(t){var r=new Si,n=new Si,i=this._notifier(r),o=i.subscribe(n);var s=this.source["@@iterator"]();var a={isDisposed:false},u,c=new re;var f=de.scheduleRecursive(null,function(e,i){if(a.isDisposed){return}var o=s.next();if(o.done){if(u){t.onError(u)}else{t.onCompleted()}return}var f=o.value;w(f)&&(f=Yn(f));var l=new ee;var h=new ee;c.setDisposable(new ne(h,l));l.setDisposable(f.subscribe(function(e){t.onNext(e)},function(e){t.onError(e)},function(){h.setDisposable(n.subscribe(i,function(e){t.onError(e)},function(){t.onCompleted()}));r.onNext(null);l.dispose()}))});return new ie([o,c,f,e(a)])};return r}(Be);qe.repeatWhen=function(t){return new bn(gn(this),t)};var _n=function(t){Vt(e,t);function e(e,r,n,i){this.source=e;this.accumulator=r;this.hasSeed=n;this.seed=i;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new wn(t,this))};return e}(Be);var wn=function(t){Vt(e,t);function e(e,r){this._o=e;this._p=r;this._fn=r.accumulator;this._hs=r.hasSeed;this._s=r.seed;this._ha=false;this._a=null;this._hv=false;this._i=0;t.call(this)}e.prototype.next=function(t){!this._hv&&(this._hv=true);if(this._ha){this._a=A(this._fn)(this._a,t,this._i,this._p)}else{this._a=this._hs?A(this._fn)(this._s,t,this._i,this._p):t;this._ha=true}if(this._a===I){return this._o.onError(this._a.e)}this._o.onNext(this._a);this._i++};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=function(){!this._hv&&this._hs&&this._o.onNext(this._s);this._o.onCompleted()};return e}(Ne);qe.scan=function(){var t=false,e,r=arguments[0];if(arguments.length===2){t=true;e=arguments[1]}return new _n(this,r,t,e)};var Cn=function(t){Vt(e,t);function e(e,r){this.source=e;this._c=r;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new xn(t,this._c))};return e}(Be);var xn=function(t){Vt(e,t);function e(e,r){this._o=e;this._c=r;this._q=[];t.call(this)}e.prototype.next=function(t){this._q.push(t);this._q.length>this._c&&this._o.onNext(this._q.shift())};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=function(){this._o.onCompleted()};return e}(Ne);qe.skipLast=function(t){if(t<0){throw new z}return new Cn(this,t)};qe.startWith=function(){var t,e,r=0;if(!!arguments.length&&ce(arguments[0])){e=arguments[0];r=1}else{e=le}for(var n=[],i=r,o=arguments.length;i<o;i++){n.push(arguments[i])}return Ur.apply(null,[pr(n,e),this])};var In=function(t){Vt(e,t);function e(e,r){this._o=e;this._c=r;this._q=[];t.call(this)}e.prototype.next=function(t){this._q.push(t);this._q.length>this._c&&this._q.shift()};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=function(){while(this._q.length>0){this._o.onNext(this._q.shift())}this._o.onCompleted()};return e}(Ne);qe.takeLast=function(t){if(t<0){throw new z}var e=this;return new Ci(function(r){return e.subscribe(new In(r,t))},e)};qe.flatMapConcat=qe.concatMap=function(t,e,r){return new Le(this,t,e,r).merge(1)};var Sn=function(t){Vt(e,t);function e(e,r,n){this.source=e;this.selector=W(r,n,3);t.call(this)}function r(t,e){return function(r,n,i){return t.call(this,e.selector(r,n,i),n,i)}}e.prototype.internalMap=function(t,n){return new e(this.source,r(t,this),n)};e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.selector,this))};Vt(n,Ne);function n(t,e,r){this.o=t;this.selector=e;this.source=r;this.i=0;Ne.call(this)}n.prototype.next=function(t){var e=A(this.selector)(t,this.i++,this.source);if(e===I){return this.o.onError(e.e)}this.o.onNext(e)};n.prototype.error=function(t){this.o.onError(t)};n.prototype.completed=function(){this.o.onCompleted()};return e}(Be);qe.map=qe.select=function(t,e){var r=typeof t==="function"?t:function(){return t};return this instanceof Sn?this.internalMap(r,e):new Sn(this,r,e)};function An(t,e){return function n(i){var o=i;for(var s=0;s<e;s++){var a=o[t[s]];if(typeof a!=="undefined"){o=a}else{return r}}return o}}qe.pluck=function(){var t=arguments.length,e=new Array(t);if(t===0){throw new Error("List of properties cannot be empty.")}for(var r=0;r<t;r++){e[r]=arguments[r]}return this.map(An(e,t))};qe.flatMap=qe.selectMany=qe.mergeMap=function(t,e,r){return new Le(this,t,e,r).mergeAll()};qe.flatMapLatest=qe.switchMap=function(t,e,r){return new Le(this,t,e,r).switchLatest()};var kn=function(t){Vt(e,t);function e(e,r){this.source=e;this._count=r;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this._count))};function r(t,e){this._o=t;this._r=e;Ne.call(this)}Vt(r,Ne);r.prototype.next=function(t){if(this._r<=0){this._o.onNext(t)}else{this._r--}};r.prototype.error=function(t){this._o.onError(t)};r.prototype.completed=function(){this._o.onCompleted()};return e}(Be);qe.skip=function(t){if(t<0){throw new z}return new kn(this,t)};var En=function(t){Vt(e,t);function e(e,r){this.source=e;this._fn=r;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new Pn(t,this))};return e}(Be);var Pn=function(t){Vt(e,t);function e(e,r){this._o=e;this._p=r;this._i=0;this._r=false;t.call(this)}e.prototype.next=function(t){if(!this._r){var e=A(this._p._fn)(t,this._i++,this._p);if(e===I){return this._o.onError(e.e)}this._r=!e}this._r&&this._o.onNext(t)};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=function(){this._o.onCompleted()};return e}(Ne);qe.skipWhile=function(t,e){var r=W(t,e,3);return new En(this,r)};var Tn=function(t){Vt(e,t);function e(e,r){this.source=e;this._count=r;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new r(t,this._count))};function r(t,e){this._o=t;this._c=e;this._r=e;Ne.call(this)}Vt(r,Ne);r.prototype.next=function(t){if(this._r-- >0){this._o.onNext(t);this._r<=0&&this._o.onCompleted()}};r.prototype.error=function(t){this._o.onError(t)};r.prototype.completed=function(){this._o.onCompleted()};return e}(Be);qe.take=function(t,e){if(t<0){throw new z}if(t===0){return tr(e)}return new Tn(this,t)};var Fn=function(t){Vt(e,t);function e(e,r){this.source=e;this._fn=r;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new Mn(t,this))};return e}(Be);var Mn=function(t){Vt(e,t);function e(e,r){this._o=e;this._p=r;this._i=0;this._r=true;t.call(this)}e.prototype.next=function(t){if(this._r){this._r=A(this._p._fn)(t,this._i++,this._p);if(this._r===I){return this._o.onError(this._r.e)}}if(this._r){this._o.onNext(t)}else{this._o.onCompleted()}};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=function(){this._o.onCompleted()};return e}(Ne);qe.takeWhile=function(t,e){var r=W(t,e,3);return new Fn(this,r)};var Dn=function(t){Vt(e,t);function e(e,r,n){this.source=e;this.predicate=W(r,n,3);t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new n(t,this.predicate,this))};function r(t,e){return function(r,n,i){return e.predicate(r,n,i)&&t.call(this,r,n,i)}}e.prototype.internalFilter=function(t,n){return new e(this.source,r(t,this),n)};Vt(n,Ne);function n(t,e,r){this.o=t;this.predicate=e;this.source=r;this.i=0;Ne.call(this)}n.prototype.next=function(t){var e=A(this.predicate)(t,this.i++,this.source);if(e===I){return this.o.onError(e.e)}e&&this.o.onNext(t)};n.prototype.error=function(t){this.o.onError(t)};n.prototype.completed=function(){this.o.onCompleted()};return e}(Be);qe.filter=qe.where=function(t,e){return this instanceof Dn?this.internalFilter(t,e):new Dn(this,t,e)};function Nn(t,e,r,n){var i=new Ai;n.push(Rn(i,e,r));t.apply(e,n);return i.asObservable()}function Rn(t,e,r){return function n(){var i=arguments.length,o=new Array(i);for(var s=0;s<i;s++){o[s]=arguments[s]}if(C(r)){o=A(r).apply(e,o);if(o===I){return t.onError(o.e)}t.onNext(o)}else{if(o.length<=1){t.onNext(o[0])}else{t.onNext(o)}}t.onCompleted()}}Ue.fromCallback=function(t,e,r){return function(){typeof e==="undefined"&&(e=this);var n=arguments.length,i=new Array(n);for(var o=0;o<n;o++){i[o]=arguments[o]}return Nn(t,e,r,i)}};function qn(t,e,r,n){var i=new Ai;n.push(Un(i,e,r));t.apply(e,n);return i.asObservable()}function Un(t,e,r){return function n(){var i=arguments[0];if(i){return t.onError(i)}var o=arguments.length,s=[];for(var a=1;a<o;a++){s[a-1]=arguments[a]}if(C(r)){var s=A(r).apply(e,s);if(s===I){return t.onError(s.e)}t.onNext(s)}else{if(s.length<=1){t.onNext(s[0])}else{t.onNext(s)}}t.onCompleted()}}Ue.fromNodeCallback=function(t,e,r){return function(){typeof e==="undefined"&&(e=this);var n=arguments.length,i=new Array(n);for(var o=0;o<n;o++){i[o]=arguments[o]}return qn(t,e,r,i)}};function On(t){if(h.StaticNodeList){return t instanceof h.StaticNodeList||t instanceof h.NodeList}else{return Object.prototype.toString.call(t)==="[object NodeList]"}}function Bn(t,e,r){this._e=t;this._n=e;this._fn=r;this._e.addEventListener(this._n,this._fn,false);this.isDisposed=false}Bn.prototype.dispose=function(){if(!this.isDisposed){this._e.removeEventListener(this._n,this._fn,false);this.isDisposed=true}};function Ln(t,e,r){var n=new Gt;var i=Object.prototype.toString.call(t);if(On(t)||i==="[object HTMLCollection]"){for(var o=0,s=t.length;o<s;o++){n.add(Ln(t.item(o),e,r))}}else if(t){n.add(new Bn(t,e,r))}return n}d.config.useNativeEvents=false;var zn=function(t){Vt(e,t);function e(e,r,n){this._el=e;this._n=r;this._fn=n;t.call(this)}function r(t,e){return function r(){var n=arguments[0];if(C(e)){n=A(e).apply(null,arguments);if(n===I){return t.onError(n.e)}}t.onNext(n)}}e.prototype.subscribeCore=function(t){return Ln(this._el,this._n,r(t,this._fn))};return e}(Be);Ue.fromEvent=function(t,e,r){if(t.addListener){return Vn(function(r){t.addListener(e,r)},function(r){t.removeListener(e,r)},r)}if(!d.config.useNativeEvents){if(typeof t.on==="function"&&typeof t.off==="function"){return Vn(function(r){t.on(e,r)},function(r){t.off(e,r)},r)}}return new zn(t,e,r).publish().refCount()};var jn=function(t){Vt(e,t);function e(e,r,n){this._add=e;this._del=r;this._fn=n;t.call(this)}function r(t,e){return function r(){var n=arguments[0];if(C(e)){n=A(e).apply(null,arguments);if(n===I){return t.onError(n.e)}}t.onNext(n)}}e.prototype.subscribeCore=function(t){var e=r(t,this._fn);var i=this._add(e);return new n(this._del,e,i)};function n(t,e,r){this._del=t;this._fn=e;this._ret=r;this.isDisposed=false}n.prototype.dispose=function(){if(!this.isDisposed){C(this._del)&&this._del(this._fn,this._ret);this.isDisposed=true}};return e}(Be);var Vn=Ue.fromEventPattern=function(t,e,r){return new jn(t,e,r).publish().refCount()};var Xn=function(t){Vt(e,t);function e(e,r){this._p=e;this._s=r;t.call(this)}function r(t,e){var r=e[0],n=e[1];r.onNext(n);r.onCompleted()}function n(t,e){var r=e[0],n=e[1];r.onError(n)}e.prototype.subscribeCore=function(t){var e=new ee,i=this,o=this._p;if(C(o)){o=A(o)();if(o===I){t.onError(o.e);return e}}o.then(function(n){e.setDisposable(i._s.schedule([t,n],r))},function(r){e.setDisposable(i._s.schedule([t,r],n))});return e};return e}(Be);var Yn=Ue.fromPromise=function(t,e){e||(e=we);return new Xn(t,e)};qe.toPromise=function(t){t||(t=d.config.Promise);if(!t){throw new j("Promise type not provided nor in Rx.config.Promise")}var e=this;return new t(function(t,r){var n;e.subscribe(function(t){n=t},r,function(){t(n)})})}
;Ue.startAsync=function(t){var e=A(t)();if(e===I){return Ar(e.e)}return Yn(e)};var Hn=function(t){Vt(e,t);function e(e,r,n){this.source=e;this._fn1=r;this._fn2=n;t.call(this)}e.prototype.subscribeCore=function(t){var e=this.source.multicast(this._fn1());return new ne(this._fn2(e).subscribe(t),e.connect())};return e}(Be);qe.multicast=function(t,e){return C(t)?new Hn(this,t,e):new Zn(this,t)};qe.publish=function(t){return t&&C(t)?this.multicast(function(){return new Si},t):this.multicast(new Si)};qe.share=function(){return this.publish().refCount()};qe.publishLast=function(t){return t&&C(t)?this.multicast(function(){return new Ai},t):this.multicast(new Ai)};qe.publishValue=function(t,e){return arguments.length===2?this.multicast(function(){return new Ei(e)},t):this.multicast(new Ei(t))};qe.shareValue=function(t){return this.publishValue(t).refCount()};qe.replay=function(t,e,r,n){return t&&C(t)?this.multicast(function(){return new Pi(e,r,n)},t):this.multicast(new Pi(e,r,n))};qe.shareReplay=function(t,e,r){return this.replay(null,t,e,r).refCount()};var Gn=function(t){Vt(e,t);function e(e){this.source=e;this._count=0;this._connectableSubscription=null;t.call(this)}e.prototype.subscribeCore=function(t){var e=this.source.subscribe(t);++this._count===1&&(this._connectableSubscription=this.source.connect());return new r(this,e)};function r(t,e){this._p=t;this._s=e;this.isDisposed=false}r.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=true;this._s.dispose();--this._p._count===0&&this._p._connectableSubscription.dispose()}};return e}(Be);var Zn=d.ConnectableObservable=function(t){Vt(e,t);function e(e,r){this.source=e;this._connection=null;this._source=e.asObservable();this._subject=r;t.call(this)}function r(t,e){this._p=t;this._s=e}r.prototype.dispose=function(){if(this._s){this._s.dispose();this._s=null;this._p._connection=null}};e.prototype.connect=function(){if(!this._connection){if(this._subject.isStopped){return Kt}var t=this._source.subscribe(this._subject);this._connection=new r(this,t)}return this._connection};e.prototype._subscribe=function(t){return this._subject.subscribe(t)};e.prototype.refCount=function(){return new Gn(this)};return e}(Ue);var Qn=function(t){Vt(e,t);function e(e,r){this._dt=e;this._s=r;t.call(this)}e.prototype.subscribeCore=function(t){return this._s.scheduleFuture(t,this._dt,r)};function r(t,e){e.onNext(0);e.onCompleted()}return e}(Be);function Wn(t,e){return new Qn(t,e)}function Kn(t,e,r){return new Ci(function(n){var i=t,o=ue(e);return r.scheduleRecursiveFuture(0,i,function(t,e){if(o>0){var s=r.now();i=new Date(i.getTime()+o);i.getTime()<=s&&(i=new Date(s+o))}n.onNext(t);e(t+1,new Date(i))})})}function Jn(t,e,r){return t===e?new Ci(function(t){return r.schedulePeriodic(0,e,function(e){t.onNext(e);return e+1})}):Ke(function(){return Kn(new Date(r.now()+t),e,r)})}var $n=Ue.interval=function(t,e){return Jn(t,t,ce(e)?e:we)};var ti=Ue.timer=function(t,e,n){var i;ce(n)||(n=we);if(e!=null&&typeof e==="number"){i=e}else if(ce(e)){n=e}if((t instanceof Date||typeof t==="number")&&i===r){return Wn(t,n)}if(t instanceof Date&&i!==r){return Kn(t,e,n)}return Jn(t,i,n)};function ei(t,e,r){return new Ci(function(n){var i=false,o=new re,s=null,a=[],u=false,c;c=t.materialize().timestamp(r).subscribe(function(t){var c,f;if(t.value.kind==="E"){a=[];a.push(t);s=t.value.error;f=!u}else{a.push({value:t.value,timestamp:t.timestamp+e});f=!i;i=true}if(f){if(s!==null){n.onError(s)}else{c=new ee;o.setDisposable(c);c.setDisposable(r.scheduleRecursiveFuture(null,e,function(t,e){var o,c,f,l;if(s!==null){return}u=true;do{f=null;if(a.length>0&&a[0].timestamp-r.now()<=0){f=a.shift().value}if(f!==null){f.accept(n)}}while(f!==null);l=false;c=0;if(a.length>0){l=true;c=Math.max(0,a[0].timestamp-r.now())}else{i=false}o=s;u=false;if(o!==null){n.onError(o)}else if(l){e(null,c)}}))}}});return new ne(c,o)},t)}function ri(t,e,r){return Ke(function(){return ei(t,e-r.now(),r)})}function ni(t,e,r){var n,i;if(C(e)){i=e}else{n=e;i=r}return new Ci(function(e){var r=new Gt,o=false,s=new re;function a(){s.setDisposable(t.subscribe(function(t){var n=A(i)(t);if(n===I){return e.onError(n.e)}var o=new ee;r.add(o);o.setDisposable(n.subscribe(function(){e.onNext(t);r.remove(o);u()},function(t){e.onError(t)},function(){e.onNext(t);r.remove(o);u()}))},function(t){e.onError(t)},function(){o=true;s.dispose();u()}))}function u(){o&&r.length===0&&e.onCompleted()}if(!n){a()}else{s.setDisposable(n.subscribe(a,function(t){e.onError(t)},a))}return new ne(s,r)},t)}qe.delay=function(){var t=arguments[0];if(typeof t==="number"||t instanceof Date){var e=t,r=arguments[1];ce(r)||(r=we);return e instanceof Date?ri(this,e,r):ei(this,e,r)}else if(Ue.isObservable(t)||C(t)){return ni(this,t,arguments[1])}else{throw new Error("Invalid arguments")}};var ii=function(t){Vt(e,t);function e(e,r,n){ce(n)||(n=we);this.source=e;this._dt=r;this._s=n;t.call(this)}e.prototype.subscribeCore=function(t){var e=new re;return new ne(this.source.subscribe(new oi(t,this._dt,this._s,e)),e)};return e}(Be);var oi=function(t){Vt(e,t);function e(e,r,n,i){this._o=e;this._d=r;this._scheduler=n;this._c=i;this._v=null;this._hv=false;this._id=0;t.call(this)}function r(t,e){e.self._hv&&e.self._id===e.currentId&&e.self._o.onNext(e.x);e.self._hv=false}e.prototype.next=function(t){this._hv=true;this._v=t;var e=++this._id,r=new ee;this._c.setDisposable(r);r.setDisposable(this._scheduler.scheduleFuture(this,this._d,function(r,n){n._hv&&n._id===e&&n._o.onNext(t);n._hv=false}))};e.prototype.error=function(t){this._c.dispose();this._o.onError(t);this._hv=false;this._id++};e.prototype.completed=function(){this._c.dispose();this._hv&&this._o.onNext(this._v);this._o.onCompleted();this._hv=false;this._id++};return e}(Ne);function si(t,e){return new Ci(function(r){var n,i=false,o=new re,s=0;var a=t.subscribe(function(t){var a=A(e)(t);if(a===I){return r.onError(a.e)}w(a)&&(a=Yn(a));i=true;n=t;s++;var u=s,c=new ee;o.setDisposable(c);c.setDisposable(a.subscribe(function(){i&&s===u&&r.onNext(n);i=false;c.dispose()},function(t){r.onError(t)},function(){i&&s===u&&r.onNext(n);i=false;c.dispose()}))},function(t){o.dispose();r.onError(t);i=false;s++},function(){o.dispose();i&&r.onNext(n);r.onCompleted();i=false;s++});return new ne(a,o)},t)}qe.debounce=function(){if(C(arguments[0])){return si(this,arguments[0])}else if(typeof arguments[0]==="number"){return new ii(this,arguments[0],arguments[1])}else{throw new Error("Invalid arguments")}};var ai=function(t){Vt(e,t);function e(e,r){this.source=e;this._s=r;t.call(this)}e.prototype.subscribeCore=function(t){return this.source.subscribe(new ui(t,this._s))};return e}(Be);var ui=function(t){Vt(e,t);function e(e,r){this._o=e;this._s=r;t.call(this)}e.prototype.next=function(t){this._o.onNext({value:t,timestamp:this._s.now()})};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=function(){this._o.onCompleted()};return e}(Ne);qe.timestamp=function(t){ce(t)||(t=we);return new ai(this,t)};var ci=function(t){Vt(e,t);function e(e,r){this.source=e;this._sampler=r;t.call(this)}e.prototype.subscribeCore=function(t){var e={o:t,atEnd:false,value:null,hasValue:false,sourceSubscription:new ee};e.sourceSubscription.setDisposable(this.source.subscribe(new li(e)));return new ne(e.sourceSubscription,this._sampler.subscribe(new fi(e)))};return e}(Be);var fi=function(t){Vt(e,t);function e(e){this._s=e;t.call(this)}e.prototype._handleMessage=function(){if(this._s.hasValue){this._s.hasValue=false;this._s.o.onNext(this._s.value)}this._s.atEnd&&this._s.o.onCompleted()};e.prototype.next=function(){this._handleMessage()};e.prototype.error=function(t){this._s.onError(t)};e.prototype.completed=function(){this._handleMessage()};return e}(Ne);var li=function(t){Vt(e,t);function e(e){this._s=e;t.call(this)}e.prototype.next=function(t){this._s.hasValue=true;this._s.value=t};e.prototype.error=function(t){this._s.o.onError(t)};e.prototype.completed=function(){this._s.atEnd=true;this._s.sourceSubscription.dispose()};return e}(Ne);qe.sample=function(t,e){ce(e)||(e=we);return typeof t==="number"?new ci(this,$n(t,e)):new ci(this,t)};var hi=d.TimeoutError=function(t){this.message=t||"Timeout has occurred";this.name="TimeoutError";Error.call(this)};hi.prototype=Object.create(Error.prototype);function di(t,e,r,n){if(C(e)){n=r;r=e;e=gr()}Ue.isObservable(n)||(n=Ar(new hi));return new Ci(function(i){var o=new re,s=new re,a=new ee;o.setDisposable(a);var u=0,c=false;function f(t){var e=u,r=new ee;function a(){c=e===u;return c}s.setDisposable(r);r.setDisposable(t.subscribe(function(){a()&&o.setDisposable(n.subscribe(i));r.dispose()},function(t){a()&&i.onError(t)},function(){a()&&o.setDisposable(n.subscribe(i))}))}f(e);function l(){var t=!c;if(t){u++}return t}a.setDisposable(t.subscribe(function(t){if(l()){i.onNext(t);var e=A(r)(t);if(e===I){return i.onError(e.e)}f(w(e)?Yn(e):e)}},function(t){l()&&i.onError(t)},function(){l()&&i.onCompleted()}));return new ne(o,s)},t)}function pi(t,e,r,n){if(ce(r)){n=r;r=Ar(new hi)}if(r instanceof Error){r=Ar(r)}ce(n)||(n=we);Ue.isObservable(r)||(r=Ar(new hi));return new Ci(function(i){var o=0,s=new ee,a=new re,u=false,c=new re;a.setDisposable(s);function f(){var t=o;c.setDisposable(n.scheduleFuture(null,e,function(){u=o===t;if(u){w(r)&&(r=Yn(r));a.setDisposable(r.subscribe(i))}}))}f();s.setDisposable(t.subscribe(function(t){if(!u){o++;i.onNext(t);f()}},function(t){if(!u){o++;i.onError(t)}},function(){if(!u){o++;i.onCompleted()}}));return new ne(a,c)},t)}qe.timeout=function(){var t=arguments[0];if(t instanceof Date||typeof t==="number"){return pi(this,t,arguments[1],arguments[2])}else if(Ue.isObservable(t)||C(t)){return di(this,t,arguments[1],arguments[2])}else{throw new Error("Invalid arguments")}};qe.throttle=function(t,e){ce(e)||(e=we);var r=+t||0;if(r<=0){throw new RangeError("windowDuration cannot be less or equal zero.")}var n=this;return new Ci(function(t){var i=0;return n.subscribe(function(n){var o=e.now();if(i===0||o-i>=r){i=o;t.onNext(n)}},function(e){t.onError(e)},function(){t.onCompleted()})},n)};var vi=function(t){Vt(e,t);function e(e,r){this.source=e;this.controller=new Si;this.paused=true;if(r&&r.subscribe){this.pauser=this.controller.merge(r)}else{this.pauser=this.controller}t.call(this)}e.prototype._subscribe=function(t){var e=this.source.publish(),r=e.subscribe(t),n=Kt;var i=this.pauser.startWith(!this.paused).distinctUntilChanged().subscribe(function(t){if(t){n=e.connect()}else{n.dispose();n=Kt}});return new ie([r,n,i])};e.prototype.pause=function(){this.paused=true;this.controller.onNext(false)};e.prototype.resume=function(){this.paused=false;this.controller.onNext(true)};return e}(Ue);qe.pausable=function(t){return new vi(this,t)};function mi(t,e,r){return new Ci(function(n){var i=[false,false],o=false,s=false,a=new Array(2),u;function c(t,e){a[e]=t;i[e]=true;if(o||(o=i.every(v))){if(u){return n.onError(u)}var c=A(r).apply(null,a);if(c===I){return n.onError(c.e)}n.onNext(c)}s&&a[1]&&n.onCompleted()}return new ne(t.subscribe(function(t){c(t,0)},function(t){if(a[1]){n.onError(t)}else{u=t}},function(){s=true;a[1]&&n.onCompleted()}),e.subscribe(function(t){c(t,1)},function(t){n.onError(t)},function(){s=true;c(true,1)}))},t)}var gi=function(t){Vt(e,t);function e(e,r){this.source=e;this.controller=new Si;this.paused=true;if(r&&r.subscribe){this.pauser=this.controller.merge(r)}else{this.pauser=this.controller}t.call(this)}e.prototype._subscribe=function(t){var e=[],n;function i(){while(e.length>0){t.onNext(e.shift())}}var o=mi(this.source,this.pauser.startWith(!this.paused).distinctUntilChanged(),function(t,e){return{data:t,shouldFire:e}}).subscribe(function(o){if(n!==r&&o.shouldFire!==n){n=o.shouldFire;if(o.shouldFire){i()}}else{n=o.shouldFire;if(o.shouldFire){t.onNext(o.data)}else{e.push(o.data)}}},function(e){i();t.onError(e)},function(){i();t.onCompleted()});return o};e.prototype.pause=function(){this.paused=true;this.controller.onNext(false)};e.prototype.resume=function(){this.paused=false;this.controller.onNext(true)};return e}(Ue);qe.pausableBuffered=function(t){return new gi(this,t)};var yi=function(t){Vt(e,t);function e(e,r,n){t.call(this);this.subject=new bi(r,n);this.source=e.multicast(this.subject).refCount()}e.prototype._subscribe=function(t){return this.source.subscribe(t)};e.prototype.request=function(t){return this.subject.request(t==null?-1:t)};return e}(Ue);var bi=function(t){Vt(e,t);function e(e,r){e==null&&(e=true);t.call(this);this.subject=new Si;this.enableQueue=e;this.queue=e?[]:null;this.requestedCount=0;this.requestedDisposable=null;this.error=null;this.hasFailed=false;this.hasCompleted=false;this.scheduler=r||de}Xt(e.prototype,Me,{_subscribe:function(t){return this.subject.subscribe(t)},onCompleted:function(){this.hasCompleted=true;if(!this.enableQueue||this.queue.length===0){this.subject.onCompleted();this.disposeCurrentRequest()}else{this.queue.push(Se.createOnCompleted())}},onError:function(t){this.hasFailed=true;this.error=t;if(!this.enableQueue||this.queue.length===0){this.subject.onError(t);this.disposeCurrentRequest()}else{this.queue.push(Se.createOnError(t))}},onNext:function(t){if(this.requestedCount<=0){this.enableQueue&&this.queue.push(Se.createOnNext(t))}else{this.requestedCount--===0&&this.disposeCurrentRequest();this.subject.onNext(t)}},_processRequest:function(t){if(this.enableQueue){while(this.queue.length>0&&(t>0||this.queue[0].kind!=="N")){var e=this.queue.shift();e.accept(this.subject);if(e.kind==="N"){t--}else{this.disposeCurrentRequest();this.queue=[]}}}return t},request:function(t){this.disposeCurrentRequest();var e=this;this.requestedDisposable=this.scheduler.schedule(t,function(t,r){var n=e._processRequest(r);var i=e.hasCompleted||e.hasFailed;if(!i&&n>0){e.requestedCount=n;return Wt(function(){e.requestedCount=0})}});return this.requestedDisposable},disposeCurrentRequest:function(){if(this.requestedDisposable){this.requestedDisposable.dispose();this.requestedDisposable=null}}});return e}(Ue);qe.controlled=function(t,e){if(t&&ce(t)){e=t;t=true}if(t==null){t=true}return new yi(this,t,e)};qe.pipe=function(t){var e=this.pausableBuffered();function r(){e.resume()}t.addListener("drain",r);e.subscribe(function(r){!t.write(r)&&e.pause()},function(e){t.emit("error",e)},function(){!t._isStdio&&t.end();t.removeListener("drain",r)});e.resume();return t};var _i=function(t){Vt(e,t);function e(e,r){this._o=e;this._xform=r;t.call(this)}e.prototype.next=function(t){var e=A(this._xform["@@transducer/step"]).call(this._xform,this._o,t);if(e===I){this._o.onError(e.e)}};e.prototype.error=function(t){this._o.onError(t)};e.prototype.completed=function(){this._xform["@@transducer/result"](this._o)};return e}(Ne);function wi(t){return{"@@transducer/init":function(){return t},"@@transducer/step":function(t,e){return t.onNext(e)},"@@transducer/result":function(t){return t.onCompleted()}}}qe.transduce=function(t){var e=this;return new Ci(function(r){var n=t(wi(r));return e.subscribe(new _i(r,n))},e)};var Ci=d.AnonymousObservable=function(t){Vt(n,t);function e(t){return t&&C(t.dispose)?t:C(t)?Wt(t):Kt}function r(t,r){var n=r[0],i=r[1];var o=A(i.__subscribe).call(i,n);if(o===I&&!n.fail(I.e)){k(I.e)}n.setDisposable(e(o))}function n(e,r){this.source=r;this.__subscribe=e;t.call(this)}n.prototype._subscribe=function(t){var e=new xi(t),n=[e,this];if(de.scheduleRequired()){de.schedule(n,r)}else{r(null,n)}return e};return n}(Ue);var xi=function(t){Vt(e,t);function e(e){t.call(this);this.observer=e;this.m=new ee}var r=e.prototype;r.next=function(t){var e=A(this.observer.onNext).call(this.observer,t);if(e===I){this.dispose();k(e.e)}};r.error=function(t){var e=A(this.observer.onError).call(this.observer,t);this.dispose();e===I&&k(e.e)};r.completed=function(){var t=A(this.observer.onCompleted).call(this.observer);this.dispose();t===I&&k(t.e)};r.setDisposable=function(t){this.m.setDisposable(t)};r.getDisposable=function(){return this.m.getDisposable()};r.dispose=function(){t.prototype.dispose.call(this);this.m.dispose()};return e}(Ne);var Ii=function(t,e){this._s=t;this._o=e};Ii.prototype.dispose=function(){if(!this._s.isDisposed&&this._o!==null){var t=this._s.observers.indexOf(this._o);this._s.observers.splice(t,1);this._o=null}};var Si=d.Subject=function(t){Vt(e,t);function e(){t.call(this);this.isDisposed=false;this.isStopped=false;this.observers=[];this.hasError=false}Xt(e.prototype,Me.prototype,{_subscribe:function(t){$t(this);if(!this.isStopped){this.observers.push(t);return new Ii(this,t)}if(this.hasError){t.onError(this.error);return Kt}t.onCompleted();return Kt},hasObservers:function(){$t(this);return this.observers.length>0},onCompleted:function(){$t(this);if(!this.isStopped){this.isStopped=true;for(var t=0,e=x(this.observers),r=e.length;t<r;t++){e[t].onCompleted()}this.observers.length=0}},onError:function(t){$t(this);if(!this.isStopped){this.isStopped=true;this.error=t;this.hasError=true;for(var e=0,r=x(this.observers),n=r.length;e<n;e++){r[e].onError(t)}this.observers.length=0}},onNext:function(t){$t(this);if(!this.isStopped){for(var e=0,r=x(this.observers),n=r.length;e<n;e++){r[e].onNext(t)}}},dispose:function(){this.isDisposed=true;this.observers=null}});e.create=function(t,e){return new ki(t,e)};return e}(Ue);var Ai=d.AsyncSubject=function(t){Vt(e,t);function e(){t.call(this);this.isDisposed=false;this.isStopped=false;this.hasValue=false;this.observers=[];this.hasError=false}Xt(e.prototype,Me.prototype,{_subscribe:function(t){$t(this);if(!this.isStopped){this.observers.push(t);return new Ii(this,t)}if(this.hasError){t.onError(this.error)}else if(this.hasValue){t.onNext(this.value);t.onCompleted()}else{t.onCompleted()}return Kt},hasObservers:function(){$t(this);return this.observers.length>0},onCompleted:function(){var t,e;$t(this);if(!this.isStopped){this.isStopped=true;var r=x(this.observers),e=r.length;if(this.hasValue){for(t=0;t<e;t++){var n=r[t];n.onNext(this.value);n.onCompleted()}}else{for(t=0;t<e;t++){r[t].onCompleted()}}this.observers.length=0}},onError:function(t){$t(this);if(!this.isStopped){this.isStopped=true;this.hasError=true;this.error=t;for(var e=0,r=x(this.observers),n=r.length;e<n;e++){r[e].onError(t)}this.observers.length=0}},onNext:function(t){$t(this);if(this.isStopped){return}this.value=t;this.hasValue=true},dispose:function(){this.isDisposed=true;this.observers=null;this.error=null;this.value=null}});return e}(Ue);var ki=d.AnonymousSubject=function(t){Vt(e,t);function e(e,r){this.observer=e;this.observable=r;t.call(this)}Xt(e.prototype,Me.prototype,{_subscribe:function(t){return this.observable.subscribe(t)},onCompleted:function(){this.observer.onCompleted()},onError:function(t){this.observer.onError(t)},onNext:function(t){this.observer.onNext(t)}});return e}(Ue);var Ei=d.BehaviorSubject=function(t){Vt(e,t);function e(e){t.call(this);this.value=e;this.observers=[];this.isDisposed=false;this.isStopped=false;this.hasError=false}Xt(e.prototype,Me.prototype,{_subscribe:function(t){$t(this);if(!this.isStopped){this.observers.push(t);t.onNext(this.value);return new Ii(this,t)}if(this.hasError){t.onError(this.error)}else{t.onCompleted()}return Kt},getValue:function(){$t(this);if(this.hasError){k(this.error)}return this.value},hasObservers:function(){$t(this);return this.observers.length>0},onCompleted:function(){$t(this);if(this.isStopped){return}this.isStopped=true;for(var t=0,e=x(this.observers),r=e.length;t<r;t++){e[t].onCompleted()}this.observers.length=0},onError:function(t){$t(this);if(this.isStopped){return}this.isStopped=true;this.hasError=true;this.error=t;for(var e=0,r=x(this.observers),n=r.length;e<n;e++){r[e].onError(t)}this.observers.length=0},onNext:function(t){$t(this);if(this.isStopped){return}this.value=t;for(var e=0,r=x(this.observers),n=r.length;e<n;e++){r[e].onNext(t)}},dispose:function(){this.isDisposed=true;this.observers=null;this.value=null;this.error=null}});return e}(Ue);var Pi=d.ReplaySubject=function(t){var e=Math.pow(2,53)-1;function r(t,e){return Wt(function(){e.dispose();!t.isDisposed&&t.observers.splice(t.observers.indexOf(e),1)})}Vt(n,t);function n(r,n,i){this.bufferSize=r==null?e:r;this.windowSize=n==null?e:n;this.scheduler=i||de;this.q=[];this.observers=[];this.isStopped=false;this.isDisposed=false;this.hasError=false;this.error=null;t.call(this)}Xt(n.prototype,Me.prototype,{_subscribe:function(t){$t(this);var e=new Oe(this.scheduler,t),n=r(this,e);this._trim(this.scheduler.now());this.observers.push(e);for(var i=0,o=this.q.length;i<o;i++){e.onNext(this.q[i].value)}if(this.hasError){e.onError(this.error)}else if(this.isStopped){e.onCompleted()}e.ensureActive();return n},hasObservers:function(){$t(this);return this.observers.length>0},_trim:function(t){while(this.q.length>this.bufferSize){this.q.shift()}while(this.q.length>0&&t-this.q[0].interval>this.windowSize){this.q.shift()}},onNext:function(t){$t(this);if(this.isStopped){return}var e=this.scheduler.now();this.q.push({interval:e,value:t});this._trim(e);for(var r=0,n=x(this.observers),i=n.length;r<i;r++){var o=n[r];o.onNext(t);o.ensureActive()}},onError:function(t){$t(this);if(this.isStopped){return}this.isStopped=true;this.error=t;this.hasError=true;var e=this.scheduler.now();this._trim(e);for(var r=0,n=x(this.observers),i=n.length;r<i;r++){var o=n[r];o.onError(t);o.ensureActive()}this.observers.length=0},onCompleted:function(){$t(this);if(this.isStopped){return}this.isStopped=true;var t=this.scheduler.now();this._trim(t);for(var e=0,r=x(this.observers),n=r.length;e<n;e++){var i=r[e];i.onCompleted();i.ensureActive()}this.observers.length=0},dispose:function(){this.isDisposed=true;this.observers=null}});return n}(Ue);d.Pauser=function(t){Vt(e,t);function e(){t.call(this)}e.prototype.pause=function(){this.onNext(false)};e.prototype.resume=function(){this.onNext(true)};return e}(Si);t.Rx=d;var Ti=U()}).call(this,n,e);var i=n.Rx;/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){t.VERSION={number:"1.1.6",date:"June 26 2017"}})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(t){var e;(function(t){function e(t){return t.creator&&t.chunkSize}t.is=e;function r(t,e,r,n,i){if(t.currentIndex>=t.chunkSize){t.currentIndex=0;t.current=t.creator(t.chunkSize);t.parts[t.parts.length]=t.current}t.current[t.currentIndex++]=e;t.current[t.currentIndex++]=r;t.current[t.currentIndex++]=n;t.current[t.currentIndex++]=i;return t.elementCount++}t.add4=r;function n(t,e,r,n){if(t.currentIndex>=t.chunkSize){t.currentIndex=0;t.current=t.creator(t.chunkSize);t.parts[t.parts.length]=t.current}t.current[t.currentIndex++]=e;t.current[t.currentIndex++]=r;t.current[t.currentIndex++]=n;return t.elementCount++}t.add3=n;function i(t,e,r){if(t.currentIndex>=t.chunkSize){t.currentIndex=0;t.current=t.creator(t.chunkSize);t.parts[t.parts.length]=t.current}t.current[t.currentIndex++]=e;t.current[t.currentIndex++]=r;return t.elementCount++}t.add2=i;function o(t,e){if(t.currentIndex>=t.chunkSize){t.currentIndex=0;t.current=t.creator(t.chunkSize);t.parts[t.parts.length]=t.current}t.current[t.currentIndex++]=e;return t.elementCount++}t.add=o;function s(t){var e=t.creator(t.elementSize*t.elementCount),r=(t.parts.length-1)*t.chunkSize,n=0,i;if(t.parts.length>1){if(t.parts[0].buffer){for(var o=0;o<t.parts.length-1;o++){e.set(t.parts[o],t.chunkSize*o)}}else{for(var o=0;o<t.parts.length-1;o++){n=t.chunkSize*o;i=t.parts[o];for(var s=0;s<t.chunkSize;s++){e[n+s]=i[s]}}}}if(t.current.buffer&&t.currentIndex>=t.chunkSize){e.set(t.current,t.chunkSize*(t.parts.length-1))}else{for(var o=0;o<t.currentIndex;o++){e[r+o]=t.current[o]}}return e}t.compact=s;function a(t){if(t===void 0){t=262144}return p(function(t){return new Float32Array(t)},t,3)}t.forVertex3D=a;function u(t){if(t===void 0){t=262144}return p(function(t){return new Uint32Array(t)},t,3)}t.forIndexBuffer=u;function c(t){if(t===void 0){t=131072}return p(function(t){return new Int32Array(t)},t,2)}t.forTokenIndices=c;function f(t){if(t===void 0){t=131072}return p(function(t){return new Int32Array(t)},t,1)}t.forIndices=f;function l(t){if(t===void 0){t=131072}return p(function(t){return new Int32Array(t)},t,1)}t.forInt32=l;function h(t){if(t===void 0){t=131072}return p(function(t){return new Float32Array(t)},t,1)}t.forFloat32=h;function d(t){if(t===void 0){t=131072}return p(function(t){return[]},t,1)}t.forArray=d;function p(t,e,r){e=e|0;if(e<=0)e=1;var n=e*r;var i=t(n);return{elementSize:r,chunkSize:n,creator:t,current:i,parts:[i],currentIndex:0,elementCount:0}}t.create=p})(e=t.ChunkedArray||(t.ChunkedArray={}))})(e=t.Utils||(t.Utils={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(t){var e;(function(t){"use strict";function e(t,e,n){while(e<n&&t.charCodeAt(e)===32)e++;return r(t,e,n)}t.parseIntSkipTrailingWhitespace=e;function r(t,e,r){var n=0,i=1;if(t.charCodeAt(e)===45){i=-1;e++}for(;e<r;e++){var o=t.charCodeAt(e)-48;if(o>9||o<0)return i*n|0;else n=10*n+o|0}return i*n}t.parseInt=r;function n(t,e,n,i){if(e.charCodeAt(n)===43)n++;return t*Math.pow(10,r(e,n,i))}function i(t,e,r){while(e<r&&t.charCodeAt(e)===32)e++;return o(t,e,r)}t.parseFloatSkipTrailingWhitespace=i;function o(t,e,r){var i=1,o=0,s=0,a=1;if(t.charCodeAt(e)===45){i=-1;++e}while(e<r){var u=t.charCodeAt(e)-48;if(u>=0&&u<10){o=o*10+u;++e}else if(u===-2){++e;while(e<r){u=t.charCodeAt(e)-48;if(u>=0&&u<10){s=10*s+u;a=10*a;++e}else if(u===53||u===21){return n(i*(o+s/a),t,e+1,r)}else{return i*(o+s/a)}}return i*(o+s/a)}else if(u===53||u===21){return n(i*o,t,e+1,r)}else break}return i*o}t.parseFloat=o})(e=t.FastNumberParsers||(t.FastNumberParsers={}))})(e=t.Utils||(t.Utils={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(t){var e=[];(function(){var t="";for(var r=0;r<512;r++){e[r]=t;t=t+" "}})();var r;(function(t){function r(t){if(t===void 0){t=512}return{chunkData:[],chunkOffset:0,chunkCapacity:t,data:[]}}t.create=r;function n(t){if(!t.data.length){if(t.chunkData.length===t.chunkOffset)return t.chunkData.join("");return t.chunkData.splice(0,t.chunkOffset).join("")}if(t.chunkOffset>0){t.data[t.data.length]=t.chunkData.splice(0,t.chunkOffset).join("")}return t.data.join("")}t.asString=n;function i(t,e){o(t);for(var r=0,n=t.data;r<n.length;r++){var i=n[r];e.writeString(i)}}t.writeTo=i;function o(t){if(t.chunkOffset>0){if(t.chunkData.length===t.chunkOffset)t.data[t.data.length]=t.chunkData.join("");else t.data[t.data.length]=t.chunkData.splice(0,t.chunkOffset).join("");t.chunkOffset=0}}function s(t){u(t,"\n")}t.newline=s;function a(t,r){u(t,e[r])}t.whitespace=a;function u(t,e){if(e===undefined||e===null){return}if(t.chunkOffset===t.chunkCapacity){t.data[t.data.length]=t.chunkData.join("");t.chunkOffset=0}t.chunkData[t.chunkOffset++]=e}t.write=u;function c(t,e){if(t.chunkOffset===t.chunkCapacity){t.data[t.data.length]=t.chunkData.join("");t.chunkOffset=0}t.chunkData[t.chunkOffset++]=e}t.writeSafe=c;function f(t,r,n){if(r===undefined||r===null){u(t,e[n])}var i=n-r.length;if(i>0)u(t,e[i]);u(t,r)}t.writePadLeft=f;function l(t,r,n){if(r===undefined||r===null){u(t,e[n])}var i=n-r.length;u(t,r);if(i>0)u(t,e[i])}t.writePadRight=l;function h(t,e){u(t,""+e)}t.writeInteger=h;function d(t,r,n){var i=""+r;var o=n-i.length;if(o>0)u(t,e[o]);u(t,i)}t.writeIntegerPadLeft=d;function p(t,r,n){var i=""+r;var o=n-i.length;u(t,i);if(o>0)u(t,e[o])}t.writeIntegerPadRight=p;function v(t,e,r){u(t,""+Math.round(r*e)/r)}t.writeFloat=v;function m(t,r,n,i){var o=""+Math.round(n*r)/n;var s=i-o.length;if(s>0)u(t,e[s]);u(t,o)}t.writeFloatPadLeft=m;function g(t,r,n,i){var o=""+Math.round(n*r)/n;var s=i-o.length;u(t,o);if(s>0)u(t,e[s])}t.writeFloatPadRight=g})(r=t.StringWriter||(t.StringWriter={}))})(e=t.Utils||(t.Utils={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){"use strict";var e=function(){function t(){this.isDefined=false}t.prototype.getString=function(t){return null};t.prototype.getInteger=function(t){return 0};t.prototype.getFloat=function(t){return 0};t.prototype.getValuePresence=function(t){return 1};t.prototype.areValuesEqual=function(t,e){return true};t.prototype.stringEquals=function(t,e){return e===null};return t}();t.UndefinedColumn=new e;var r;(function(t){function e(t,e,r,n,i){var o=[];for(var s=1;s<=r;s++){var a=[];for(var u=1;u<=n;u++){a[u-1]=t.getColumn(e+"["+s+"]["+u+"]").getFloat(i)}o[s-1]=a}return o}t.getMatrix=e;function r(t,e,r,n,i){var o=[];for(var s=1;s<=r;s++){o[s-1]=t.getColumn(e+"["+s+"]").getFloat(i)}return o}t.getVector=r})(r=t.Category||(t.Category={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){"use strict";var e;(function(t){function e(t,e){if(e===void 0){e=-1}return new r(t,e)}t.error=e;function i(t,e){if(e===void 0){e=[]}return new n(t,e)}t.success=i})(e=t.ParserResult||(t.ParserResult={}));var r=function(){function t(t,e){this.message=t;this.line=e;this.isError=true}t.prototype.toString=function(){if(this.line>=0){return"[Line "+this.line+"] "+this.message}return this.message};return t}();t.ParserError=r;var n=function(){function t(t,e){this.result=t;this.warnings=e;this.isError=false}return t}();t.ParserSuccess=n})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(e){"use strict";var r;(function(t){function e(){return Object.create(null)}t.create=e;function r(t,e){if(e.length>6)return e;var r=t[e];if(r!==void 0)return r;t[e]=e;return e}t.get=r})(r||(r={}));var n=function(){function t(t){this.dataBlocks=[];this.data=t}t.prototype.toJSON=function(){return this.dataBlocks.map(function(t){return t.toJSON()})};return t}();e.File=n;var i=function(){function t(t,e){this.header=e;this.data=t;this.categoryList=[];this.additionalData={};this.categoryMap=new Map}Object.defineProperty(t.prototype,"categories",{get:function(){return this.categoryList},enumerable:true,configurable:true});t.prototype.getCategory=function(t){return this.categoryMap.get(t)};t.prototype.addCategory=function(t){this.categoryList[this.categoryList.length]=t;this.categoryMap.set(t.name,t)};t.prototype.toJSON=function(){return{id:this.header,categories:this.categoryList.map(function(t){return t.toJSON()}),additionalData:this.additionalData}};return t}();e.DataBlock=i;var o=function(){function e(t,e,r,n,i,o,s){this.name=e;this.tokens=o;this.data=t;this.startIndex=r;this.endIndex=n;this.columnCount=i.length;this.rowCount=s/i.length|0;this.columnIndices=new Map;this.columnNameList=[];for(var a=0;a<i.length;a++){var u=i[a].substr(e.length+1);this.columnIndices.set(u,a);this.columnNameList.push(u)}}Object.defineProperty(e.prototype,"columnNames",{get:function(){return this.columnNameList},enumerable:true,configurable:true});e.prototype.getColumn=function(e){var r=this.columnIndices.get(e);if(r!==void 0)return new u(this,this.data,e,r);return t.UndefinedColumn};e.prototype.toJSON=function(){var t=[],e=this.data,n=this.tokens;var i=this.columnNameList;var o=r.create();for(var s=0;s<this.rowCount;s++){var a={};for(var u=0;u<this.columnCount;u++){var c=(s*this.columnCount+u)*2;a[i[u]]=r.get(o,e.substring(n[c],n[c+1]))}t[s]=a}return{name:this.name,columns:i,rows:t}};return e}();e.Category=o;var s=t.Utils.FastNumberParsers.parseInt;var a=t.Utils.FastNumberParsers.parseFloat;var u=function(){function t(t,e,n,i){this.data=e;this.name=n;this.index=i;this.stringPool=r.create();this.isDefined=true;this.tokens=t.tokens;this.columnCount=t.columnCount}t.prototype.getString=function(t){var e=(t*this.columnCount+this.index)*2;var n=r.get(this.stringPool,this.data.substring(this.tokens[e],this.tokens[e+1]));if(n==="."||n==="?")return null;return n};t.prototype.getInteger=function(t){var e=(t*this.columnCount+this.index)*2;return s(this.data,this.tokens[e],this.tokens[e+1])};t.prototype.getFloat=function(t){var e=(t*this.columnCount+this.index)*2;return a(this.data,this.tokens[e],this.tokens[e+1])};t.prototype.stringEquals=function(t,e){var r=(t*this.columnCount+this.index)*2,n=this.tokens[r],i=e.length;if(i!==this.tokens[r+1]-n)return false;for(var o=0;o<i;o++){if(this.data.charCodeAt(o+n)!==e.charCodeAt(o))return false}return true};t.prototype.areValuesEqual=function(t,e){var r=(t*this.columnCount+this.index)*2,n=(e*this.columnCount+this.index)*2;var i=this.tokens[r],o=this.tokens[n],s=this.tokens[r+1]-i;if(s!==this.tokens[n+1]-o)return false;for(var a=0;a<s;a++){if(this.data.charCodeAt(a+i)!==this.data.charCodeAt(a+o)){return false}}return true};t.prototype.getValuePresence=function(t){var e=t*this.columnCount+this.index;var r=this.tokens[2*e];if(this.tokens[2*e+1]-r!==1)return 0;var n=this.data.charCodeAt(r);if(n===46)return 1;if(n===63)return 2;return 0};return t}();e.Column=u})(e=t.Text||(t.Text={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(e){"use strict";var r;(function(t){function e(t){var e=new Int32Array(1.61*t.tokens.length|0);e.set(t.tokens);t.tokens=e;t.tokensLenMinus2=e.length-2|0}function r(t,r,n){if(t.count>=t.tokensLenMinus2){e(t)}t.tokens[t.count++]=r;t.tokens[t.count++]=n}t.addToken=r;function n(t){return{tokensLenMinus2:t-2|0,count:0,tokens:new Int32Array(t)}}t.create=n})(r||(r={}));function n(t){while(t.position<t.length){switch(t.data.charCodeAt(t.position)){case 9:case 10:case 13:case 32:t.currentTokenEnd=t.position;return;default:++t.position;break}}t.currentTokenEnd=t.position}function i(t,e){var r,n;++t.position;while(t.position<t.length){n=t.data.charCodeAt(t.position);if(n===e){r=t.data.charCodeAt(t.position+1);switch(r){case 9:case 10:case 13:case 32:t.currentTokenStart++;t.currentTokenEnd=t.position;t.isEscaped=true;++t.position;return;default:if(r===void 0){t.currentTokenStart++;t.currentTokenEnd=t.position;t.isEscaped=true;++t.position;return}++t.position;break}}else{if(n===10||n===13){t.currentTokenEnd=t.position;return}++t.position}}t.currentTokenEnd=t.position}function o(t){var e=59,r=t.position+1,n;while(r<t.length){n=t.data.charCodeAt(r);if(n===59&&(e===10||e===13)){t.position=r+1;t.currentTokenStart++;r--;n=t.data.charCodeAt(r);while(n===10||n===13){r--;n=t.data.charCodeAt(r)}t.currentTokenEnd=r+1;t.isEscaped=true;return}else{if(n===13){t.currentLineNumber++}else if(n===10&&e!==13){t.currentLineNumber++}e=n;++r}}t.position=r;return e}function s(t){while(t.position<t.length){var e=t.data.charCodeAt(t.position);if(e===10||e===13){return}++t.position}}function a(t){var e=10;while(t.position<t.length){var r=t.data.charCodeAt(t.position);switch(r){case 9:case 32:e=r;++t.position;break;case 10:if(e!==13){++t.currentLineNumber}e=r;++t.position;break;case 13:e=r;++t.position;++t.currentLineNumber;break;default:return e}}return e}function u(t){var e=t.data.charCodeAt(t.currentTokenStart);if(e!==68&&e!==100)return false;e=t.data.charCodeAt(t.currentTokenStart+1);if(e!==65&&e!==97)return false;e=t.data.charCodeAt(t.currentTokenStart+2);if(e!==84&&e!==116)return false;e=t.data.charCodeAt(t.currentTokenStart+3);if(e!==65&&e!==97)return false;return true}function c(t){var e=t.data.charCodeAt(t.currentTokenStart);if(e!==83&&e!==115)return false;e=t.data.charCodeAt(t.currentTokenStart+1);if(e!==65&&e!==97)return false;e=t.data.charCodeAt(t.currentTokenStart+2);if(e!==86&&e!==118)return false;e=t.data.charCodeAt(t.currentTokenStart+3);if(e!==69&&e!==101)return false;return true}function f(t){if(t.currentTokenEnd-t.currentTokenStart!==5)return false;var e=t.data.charCodeAt(t.currentTokenStart);if(e!==76&&e!==108)return false;e=t.data.charCodeAt(t.currentTokenStart+1);if(e!==79&&e!==111)return false;e=t.data.charCodeAt(t.currentTokenStart+2);if(e!==79&&e!==111)return false;e=t.data.charCodeAt(t.currentTokenStart+3);if(e!==80&&e!==112)return false;return true}function l(t,e,r){var n,i=r-e,o=t.currentTokenStart-e,s=t.currentTokenEnd-t.currentTokenStart;if(s<i)return false;for(n=e;n<r;++n){if(t.data.charCodeAt(n)!==t.data.charCodeAt(n+o))return false}if(i===s)return true;if(t.data.charCodeAt(n+o)===46){return true}return false}function h(t){var e;for(e=t.currentTokenStart;e<t.currentTokenEnd;++e){if(t.data.charCodeAt(e)===46)return e}return e}function d(t,e){return t.data.substring(t.currentTokenStart,e)}function p(t){return t.data.substring(t.currentTokenStart,t.currentTokenEnd)}function v(t){var e=a(t);if(t.position>=t.length){t.currentTokenType=6;return}t.currentTokenStart=t.position;t.currentTokenEnd=t.position;t.isEscaped=false;var r=t.data.charCodeAt(t.position);switch(r){case 35:s(t);t.currentTokenType=5;break;case 34:case 39:i(t,r);t.currentTokenType=3;break;case 59:if(e===10||e===13){o(t)}else{n(t)}t.currentTokenType=3;break;default:n(t);if(t.isEscaped){t.currentTokenType=3}else if(t.data.charCodeAt(t.currentTokenStart)===95){t.currentTokenType=4}else if(t.currentTokenEnd-t.currentTokenStart>=5&&t.data.charCodeAt(t.currentTokenStart+4)===95){if(u(t))t.currentTokenType=0;else if(c(t))t.currentTokenType=1;else if(f(t))t.currentTokenType=2;else t.currentTokenType=3}else{t.currentTokenType=3}break}}function m(t){v(t);while(t.currentTokenType===5)v(t)}function g(t){return{data:t,length:t.length,position:0,currentTokenStart:0,currentTokenEnd:0,currentTokenType:6,currentLineNumber:1,isEscaped:false}}function y(t,n){var i=t.currentTokenStart,o=h(t),s=d(t,o),a,u=[],c=r.create(512),f=0,v=true;while(v){if(t.currentTokenType!==4||!l(t,i,o)){v=false;break}a=p(t);m(t);if(t.currentTokenType!==3){return{hasError:true,errorLine:t.currentLineNumber,errorMessage:"Expected value."}}u[u.length]=a;r.addToken(c,t.currentTokenStart,t.currentTokenEnd);f++;m(t)}n.addCategory(new e.Category(n.data,s,i,t.currentTokenStart,u,c.tokens,f));return{hasError:false,errorLine:0,errorMessage:""}}function b(t,n){var i=t.currentTokenStart,o=t.currentLineNumber;m(t);var s=d(t,h(t)),a=[],u=r.create(s==="_atom_site"?n.data.length/1.85|0:1024),c=0;while(t.currentTokenType===4){a[a.length]=p(t);m(t)}while(t.currentTokenType===3){r.addToken(u,t.currentTokenStart,t.currentTokenEnd);c++;m(t)}if(c%a.length!==0){return{hasError:true,errorLine:t.currentLineNumber,errorMessage:"The number of values for loop starting at line "+o+" is not a multiple of the number of columns."}}n.addCategory(new e.Category(n.data,s,i,t.currentTokenStart,a,u.tokens,c));return{hasError:false,errorLine:0,errorMessage:""}}function _(e,r){return t.ParserResult.error(r,e)}function w(e){return t.ParserResult.success(e)}function C(t){var r=g(t),n,i,o=new e.File(t),s=new e.DataBlock(t,"default"),a=new e.DataBlock(t,"empty"),u=false,c;m(r);while(r.currentTokenType!==6){var f=r.currentTokenType;if(f===0){if(u){return _(r.currentLineNumber,"Unexpected data block inside a save frame.")}if(s.categories.length>0){o.dataBlocks.push(s)}s=new e.DataBlock(t,t.substring(r.currentTokenStart+5,r.currentTokenEnd));m(r)}else if(f===1){i=t.substring(r.currentTokenStart+5,r.currentTokenEnd);if(i.length===0){if(a.categories.length>0){c=s.additionalData["saveFrames"];if(!c){c=[];s.additionalData["saveFrames"]=c}c[c.length]=a}u=false}else{if(u){return _(r.currentLineNumber,"Save frames cannot be nested.")}u=true;a=new e.DataBlock(t,i)}m(r)}else if(f===2){n=b(r,u?a:s);if(n.hasError){return _(n.errorLine,n.errorMessage)}}else if(f===4){n=y(r,u?a:s);if(n.hasError){return _(n.errorLine,n.errorMessage)}}else{return _(r.currentLineNumber,"Unexpected token. Expected data_, loop_, or data name.")}}if(u){return _(r.currentLineNumber,"Unfinished save frame (`"+a.header+"`).")}if(s.categories.length>0){o.dataBlocks.push(s)}return w(o)}function x(t){return C(t)}e.parse=x})(e=t.Text||(t.Text={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(e){"use strict";var r=t.Utils.StringWriter;var n=function(){function t(){this.writer=r.create();this.encoded=false;this.dataBlockCreated=false}t.prototype.startDataBlock=function(t){this.dataBlockCreated=true;r.write(this.writer,"data_"+(t||"").replace(/[ \n\t]/g,"").toUpperCase()+"\n#\n")};t.prototype.writeCategory=function(t,e){if(this.encoded){throw new Error("The writer contents have already been encoded, no more writing.")}if(!this.dataBlockCreated){throw new Error("No data block created.")}var r=!e||!e.length?[t(void 0)]:e.map(function(e){return t(e)});var n=r.filter(function(t){return t&&t.count>0});if(!n.length)return;var i=n.reduce(function(t,e){return t+(e.count===void 0?1:e.count)},0);if(!i)return;else if(i===1){o(n[0],this.writer)}else{s(n,this.writer)}};t.prototype.encode=function(){this.encoded=true};t.prototype.flush=function(t){r.writeTo(this.writer,t)};return t}();e.Writer=n;function i(t){return!!t&&t.indexOf("\n")>=0}function o(t,e){var n=t.desc.fields;var o=t.data;var s=n.reduce(function(t,e){return Math.max(t,e.name.length)},0)+t.desc.name.length+5;for(var a=0,u=n;a<u.length;a++){var c=u[a];r.writePadRight(e,t.desc.name+"."+c.name,s);var p=c.presence;var v=p?p(o,0):0;if(v!==0){if(v===1)f(e);else l(e)}else{var m=c.string(o,0);if(i(m)){d(e,m);r.newline(e)}else{h(e,m)}}r.newline(e)}r.write(e,"#\n")}function s(t,e){a(e,"loop_");var n=t[0];var o=n.desc.fields;for(var s=0,u=o;s<u.length;s++){var c=u[s];a(e,n.desc.name+"."+c.name)}for(var p=0,v=t;p<v.length;p++){var m=v[p];var g=m.data;var y=m.count;for(var b=0;b<y;b++){for(var _=0,w=o;_<w.length;_++){var c=w[_];var C=c.presence;var x=C?C(g,b):0;if(x!==0){if(x===1)f(e);else l(e)}else{var I=c.string(g,b);if(i(I)){d(e,I);r.newline(e)}else{h(e,I)}}}r.newline(e)}}r.write(e,"#\n")}function a(t,e){r.write(t,e);r.newline(t)}function u(t,e){r.writeSafe(t,""+e+" ")}function c(t,e,n){r.writeSafe(t,""+Math.round(n*e)/n+" ")}function f(t){r.writeSafe(t,". ")}function l(t){r.writeSafe(t,"? ")}function h(t,e){if(!e){r.writeSafe(t,". ");return}var n=false,i="'",o="' ";var s=false;var a=false;var u=false;for(var c=0,f=e.length-1;c<f;c++){var l=e.charCodeAt(c);switch(l){case 9:s=true;break;case 10:r.writeSafe(t,"\n;"+e);r.writeSafe(t,"\n; ");return;case 32:s=true;break;case 34:if(a){r.writeSafe(t,"\n;"+e);r.writeSafe(t,"\n; ");return}u=true;n=true;i="'";o="' ";break;case 39:if(u){r.writeSafe(t,"\n;"+e);r.writeSafe(t,"\n; ");return}n=true;a=true;i='"';o='" ';break}}var h=e.charCodeAt(0);if(!n&&(h===35||h===59||s)){i="'";o="' ";n=true}if(n){r.writeSafe(t,i+e+o)}else{r.write(t,e);r.writeSafe(t," ")}}function d(t,e){r.writeSafe(t,"\n;"+e);r.writeSafe(t,"\n; ")}function p(t,e,n,i){var o=false,s="'",a="' ";for(var u=n;u<i-1;u++){var c=e.charCodeAt(u);switch(c){case 10:r.writeSafe(t,"\n;"+e.substring(n,i));r.writeSafe(t,"\n; ");return;case 34:o=true;s="'";a="' ";break;case 39:o=true;s='"';a='" ';break}}if(!o&&e.charCodeAt(n)===59){s="'";a="' ";o=true}if(o){r.writeSafe(t,s+e.substring(n,i));r.writeSafe(t,s)}else{r.write(t,e.substring(n,i));r.writeSafe(t," ")}}})(e=t.Text||(t.Text={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(t){var e;(function(t){/*
             * Adapted from https://github.com/rcsb/mmtf-javascript
             * by Alexander Rose <alexander.rose@weirdbyte.de>, MIT License, Copyright (c) 2016
             */
function e(t,e){var r={};for(var n=0;n<e;n++){var i=o(t);r[i]=o(t)}return r}function r(t,e){var r=new Uint8Array(e);var n=t.offset;for(var i=0;i<e;i++)r[i]=t.buffer[i+n];t.offset+=e;return r}function n(e,r){var n=t.utf8Read(e.buffer,e.offset,r);e.offset+=r;return n}function i(t,e){var r=new Array(e);for(var n=0;n<e;n++){r[n]=o(t)}return r}function o(t){var o=t.buffer[t.offset];var s,a;if((o&128)===0){t.offset++;return o}if((o&240)===128){a=o&15;t.offset++;return e(t,a)}if((o&240)===144){a=o&15;t.offset++;return i(t,a)}if((o&224)===160){a=o&31;t.offset++;return n(t,a)}if((o&224)===224){s=t.dataView.getInt8(t.offset);t.offset++;return s}switch(o){case 192:t.offset++;return null;case 194:t.offset++;return false;case 195:t.offset++;return true;case 196:a=t.dataView.getUint8(t.offset+1);t.offset+=2;return r(t,a);case 197:a=t.dataView.getUint16(t.offset+1);t.offset+=3;return r(t,a);case 198:a=t.dataView.getUint32(t.offset+1);t.offset+=5;return r(t,a);case 202:s=t.dataView.getFloat32(t.offset+1);t.offset+=5;return s;case 203:s=t.dataView.getFloat64(t.offset+1);t.offset+=9;return s;case 204:s=t.buffer[t.offset+1];t.offset+=2;return s;case 205:s=t.dataView.getUint16(t.offset+1);t.offset+=3;return s;case 206:s=t.dataView.getUint32(t.offset+1);t.offset+=5;return s;case 208:s=t.dataView.getInt8(t.offset+1);t.offset+=2;return s;case 209:s=t.dataView.getInt16(t.offset+1);t.offset+=3;return s;case 210:s=t.dataView.getInt32(t.offset+1);t.offset+=5;return s;case 217:a=t.dataView.getUint8(t.offset+1);t.offset+=2;return n(t,a);case 218:a=t.dataView.getUint16(t.offset+1);t.offset+=3;return n(t,a);case 219:a=t.dataView.getUint32(t.offset+1);t.offset+=5;return n(t,a);case 220:a=t.dataView.getUint16(t.offset+1);t.offset+=3;return i(t,a);case 221:a=t.dataView.getUint32(t.offset+1);t.offset+=5;return i(t,a);case 222:a=t.dataView.getUint16(t.offset+1);t.offset+=3;return e(t,a);case 223:a=t.dataView.getUint32(t.offset+1);t.offset+=5;return e(t,a)}throw new Error("Unknown type 0x"+o.toString(16))}function s(t){return o({buffer:t,offset:0,dataView:new DataView(t.buffer)})}t.decode=s})(e=t.MessagePack||(t.MessagePack={}))})(e=t.Binary||(t.Binary={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(t){var e;(function(t){/*
             * Adapted from https://github.com/rcsb/mmtf-javascript
             * by Alexander Rose <alexander.rose@weirdbyte.de>, MIT License, Copyright (c) 2016
             */
function e(t){var e=new ArrayBuffer(r(t));var i=new DataView(e);var o=new Uint8Array(e);n(t,i,o,0);return o}t.encode=e;function r(e){var n=typeof e;if(n==="string"){var i=t.utf8ByteCount(e);if(i<32){return 1+i}if(i<256){return 2+i}if(i<65536){return 3+i}if(i<4294967296){return 5+i}}if(e instanceof Uint8Array){var o=e.byteLength;if(o<256){return 2+o}if(o<65536){return 3+o}if(o<4294967296){return 5+o}}if(n==="number"){if(Math.floor(e)!==e)return 9;if(e>=0){if(e<128)return 1;if(e<256)return 2;if(e<65536)return 3;if(e<4294967296)return 5;throw new Error("Number too big 0x"+e.toString(16))}if(e>=-32)return 1;if(e>=-128)return 2;if(e>=-32768)return 3;if(e>=-2147483648)return 5;throw new Error("Number too small -0x"+e.toString(16).substr(1))}if(n==="boolean"||e===null||e===void 0)return 1;if(n==="object"){var s,a=0;if(Array.isArray(e)){s=e.length;for(var u=0;u<s;u++){a+=r(e[u])}}else{var c=Object.keys(e);s=c.length;for(var u=0;u<s;u++){var f=c[u];a+=r(f)+r(e[f])}}if(s<16){return 1+a}if(s<65536){return 3+a}if(s<4294967296){return 5+a}throw new Error("Array or object too long 0x"+s.toString(16))}throw new Error("Unknown type "+n)}function n(e,r,i,o){var s=typeof e;if(s==="string"){var a=t.utf8ByteCount(e);if(a<32){r.setUint8(o,a|160);t.utf8Write(i,o+1,e);return 1+a}if(a<256){r.setUint8(o,217);r.setUint8(o+1,a);t.utf8Write(i,o+2,e);return 2+a}if(a<65536){r.setUint8(o,218);r.setUint16(o+1,a);t.utf8Write(i,o+3,e);return 3+a}if(a<4294967296){r.setUint8(o,219);r.setUint32(o+1,a);t.utf8Write(i,o+5,e);return 5+a}}if(e instanceof Uint8Array){var u=e.byteLength;var c=new Uint8Array(r.buffer);if(u<256){r.setUint8(o,196);r.setUint8(o+1,u);c.set(e,o+2);return 2+u}if(u<65536){r.setUint8(o,197);r.setUint16(o+1,u);c.set(e,o+3);return 3+u}if(u<4294967296){r.setUint8(o,198);r.setUint32(o+1,u);c.set(e,o+5);return 5+u}}if(s==="number"){if(!isFinite(e)){throw new Error("Number not finite: "+e)}if(Math.floor(e)!==e){r.setUint8(o,203);r.setFloat64(o+1,e);return 9}if(e>=0){if(e<128){r.setUint8(o,e);return 1}if(e<256){r.setUint8(o,204);r.setUint8(o+1,e);return 2}if(e<65536){r.setUint8(o,205);r.setUint16(o+1,e);return 3}if(e<4294967296){r.setUint8(o,206);r.setUint32(o+1,e);return 5}throw new Error("Number too big 0x"+e.toString(16))}if(e>=-32){r.setInt8(o,e);return 1}if(e>=-128){r.setUint8(o,208);r.setInt8(o+1,e);return 2}if(e>=-32768){r.setUint8(o,209);r.setInt16(o+1,e);return 3}if(e>=-2147483648){r.setUint8(o,210);r.setInt32(o+1,e);return 5}throw new Error("Number too small -0x"+(-e).toString(16).substr(1))}if(e===null||e===undefined){r.setUint8(o,192);return 1}if(s==="boolean"){r.setUint8(o,e?195:194);return 1}if(s==="object"){var f,l=0;var h=Array.isArray(e);var d=void 0;if(h){f=e.length}else{d=Object.keys(e);f=d.length}if(f<16){r.setUint8(o,f|(h?144:128));l=1}else if(f<65536){r.setUint8(o,h?220:222);r.setUint16(o+1,f);l=3}else if(f<4294967296){r.setUint8(o,h?221:223);r.setUint32(o+1,f);l=5}if(h){for(var p=0;p<f;p++){l+=n(e[p],r,i,o+l)}}else{for(var v=0,m=d;v<m.length;v++){var g=m[v];l+=n(g,r,i,o+l);l+=n(e[g],r,i,o+l)}}return l}throw new Error("Unknown type "+s)}})(e=t.MessagePack||(t.MessagePack={}))})(e=t.Binary||(t.Binary={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(t){var e;(function(t){/*
             * Adapted from https://github.com/rcsb/mmtf-javascript
             * by Alexander Rose <alexander.rose@weirdbyte.de>, MIT License, Copyright (c) 2016
             */
function e(t,e,r){var n=t.byteLength;for(var i=0,o=r.length;i<o;i++){var s=r.charCodeAt(i);if(s<128){t[e++]=s>>>0&127|0;continue}if(s<2048){t[e++]=s>>>6&31|192;t[e++]=s>>>0&63|128;continue}if(s<65536){t[e++]=s>>>12&15|224;t[e++]=s>>>6&63|128;t[e++]=s>>>0&63|128;continue}if(s<1114112){t[e++]=s>>>18&7|240;t[e++]=s>>>12&63|128;t[e++]=s>>>6&63|128;t[e++]=s>>>0&63|128;continue}throw new Error("bad codepoint "+s)}}t.utf8Write=e;var r=function(){var t=[];for(var e=0;e<1024;e++)t[e]=String.fromCharCode(e);return t}();function n(t){throw new Error(t)}function i(t,e,i){var o=r;var s=void 0,a=[],u=512,c=0;for(var f=e,l=e+i;f<l;f++){var h=t[f];if((h&128)===0){a[c++]=o[h]}else if((h&224)===192){a[c++]=o[(h&15)<<6|t[++f]&63]}else if((h&240)===224){a[c++]=String.fromCharCode((h&15)<<12|(t[++f]&63)<<6|(t[++f]&63)<<0)}else if((h&248)===240){a[c++]=String.fromCharCode((h&7)<<18|(t[++f]&63)<<12|(t[++f]&63)<<6|(t[++f]&63)<<0)}else n("Invalid byte "+h.toString(16));if(c===u){s=s||[];s[s.length]=a.join("");c=0}}if(!s)return a.slice(0,c).join("");if(c>0){s[s.length]=a.slice(0,c).join("")}return s.join("")}t.utf8Read=i;function o(t){var e=0;for(var r=0,i=t.length;r<i;r++){var o=t.charCodeAt(r);if(o<128){e+=1;continue}if(o<2048){e+=2;continue}if(o<65536){e+=3;continue}if(o<1114112){e+=4;continue}n("bad codepoint "+o)}return e}t.utf8ByteCount=o})(e=t.MessagePack||(t.MessagePack={}))})(e=t.Binary||(t.Binary={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(t){"use strict";/**
         * Fixed point, delta, RLE, integer packing adopted from https://github.com/rcsb/mmtf-javascript/
         * by Alexander Rose <alexander.rose@weirdbyte.de>, MIT License, Copyright (c) 2016
         */
function e(t){var e=t.data;for(var n=t.encoding.length-1;n>=0;n--){e=r.decodeStep(e,t.encoding[n])}return e}t.decode=e;var r;(function(t){function r(t,e){switch(e.kind){case"ByteArray":{switch(e.type){case 4:return t;case 1:return s(t);case 2:return c(t);case 5:return f(t);case 3:return l(t);case 6:return h(t);case 32:return d(t);case 33:return p(t);default:throw new Error("Unsupported ByteArray type.")}}case"FixedPoint":return v(t,e);case"IntervalQuantization":return m(t,e);case"RunLength":return g(t,e);case"Delta":return y(t,e);case"IntegerPacking":return w(t,e);case"StringArray":return C(t,e)}}t.decodeStep=r;function n(t,e){switch(t){case 1:return new Int8Array(e);case 2:return new Int16Array(e);case 3:return new Int32Array(e);case 4:return new Uint8Array(e);case 5:return new Uint16Array(e);case 6:return new Uint32Array(e);default:throw new Error("Unsupported integer data type.")}}function i(t,e){switch(t){case 32:return new Float32Array(e);case 33:return new Float64Array(e);default:throw new Error("Unsupported floating data type.")}}var o=function(){var t=new ArrayBuffer(2);var e=new Uint8Array(t);var r=new Uint16Array(t);e[0]=170;e[1]=187;if(r[0]===48042)return true;return false}();function s(t){return new Int8Array(t.buffer,t.byteOffset)}function a(t,e){var r=new ArrayBuffer(t.length);var n=new Uint8Array(r);for(var i=0,o=t.length;i<o;i+=e){for(var s=0;s<e;s++){n[i+e-s-1]=t[i+s]}}return r}function u(t,e,r){if(o)return new r(t.buffer);return new r(a(t,e))}function c(t){return u(t,2,Int16Array)}function f(t){return u(t,2,Uint16Array)}function l(t){return u(t,4,Int32Array)}function h(t){return u(t,4,Uint32Array)}function d(t){return u(t,4,Float32Array)}function p(t){return u(t,8,Float64Array)}function v(t,e){var r=t.length;var n=i(e.srcType,r);var o=1/e.factor;for(var s=0;s<r;s++){n[s]=o*t[s]}return n}function m(t,e){var r=t.length;var n=i(e.srcType,r);var o=(e.max-e.min)/(e.numSteps-1);var s=e.min;for(var a=0;a<r;a++){n[a]=s+o*t[a]}return n}function g(t,e){var r=n(e.srcType,e.srcSize);var i=0;for(var o=0,s=t.length;o<s;o+=2){var a=t[o];var u=t[o+1];for(var c=0;c<u;++c){r[i++]=a}}return r}function y(t,e){var r=t.length;var i=n(e.srcType,r);if(!r)return i;i[0]=t[0]+(e.origin|0);for(var o=1;o<r;++o){i[o]=t[o]+i[o-1]}return i}function b(t,e){var r=e.byteCount===1?127:32767;var n=-r-1;var i=t.length;var o=new Int32Array(e.srcSize);var s=0;var a=0;while(s<i){var u=0,c=t[s];while(c===r||c===n){u+=c;s++;c=t[s]}u+=c;o[a]=u;s++;a++}return o}function _(t,e){var r=e.byteCount===1?255:65535;var n=t.length;var i=new Int32Array(e.srcSize);var o=0;var s=0;while(o<n){var a=0,u=t[o];while(u===r){a+=u;o++;u=t[o]}a+=u;i[s]=a;o++;s++}return i}function w(t,e){return e.isUnsigned?_(t,e):b(t,e)}function C(t,r){var n=r.stringData;var i=e({encoding:r.offsetEncoding,data:r.offsets});var o=e({encoding:r.dataEncoding,data:t});var s=Object.create(null);var a=new Array(o.length);var u=0;for(var c=0,f=o;c<f.length;c++){var l=f[c];if(l<0){a[u++]=null;continue}var h=s[l];if(h===void 0){h=n.substring(i[l],i[l+1]);s[l]=h}a[u++]=h}return a}})(r||(r={}))})(e=t.Binary||(t.Binary={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(e){"use strict";var r=function(){function t(t){this.dataBlocks=t.dataBlocks.map(function(t){return new n(t)})}t.prototype.toJSON=function(){return this.dataBlocks.map(function(t){return t.toJSON()})};return t}();e.File=r;var n=function(){function t(t){this.additionalData={};this.header=t.header;this.categoryList=t.categories.map(function(t){return new i(t)});this.categoryMap=new Map;for(var e=0,r=this.categoryList;e<r.length;e++){var n=r[e];this.categoryMap.set(n.name,n)}}Object.defineProperty(t.prototype,"categories",{get:function(){return this.categoryList},enumerable:true,configurable:true});t.prototype.getCategory=function(t){return this.categoryMap.get(t)};t.prototype.toJSON=function(){return{id:this.header,categories:this.categoryList.map(function(t){return t.toJSON()}),additionalData:this.additionalData}};return t}();e.DataBlock=n;var i=function(){function e(t){this.name=t.name;this.columnCount=t.columns.length;this.rowCount=t.rowCount;this.columnNameList=[];this.encodedColumns=new Map;for(var e=0,r=t.columns;e<r.length;e++){var n=r[e];this.encodedColumns.set(n.name,n);this.columnNameList.push(n.name)}}Object.defineProperty(e.prototype,"columnNames",{get:function(){return this.columnNameList},enumerable:true,configurable:true});e.prototype.getColumn=function(e){var r=this.encodedColumns.get(e);if(r)return o(r);return t.UndefinedColumn};e.prototype.toJSON=function(){var t=this;var e=[];var r=this.columnNameList.map(function(e){return{name:e,column:t.getColumn(e)}});for(var n=0;n<this.rowCount;n++){var i={};for(var o=0,s=r;o<s.length;o++){var a=s[o];var u=a.column.getValuePresence(n);if(u===0)i[a.name]=a.column.getString(n);else if(u===1)i[a.name]=".";else i[a.name]="?"}e[n]=i}return{name:this.name,columns:this.columnNames,rows:e}};return e}();e.Category=i;function o(r){if(!r.data.data)return t.UndefinedColumn;var n=e.decode(r.data);var i=void 0;if(r.mask)i=e.decode(r.mask);if(n.buffer&&n.byteLength&&n.BYTES_PER_ELEMENT){return i?new c(n,i):new u(n)}return i?new l(n,i):new f(n)}var s=t.Utils.FastNumberParsers.parseInt;var a=t.Utils.FastNumberParsers.parseFloat;var u=function(){function t(t){this.data=t;this.isDefined=true}t.prototype.getString=function(t){return""+this.data[t]};t.prototype.getInteger=function(t){return this.data[t]|0};t.prototype.getFloat=function(t){return 1*this.data[t]};t.prototype.stringEquals=function(t,e){return this.data[t]===a(e,0,e.length)};t.prototype.areValuesEqual=function(t,e){return this.data[t]===this.data[e]};t.prototype.getValuePresence=function(t){return 0};return t}();var c=function(){function t(t,e){this.data=t;this.mask=e;this.isDefined=true}t.prototype.getString=function(t){return this.mask[t]===0?""+this.data[t]:null};t.prototype.getInteger=function(t){return this.mask[t]===0?this.data[t]:0};t.prototype.getFloat=function(t){return this.mask[t]===0?this.data[t]:0};t.prototype.stringEquals=function(t,e){return this.mask[t]===0?this.data[t]===a(e,0,e.length):e===null||e===void 0};t.prototype.areValuesEqual=function(t,e){return this.data[t]===this.data[e]};t.prototype.getValuePresence=function(t){return this.mask[t]};return t}();var f=function(){function t(t){this.data=t;this.isDefined=true}t.prototype.getString=function(t){return this.data[t]};t.prototype.getInteger=function(t){var e=this.data[t];return s(e,0,e.length)};t.prototype.getFloat=function(t){var e=this.data[t];return a(e,0,e.length)};t.prototype.stringEquals=function(t,e){return this.data[t]===e};t.prototype.areValuesEqual=function(t,e){return this.data[t]===this.data[e]};t.prototype.getValuePresence=function(t){return 0};return t}();var l=function(){function t(t,e){this.data=t;this.mask=e;this.isDefined=true}t.prototype.getString=function(t){return this.mask[t]===0?this.data[t]:null};t.prototype.getInteger=function(t){if(this.mask[t]!==0)return 0;var e=this.data[t];return s(e||"",0,(e||"").length)};t.prototype.getFloat=function(t){if(this.mask[t]!==0)return 0;var e=this.data[t];return a(e||"",0,(e||"").length)};t.prototype.stringEquals=function(t,e){return this.data[t]===e};t.prototype.areValuesEqual=function(t,e){return this.data[t]===this.data[e]};t.prototype.getValuePresence=function(t){return this.mask[t]};return t}()})(e=t.Binary||(t.Binary={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(e){"use strict";/**
         * Fixed point, delta, RLE, integer packing adopted from https://github.com/rcsb/mmtf-javascript/
         * by Alexander Rose <alexander.rose@weirdbyte.de>, MIT License, Copyright (c) 2016
         */
var r=function(){function t(t){this.providers=t}t.prototype.and=function(e){return new t(this.providers.concat([e]))};t.prototype.encode=function(t){var e=[];for(var r=0,n=this.providers;r<n.length;r++){var i=n[r];var o=i(t);if(!o.encodings.length){throw new Error("Encodings must be non-empty.")}t=o.data;for(var s=0,a=o.encodings;s<a.length;s++){var u=a[s];e.push(u)}}if(!(t instanceof Uint8Array)){throw new Error("The encoding must result in a Uint8Array. Fix your encoding chain.")}return{encoding:e,data:t}};return t}();e.Encoder=r;(function(r){function n(t){return new r([t])}r.by=n;function i(t){return{encodings:[{kind:"ByteArray",type:4}],data:t}}function o(t){return{encodings:[{kind:"ByteArray",type:1}],data:new Uint8Array(t.buffer,t.byteOffset)}}var s=(w={},w[2]=function(t,e,r){t.setInt16(2*e,r,true)},w[5]=function(t,e,r){t.setUint16(2*e,r,true)},w[3]=function(t,e,r){t.setInt32(4*e,r,true)},w[6]=function(t,e,r){t.setUint32(4*e,r,true)},w[32]=function(t,e,r){t.setFloat32(4*e,r,true)},w[33]=function(t,e,r){t.setFloat64(8*e,r,true)},w);var a=(C={},C[2]=2,C[5]=2,C[3]=4,C[6]=4,C[32]=4,C[33]=8,C);function u(t){var r=e.Encoding.getDataType(t);if(r===1)return o(t);else if(r===4)return i(t);var n=new Uint8Array(t.length*a[r]);var u=s[r];var c=new DataView(n.buffer);for(var f=0,l=t.length;f<l;f++){u(c,f,t[f])}return{encodings:[{kind:"ByteArray",type:r}],data:n}}r.byteArray=u;function c(t,r){var n=e.Encoding.getDataType(t);var i=new Int32Array(t.length);for(var o=0,s=t.length;o<s;o++){i[o]=Math.round(t[o]*r)}return{encodings:[{kind:"FixedPoint",factor:r,srcType:n}],data:i}}function f(t){return function(e){return c(e,t)}}r.fixedPoint=f;function l(t,r,n,i,o){var s=e.Encoding.getDataType(t);if(!t.length){return{encodings:[{kind:"IntervalQuantization",min:r,max:n,numSteps:i,srcType:s}],data:new Int32Array(0)}}if(n<r){var a=r;r=n;n=a}var u=(n-r)/(i-1);var c=new o(t.length);for(var f=0,l=t.length;f<l;f++){var h=t[f];if(h<=r)c[f]=0;else if(h>=n)c[f]=i;else c[f]=Math.round((h-r)/u)|0}return{encodings:[{kind:"IntervalQuantization",min:r,max:n,numSteps:i,srcType:s}],data:c}}function h(t,e,r,n){if(n===void 0){n=Int32Array}return function(i){return l(i,t,e,r,n)}}r.intervalQuantizaiton=h;function d(t){var r=e.Encoding.getDataType(t);if(r===void 0){t=new Int32Array(t);r=3}if(!t.length){return{encodings:[{kind:"RunLength",srcType:r,srcSize:0}],data:new Int32Array(0)}}var n=2;for(var i=1,o=t.length;i<o;i++){if(t[i-1]!==t[i]){n+=2}}var s=new Int32Array(n);var a=0;var u=1;for(var i=1,o=t.length;i<o;i++){if(t[i-1]!==t[i]){s[a]=t[i-1];s[a+1]=u;u=1;a+=2}else{++u}}s[a]=t[t.length-1];s[a+1]=u;return{encodings:[{kind:"RunLength",srcType:r,srcSize:t.length}],data:s}}r.runLength=d;function p(t){if(!e.Encoding.isSignedIntegerDataType(t)){throw new Error("Only signed integer types can be encoded using delta encoding.")}var r=e.Encoding.getDataType(t);if(r===void 0){t=new Int32Array(t);r=3}if(!t.length){return{encodings:[{kind:"Delta",origin:0,srcType:r}],data:new t.constructor(0)}}var n=new t.constructor(t.length);var i=t[0];n[0]=t[0];for(var o=1,s=t.length;o<s;o++){n[o]=t[o]-t[o-1]}n[0]=0;return{encodings:[{kind:"Delta",origin:i,srcType:r}],data:n}}r.delta=p;function v(t){for(var e=0,r=t.length;e<r;e++){if(t[e]<0)return true}return false}function m(t,e){var r=-e-1;var n=0;for(var i=0,o=t.length;i<o;i++){var s=t[i];if(s===0){n+=1}else if(s>0){n+=Math.ceil(s/e);if(s%e===0)n+=1}else{n+=Math.ceil(s/r);if(s%r===0)n+=1}}return n}function g(t){var e=v(t);var r=e?m(t,127):m(t,255);var n=e?m(t,32767):m(t,65535);if(t.length*4<n*2){return{isSigned:e,size:t.length,bytesPerElement:4}}else if(n*2<r){return{isSigned:e,size:n,bytesPerElement:2}}else{return{isSigned:e,size:r,bytesPerElement:1}}}function y(t,e){var r=e.isSigned?e.bytesPerElement===1?127:32767:e.bytesPerElement===1?255:65535;var n=-r-1;var i=t.length;var o=e.isSigned?e.bytesPerElement===1?new Int8Array(e.size):new Int16Array(e.size):e.bytesPerElement===1?new Uint8Array(e.size):new Uint16Array(e.size);var s=0;for(var a=0;a<i;a++){var c=t[a];if(c>=0){while(c>=r){o[s]=r;++s;c-=r}}else{while(c<=n){o[s]=n;++s;c-=n}}o[s]=c;++s}var f=u(o);return{encodings:[{kind:"IntegerPacking",byteCount:e.bytesPerElement,isUnsigned:!e.isSigned,srcSize:i},f.encodings[0]],data:f.data}}function b(t){if(!(t instanceof Int32Array)){throw new Error("Integer packing can only be applied to Int32 data.")}var e=g(t);if(e.bytesPerElement===4){return u(t)}return y(t,e)}r.integerPacking=b;function _(e){var n=Object.create(null);var i=[];var o=0;var s=t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},1024,1);var a=new Int32Array(e.length);t.Utils.ChunkedArray.add(s,0);var u=0;for(var c=0,f=e;c<f.length;c++){var l=f[c];if(l===null||l===void 0){a[u++]=-1;continue}var h=n[l];if(h===void 0){o+=l.length;h=i.length;i[h]=l;n[l]=h;t.Utils.ChunkedArray.add(s,o)}a[u++]=h}var v=r.by(p).and(b).encode(t.Utils.ChunkedArray.compact(s));var m=r.by(p).and(d).and(b).encode(a);return{encodings:[{kind:"StringArray",dataEncoding:m.encoding,stringData:i.join(""),offsetEncoding:v.encoding,offsets:v.data}],data:m.data}}r.stringArray=_;var w,C})(r=e.Encoder||(e.Encoder={}))})(e=t.Binary||(t.Binary={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(t){"use strict";t.VERSION="0.3.0";var e;(function(t){function e(t){var e;if(t instanceof Int8Array)e=1;else if(t instanceof Int16Array)e=2;else if(t instanceof Int32Array)e=3;else if(t instanceof Uint8Array)e=4;else if(t instanceof Uint16Array)e=5;else if(t instanceof Uint32Array)e=6;else if(t instanceof Float32Array)e=32;else if(t instanceof Float64Array)e=33;else throw new Error("Unsupported integer data type.");return e}t.getDataType=e;function r(t){return t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array}t.isSignedIntegerDataType=r})(e=t.Encoding||(t.Encoding={}))})(e=t.Binary||(t.Binary={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(e){"use strict";function r(t,e){for(var r=0;r<2;r++){if(t[r]>e[r])return false}return true}function n(n){var i=[0,3];try{var o=new Uint8Array(n);var s=e.MessagePack.decode(o);if(!r(i,s.version.match(/(\d)\.(\d)\.\d/).slice(1))){return t.ParserResult.error("Unsupported format version. Current "+s.version+", required "+i.join(".")+".")}var a=new e.File(s);return t.ParserResult.success(a)}catch(e){return t.ParserResult.error(""+e)}}e.parse=n})(e=t.Binary||(t.Binary={}))})(o||(o={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under MIT License, See LICENSE file for more info.
 */
var o;(function(t){var e;(function(t){"use strict";function e(e,r,n){var i,o=false;if(e.typedArray){i=new e.typedArray(n)}else{o=true;i=new Array(n)}var s=new Uint8Array(n);var a=e.presence;var u=e.number?e.number:e.string;var c=true;var f=0;for(var l=0,h=r;l<h.length;l++){var d=h[l];var p=d.data;for(var v=0,m=d.count;v<m;v++){var g=a?a(p,v):0;if(g!==0){s[f]=g;if(o)i[f]=null;c=false}else{s[f]=0;i[f]=u(p,v)}f++}}var y=e.encoder?e.encoder:t.Encoder.by(t.Encoder.stringArray);var b=y.encode(i);var _=void 0;if(!c){var w=t.Encoder.by(t.Encoder.runLength).and(t.Encoder.byteArray).encode(s);if(w.data.length<s.length){_=w}else{_=t.Encoder.by(t.Encoder.byteArray).encode(s)}}return{name:e.name,data:b,mask:_}}var r=function(){function r(e){this.dataBlocks=[];this.data={encoder:e,version:t.VERSION,dataBlocks:this.dataBlocks}}r.prototype.startDataBlock=function(t){this.dataBlocks.push({header:(t||"").replace(/[ \n\t]/g,"").toUpperCase(),categories:[]})};r.prototype.writeCategory=function(t,r){if(!this.data){throw new Error("The writer contents have already been encoded, no more writing.")}if(!this.dataBlocks.length){throw new Error("No data block created.")}var n=!r||!r.length?[t(void 0)]:r.map(function(e){return t(e)});var i=n.filter(function(t){return t&&t.count>0});if(!i.length)return;var o=i.reduce(function(t,e){return t+e.count},0);if(!o)return;var s=i[0];var a={name:s.desc.name,columns:[],rowCount:o};var u=i.map(function(t){return{data:t.data,count:t.count}});for(var c=0,f=s.desc.fields;c<f.length;c++){var l=f[c];a.columns.push(e(l,u,o))}this.dataBlocks[this.dataBlocks.length-1].categories.push(a)};r.prototype.encode=function(){this.encodedData=t.MessagePack.encode(this.data);this.data=null;this.dataBlocks=null};r.prototype.flush=function(t){t.writeBinary(this.encodedData)};return r}();t.Writer=r})(e=t.Binary||(t.Binary={}))})(o||(o={}));var s=o;"use strict";/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){t.Promise=e})(a||(a={}));(function(t){var e;(function(e){"use strict";e.Rx=i;e.Promise=t.Promise;var r;(function(t){t.CIF=s})(r=e.Formats||(e.Formats={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){t.VERSION={number:"3.2.2",date:"Nov 14 2017"}})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){"use strict";function r(){var t={};var e=typeof document!=="undefined"?document:void 0;var r=false;var n=1;var i;function o(e){var r=[];for(var o=1;o<arguments.length;o++){r[o-1]=arguments[o]}if(typeof e!=="function"){e=new Function(""+e)}var s={callback:e,args:r};t[n]=s;i(n);return n++}function s(e){delete t[e]}function a(t){var e=t.callback;var r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(undefined,r);break}}function u(e){if(r){setTimeout(u,0,e)}else{var n=t[e];if(n){r=true;try{a(n)}finally{s(e);r=false}}}}function c(){i=function(t){process.nextTick(function(){u(t)})}}function f(){var t=window;if(t&&t.postMessage&&!t.importScripts){var e=true;var r=t.onmessage;t.onmessage=function(){e=false};t.postMessage("","*");t.onmessage=r;return e}return void 0}function l(){var t=window;var e="setImmediate$"+Math.random()+"$";var r=function(r){if(r.source===t&&typeof r.data==="string"&&r.data.indexOf(e)===0){u(+r.data.slice(e.length))}};if(window.addEventListener){window.addEventListener("message",r,false)}else{window.attachEvent("onmessage",r)}i=function(t){window.postMessage(e+t,"*")}}function h(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;u(e)};i=function(e){t.port2.postMessage(e)}}function d(){var t=e.documentElement;i=function(r){var n=e.createElement("script");n.onreadystatechange=function(){u(r);n.onreadystatechange=null;t.removeChild(n);n=null};t.appendChild(n)}}function p(){i=function(t){setTimeout(u,0,t)}}if(typeof process!=="undefined"&&{}.toString.call(process)==="[object process]"){c()}else if(f()){l()}else if(typeof MessageChannel!=="undefined"){h()}else if(e&&"onreadystatechange"in e.createElement("script")){d()}else{p()}return{setImmediate:o,clearImmediate:s}}var n=function(){if(typeof setImmediate!=="undefined"){if(typeof window!=="undefined"){return{setImmediate:function(t){var e=[];for(var r=1;r<arguments.length;r++){e[r-1]=arguments[r]}return window.setImmediate.apply(window,[t].concat(e))},clearImmediate:function(t){return window.clearImmediate(t)}}}else return{setImmediate:setImmediate,clearImmediate:e.clearImmediate}}return r()}();function i(t){n.setImmediate(t)}e.immediate=n.setImmediate;e.clearImmediate=n.clearImmediate;function o(){return new t.Promise(i)}e.immediatePromise=o})(e=t.Scheduler||(t.Scheduler={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var u=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(i,o){function s(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n["throw"](t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(s,a)}u((n=n.apply(t,e||[])).next())})};var c=this&&this.__generator||function(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(t){return function(e){return u([t,e])}}function u(s){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,i&&(o=i[s[0]&2?"return":s[0]?"throw":"next"])&&!(o=o.call(i,s[1])).done)return o;if(i=0,o)s=[0,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:r.label++;return{value:s[1],done:false};case 5:r.label++;i=s[1];s=[0];continue;case 7:s=r.ops.pop();r.trys.pop();continue;default:if(!(o=r.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){r=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){r.label=s[1];break}if(s[0]===6&&r.label<o[1]){r.label=o[1];o=s;break}if(o&&r.label<o[2]){r.label=o[2];r.ops.push(s);break}if(o[2])r.ops.pop();r.trys.pop();continue}s=e.call(t,r)}catch(t){s=[6,t];i=0}finally{n=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};var a;(function(t){var e;(function(t){"use strict";function e(t){return new r(t)}t.computation=e;var r=function(){function e(t){this.computation=t}e.prototype.run=function(t){return this.runWithContext(t).result};e.prototype.runWithContext=function(r){var i=this;var o=r?r:new n;return{progress:o.progressStream,result:new t.Promise(function(t,r){return u(i,void 0,void 0,function(){var n,i;return c(this,function(s){switch(s.label){case 0:s.trys.push([0,2,3,4]);o.started();return[4,this.computation(o)];case 1:n=s.sent();t(n);return[3,4];case 2:i=s.sent();if(e.PRINT_CONSOLE_ERROR)console.error(i);r(i);return[3,4];case 3:o.finished();return[7];case 4:return[2]}})})})}};return e}();t.Computation=r;(function(r){r.PRINT_CONSOLE_ERROR=false;function i(r){return e(function(){return t.Promise.resolve(r)})}r.resolve=i;function o(r){return e(function(){return t.Promise.reject(r)})}r.reject=o;function s(){return new n}r.createContext=s;r.Aborted="Aborted";r.UpdateProgressDelta=100})(r=t.Computation||(t.Computation={}));var n=function(){function e(){var e=this;this._abortRequested=false;this._abortRequester=function(){e._abortRequested=true};this.progressTick=new t.Rx.Subject;this._progress={message:"Working...",current:0,max:0,isIndeterminate:true,requestAbort:void 0};this.progressStream=new t.Rx.BehaviorSubject(this._progress);this.startEndCounter=0;this.progressTick.throttle(1e3/15).subscribe(function(t){e.progressStream.onNext({message:t.message,isIndeterminate:t.isIndeterminate,current:t.current,max:t.max,requestAbort:t.requestAbort})})}Object.defineProperty(e.prototype,"isAbortRequested",{get:function(){return this._abortRequested},enumerable:true,configurable:true});e.prototype.checkAborted=function(){if(this._abortRequested)throw r.Aborted};e.prototype.requestAbort=function(){try{if(this._abortRequester){this._abortRequester.call(null)}}catch(t){}};Object.defineProperty(e.prototype,"progress",{get:function(){return this.progressTick},enumerable:true,configurable:true});e.prototype.updateProgress=function(e,r,n,i){if(n===void 0){n=NaN}if(i===void 0){i=NaN}this.checkAborted();this._progress.message=e;if(typeof r==="boolean"){this._progress.requestAbort=r?this._abortRequester:void 0}else{if(r)this._abortRequester=r;this._progress.requestAbort=r?this._abortRequester:void 0}if(isNaN(n)){this._progress.isIndeterminate=true}else{this._progress.isIndeterminate=false;this._progress.current=n;this._progress.max=i}this.progressTick.onNext(this._progress);return t.Scheduler.immediatePromise()};e.prototype.started=function(){this.startEndCounter++};e.prototype.finished=function(){this.startEndCounter--;if(this.startEndCounter<=0){this.progressTick.onCompleted();this.progressStream.onCompleted()}if(this.startEndCounter<0){throw"Bug in code somewhere, Computation.resolve/reject called too many times."}};return e}()})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){"use strict";function e(){var t=Object.create(null);t["__"]=void 0;delete t["__"];return t}var r;(function(t){function r(t,e,r){for(var n=0,i=Object.keys(t);n<i.length;n++){var o=i[n];var s=t[o];if(s===void 0)continue;e(s,o,r)}}var n={set:function(t,e){if(this.data[t]===void 0&&e!==void 0){this.size++}this.data[t]=e},get:function(t){return this.data[t]},delete:function(t){if(this.data[t]===void 0)return false;delete this.data[t];this.size--;return true},has:function(t){return this.data[t]!==void 0},clear:function(){this.data=e();this.size=0},forEach:function(t,e){r(this.data,t,e!==void 0?e:void 0)}};function i(){var t=Object.create(n);t.data=e();t.size=0;return t}t.create=i;function o(t){var e=i();for(var r=0,n=t;r<n.length;r++){var o=n[r];e.set(o[0],o[1])}return e}t.ofArray=o;function s(t){var e=i();for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];var s=t[o];e.set(o,s)}return e}t.ofObject=s})(r=t.FastMap||(t.FastMap={}));var n;(function(t){function r(t,e,r){for(var n=0,i=Object.keys(t);n<i.length;n++){var o=i[n];if(t[o]!==null)continue;e(o,r)}}var n={add:function(t){if(this.data[t]===null)return false;this.data[t]=null;this.size++;return true},delete:function(t){if(this.data[t]!==null)return false;delete this.data[t];this.size--;return true},has:function(t){return this.data[t]===null},clear:function(){this.data=e();this.size=0},forEach:function(t,e){r(this.data,t,e!==void 0?e:void 0)}};function i(){var t=Object.create(n);t.data=e();t.size=0;return t}t.create=i;function o(t){var e=i();for(var r=0,n=t.length;r<n;r++){e.add(t[r])}return e}t.ofArray=o})(n=t.FastSet||(t.FastSet={}));var i;(function(e){var r=function(){function t(t){this.size=t}t.prototype.has=function(t){return false};return t}();var n=function(){function t(t,e){this.idx=t;this.size=e}t.prototype.has=function(t){return t===this.idx};return t}();var i=function(){function t(t,e){this.mask=t;this.size=e}t.prototype.has=function(t){return this.mask[t]};return t}();var o=function(){function t(t){this.size=t}t.prototype.has=function(t){return true};return t}();function s(t){return new o(t.data.atoms.count)}e.ofStructure=s;function a(e,o){var s=o.length;if(s===0)return new r(e);if(s===1)return new n(o[0],e);var a=s/e;if(a<1/12){var u=t.FastSet.create();for(var c=0,f=o;c<f.length;c++){var l=f[c];u.add(l)}return u}var h=new Int8Array(e);for(var d=0,p=o;d<p.length;d++){var l=p[d];h[l]=1}return new i(h,s)}e.ofIndices=a;function u(e){var r=0;for(var n=0,o=e.fragments;n<o.length;n++){var s=o[n];r+=s.atomCount}var a=e.context.structure.data.atoms.count;if(r/a<1/12){var u=t.FastSet.create();for(var c=0,f=e.fragments;c<f.length;c++){var s=f[c];for(var l=0,h=s.atomIndices;l<h.length;l++){var d=h[l];u.add(d)}}return u}else{var u=new Int8Array(a);for(var p=0,v=e.fragments;p<v.length;p++){var s=v[p];for(var m=0,g=s.atomIndices;m<g.length;m++){var d=g[m];u[d]=1}}var y=0;for(var d=0;d<a;d++){if(u[d]!==0)y++}return new i(u,y)}}e.ofFragments=u})(i=t.Mask||(t.Mask={}))})(e=t.Utils||(t.Utils={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){"use strict";e.FastNumberParsers=t.Formats.CIF.Utils.FastNumberParsers;function r(t,e,r){var n;var i=e;var o=t;var s=r;for(var a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];n=i[c];if(n!==void 0)o[c]=n;else if(r)o[c]=s[c]}if(r){for(var f=0,l=Object.keys(r);f<l.length;f++){var c=l[f];n=o[c];if(n===void 0)o[c]=s[c]}}return t}e.extend=r;function n(t,e){var r,n,i,o,s,a,u,c=0,f=0,l=true,h=false;e=Math.max(0,e)||0;var d=function(){var f=e-(performance.now()-o);if(f<=0){if(n){clearTimeout(n)}var l=u;n=a=u=void 0;if(l){c=performance.now();i=t.apply(s,r);if(!a&&!n){r=s=null}}}else{a=setTimeout(d,f)}};var p=function(){if(a){clearTimeout(a)}n=a=u=void 0;if(l||f!==e){c=performance.now();i=t.apply(s,r);if(!a&&!n){r=s=null}}};return function(){r=arguments;o=performance.now();s=this;u=l&&(a||!h);var v=false;var m=false;if(f===0){m=h&&!a}else{if(!n&&!h){c=o}var g=f-(o-c),y=g<=0;if(y){if(n){n=clearTimeout(n)}c=o;i=t.apply(s,r)}else if(!n){n=setTimeout(p,g)}}if(v&&a){a=clearTimeout(a)}else if(!a&&e!==f){a=setTimeout(d,e)}if(m){v=true;i=t.apply(s,r)}if(v&&!a&&!n){r=s=null}return i}}e.debounce=n})(e=t.Utils||(t.Utils={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){"use strict";var e;(function(e){function r(t){return function(e){return new t(e)}}e.typedColumn=r;function n(){return function(t){return new Array(t)}}e.customColumn=n;e.stringColumn=function(t){return new Array(t)};e.stringNullColumn=function(t){return new Array(t)};function i(t){return new u(t)}e.builder=i;function o(t,r){var n=e.builder(r);for(var i=0,o=Object.keys(t);i<o.length;i++){var s=o[i];if(!Object.prototype.hasOwnProperty.call(t,s))continue;var a=t[s];if(a){n.addColumn(s,a)}}return n.seal()}e.ofDefinition=o;function s(t,e){var r=Object.create(null);for(var n=0,i=t.columns;n<i.length;n++){var o=i[n];(function(t,e,r,n){Object.defineProperty(e,t.name,{enumerable:true,configurable:false,get:function(){return n[r.index]}})})(o,r,e,t[o.name])}return r}var a=function(){function e(e,r,n){this.__rowIndexer={index:0};this.count=e;this.indices=new Int32Array(e);this.columns=[];for(var i=0;i<e;i++){this.indices[i]=i}for(var o=0,a=r;o<a.length;o++){var u=a[o];var c=n[u.name];if(t.ChunkedArray.is(c)){c=t.ChunkedArray.compact(c)}Object.defineProperty(this,u.name,{enumerable:true,configurable:false,writable:false,value:c});this.columns[this.columns.length]=u}this.__row=s(this,this.__rowIndexer)}e.prototype.getBuilder=function(t){var e=new u(t);for(var r=0,n=this.columns;r<n.length;r++){var i=n[r];e.addColumn(i.name,i.creator)}return e};e.prototype.getRawData=function(){var t=this;return this.columns.map(function(e){return t[e.name]})};e.prototype.getRow=function(t){this.__rowIndexer.index=t;return this.__row};return e}();var u=function(){function t(t){this.columns=[];this.count=t}t.prototype.addColumn=function(t,e){var r=e(this.count);Object.defineProperty(this,t,{enumerable:true,configurable:false,writable:false,value:r});this.columns[this.columns.length]={name:t,creator:e};return r};t.prototype.addRawColumn=function(t,e,r){var n=r;Object.defineProperty(this,t,{enumerable:true,configurable:false,writable:false,value:n});this.columns[this.columns.length]={name:t,creator:e};return n};t.prototype.getRawData=function(){var t=this;return this.columns.map(function(e){return t[e.name]})};t.prototype.seal=function(){return new a(this.count,this.columns,this)};return t}()})(e=t.DataTable||(t.DataTable={}))})(e=t.Utils||(t.Utils={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){"use strict";function e(t){var e=new Int32Array(t.size);t.forEach(function(t,e){e.array[e.index++]=t},{array:e,index:0});Array.prototype.sort.call(e,function(t,e){return t-e});return e}t.integerSetToSortedTypedArray=e;function r(t){var e=[];for(var r=0;r<t;r++)e[r]=0;return e}t.makeNativeIntArray=r;function n(t){var e=[];if(!t)return e;e[0]=.1;for(var r=0;r<t;r++)e[r]=0;return e}t.makeNativeFloatArray=n;var i;(function(t){function e(t){return t.creator&&t.chunkSize}t.is=e;function r(t,e,r,n,i){if(t.currentIndex>=t.chunkSize){t.currentIndex=0;t.current=t.creator(t.chunkSize);t.parts[t.parts.length]=t.current}t.current[t.currentIndex++]=e;t.current[t.currentIndex++]=r;t.current[t.currentIndex++]=n;t.current[t.currentIndex++]=i;return t.elementCount++}t.add4=r;function n(t,e,r,n){if(t.currentIndex>=t.chunkSize){t.currentIndex=0;t.current=t.creator(t.chunkSize);t.parts[t.parts.length]=t.current}t.current[t.currentIndex++]=e;t.current[t.currentIndex++]=r;t.current[t.currentIndex++]=n;return t.elementCount++}t.add3=n;function i(t,e,r){if(t.currentIndex>=t.chunkSize){t.currentIndex=0;t.current=t.creator(t.chunkSize);t.parts[t.parts.length]=t.current}t.current[t.currentIndex++]=e;t.current[t.currentIndex++]=r;return t.elementCount++}t.add2=i;function o(t,e){if(t.currentIndex>=t.chunkSize){t.currentIndex=0;t.current=t.creator(t.chunkSize);t.parts[t.parts.length]=t.current}t.current[t.currentIndex++]=e;return t.elementCount++}t.add=o;function s(t){var e=t.creator(t.elementSize*t.elementCount),r=(t.parts.length-1)*t.chunkSize,n=0,i;if(t.parts.length===1&&t.chunkSize===t.elementCount){return t.parts[0]}if(t.parts.length>1){if(t.parts[0].buffer){for(var o=0;o<t.parts.length-1;o++){e.set(t.parts[o],t.chunkSize*o)}}else{for(var o=0;o<t.parts.length-1;o++){n=t.chunkSize*o;i=t.parts[o];for(var s=0;s<t.chunkSize;s++){e[n+s]=i[s]}}}}if(t.current.buffer&&t.currentIndex>=t.chunkSize){e.set(t.current,t.chunkSize*(t.parts.length-1))}else{for(var o=0;o<t.currentIndex;o++){e[r+o]=t.current[o]}}return e}t.compact=s;function a(t){if(t===void 0){t=262144}return p(function(t){return new Float32Array(t)},t,3)}t.forVertex3D=a;function u(t){if(t===void 0){t=262144}return p(function(t){return new Uint32Array(t)},t,3)}t.forIndexBuffer=u;function c(t){if(t===void 0){t=131072}return p(function(t){return new Int32Array(t)},t,2)}t.forTokenIndices=c;function f(t){if(t===void 0){t=131072}return p(function(t){return new Int32Array(t)},t,1)}t.forIndices=f;function l(t){if(t===void 0){t=131072}return p(function(t){return new Int32Array(t)},t,1)}t.forInt32=l;function h(t){if(t===void 0){t=131072}return p(function(t){return new Float32Array(t)},t,1)}t.forFloat32=h;function d(t){if(t===void 0){t=131072}return p(function(t){return[]},t,1)}t.forArray=d;function p(t,e,r){e=e|0;if(e<=0)e=1;var n=e*r;var i=t(n);return{elementSize:r,chunkSize:n,creator:t,current:i,parts:[i],currentIndex:0,elementCount:0}}t.create=p})(i=t.ChunkedArray||(t.ChunkedArray={}));var o;(function(t){function e(t,e,r,n){var i=t.array;i[t.currentIndex++]=e;i[t.currentIndex++]=r;i[t.currentIndex++]=n;t.elementCount++}t.add3=e;function r(t,e,r){var n=t.array;n[t.currentIndex++]=e;n[t.currentIndex++]=r;t.elementCount++}t.add2=r;function n(t,e){t.array[t.currentIndex++]=e;t.elementCount++}t.add=n;function i(t){return l(function(t){return new Float32Array(t)},t,3)}t.forVertex3D=i;function o(t){return l(function(t){return new Int32Array(t)},t,3)}t.forIndexBuffer=o;function s(t){return l(function(t){return new Int32Array(t)},t,2)}t.forTokenIndices=s;function a(t){return l(function(t){return new Int32Array(t)},t,1)}t.forIndices=a;function u(t){return l(function(t){return new Int32Array(t)},t,1)}t.forInt32=u;function c(t){return l(function(t){return new Float32Array(t)},t,1)}t.forFloat32=c;function f(t){return l(function(t){return[]},t,1)}t.forArray=f;function l(t,e,r){e=e|0;return{array:t(e*r),currentIndex:0,elementCount:0}}t.create=l})(o=t.ArrayBuilder||(t.ArrayBuilder={}));function s(){return{_set:t.FastSet.create(),array:[]}}t.UniqueArray=s;(function(t){function e(t,e){var r=t._set,n=t.array;if(!r.has(e)){r.add(e);n[n.length]=e}}t.add=e})(s=t.UniqueArray||(t.UniqueArray={}))})(e=t.Utils||(t.Utils={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){"use strict";var e;(function(t){t.perfGetTime=function(){if(typeof window!=="undefined"&&window.performance){return function(){return window.performance.now()}}else if(typeof process!=="undefined"&&process.hrtime!=="undefined"){return function(){var t=process.hrtime();return t[0]*1e3+t[1]/1e6}}else{return function(){return+new Date}}}()})(e||(e={}));var r=function(){function r(){this.starts=t.FastMap.create();this.ends=t.FastMap.create()}r.currentTime=function(){return e.perfGetTime()};r.prototype.start=function(t){this.starts.set(t,e.perfGetTime())};r.prototype.end=function(t){this.ends.set(t,e.perfGetTime())};r.format=function(t){if(isNaN(t))return"n/a";var e=Math.floor(t/(60*60*1e3)),r=Math.floor(t/(60*1e3)%60),n=Math.floor(t/1e3%60),i=Math.floor(t%1e3).toString();while(i.length<3)i="0"+i;if(e>0)return e+"h"+r+"m"+n+"."+i+"s";if(r>0)return r+"m"+n+"."+i+"s";if(n>0)return n+"."+i+"s";return t.toFixed(0)+"ms"};r.prototype.formatTime=function(t){return r.format(this.time(t))};r.prototype.formatTimeSum=function(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return r.format(this.timeSum.apply(this,t))};r.prototype.time=function(t){var e=this.starts.get(t),r=this.ends.get(t);this.starts.delete(t);this.ends.delete(t);return r-e};r.prototype.timeSum=function(){var t=this;var e=[];for(var r=0;r<arguments.length;r++){e[r]=arguments[r]}var n=0;for(var i=0,o=e.map(function(e){return t.ends.get(e)-t.starts.get(e)});i<o.length;i++){var s=o[i];n+=s}return n};return r}();t.PerformanceMonitor=r})(e=t.Utils||(t.Utils={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){"use strict";var e;(function(t){function e(t){return t.name&&t.parse}t.is=e;function r(t,e){e=e.toLowerCase().trim();for(var r=0,n=t;r<n.length;r++){var i=n[r];for(var o=0,s=i.shortcuts;o<s.length;o++){var a=s[o];if(a.toLowerCase()===e)return i}}return void 0}t.fromShortcut=r;function n(t){return new RegExp(t.extensions.map(function(t){return"(\\"+t+")"}).join("|")+"(\\.gz){0,1}$","i")}t.formatRegExp=n;function i(t){return t.map(function(t){return t.extensions.map(function(t){return t+","+t+".gz"}).join(",")}).join(",")}t.formatFileFilters=i;function o(t,e){for(var r=0,i=e;r<i.length;r++){var o=i[r];if(n(o).test(t))return o}return void 0}t.getFormat=o})(e=t.FormatInfo||(t.FormatInfo={}));var r;(function(t){function e(t,e){if(e===void 0){e=-1}return new n(t,e)}t.error=e;function r(t,e){if(e===void 0){e=[]}return new i(t,e)}t.success=r})(r=t.ParserResult||(t.ParserResult={}));var n=function(){function t(t,e){this.message=t;this.line=e;this.isError=true}t.prototype.toString=function(){if(this.line>=0){return"[Line "+this.line+"] "+this.message}return this.message};return t}();t.ParserError=n;var i=function(){function t(t,e){this.result=t;this.warnings=e;this.isError=false}return t}();t.ParserSuccess=i;var o;(function(t){function e(t){var e=new Int32Array(Math.round(1.61*t.tokens.length));e.set(t.tokens);t.tokens=e;t.tokensLenMinus2=e.length-2}function r(t,r,n){if(t.count>=t.tokensLenMinus2){e(t)}t.tokens[t.count++]=r;t.tokens[t.count++]=n}t.addToken=r;function n(t){return{tokensLenMinus2:Math.round(t)-2,count:0,tokens:new Int32Array(t)}}t.create=n})(o=t.TokenIndexBuilder||(t.TokenIndexBuilder={}));var s;(function(t){function e(){return Object.create(null)}t.create=e;function r(t,e){if(e.length>6)return e;var r=t[e];if(r!==void 0)return r;t[e]=e;return e}t.get=r})(s=t.ShortStringPool||(t.ShortStringPool={}))})(e=t.Formats||(t.Formats={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){var r;(function(e){var r;(function(e){"use strict";var r;(function(t){t.ElementSymbol="X";t.ResidueName="UNK";t.AsymId="";t.EntityId="1";t.ModelId="1"})(r||(r={}));function n(e,r,n,i){var o=t.Geometry.LinearAlgebra.Matrix4.identity(),s,a;for(s=1;s<=3;s++){for(a=1;a<=3;a++){t.Geometry.LinearAlgebra.Matrix4.setValue(o,s-1,a-1,e.getColumn(r+"["+s+"]["+a+"]").getFloat(i))}t.Geometry.LinearAlgebra.Matrix4.setValue(o,s-1,3,e.getColumn(n+"["+s+"]").getFloat(i))}return o}function i(t,e,r){var n=0;if(!r||!r.isDefined)return e;for(n=t+1;n<e;n++){if(!r.areValuesEqual(n-1,n))break}return n}var o=["id","Cartn_x","Cartn_y","Cartn_z","label_atom_id","type_symbol","occupancy","B_iso_or_equiv","auth_atom_id","label_alt_id","label_comp_id","label_seq_id","label_asym_id","auth_comp_id","auth_seq_id","auth_asym_id","group_PDB","label_entity_id","pdbx_PDB_ins_code","pdbx_PDB_model_num"];function s(e){var r=t.Utils.FastMap.create();for(var n=0,i=o;n<i.length;n++){var s=i[n];r.set(s,e.getColumn(s))}return r}function a(e,n,o){var s=i(e,n,o.get("pdbx_PDB_model_num"));var a=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Atoms,s-e),u=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Positions,s-e),c=u.x,f=o.get("Cartn_x"),l=u.y,h=o.get("Cartn_y"),d=u.z,p=o.get("Cartn_z"),v=a.id,m=o.get("id"),g=a.altLoc,y=o.get("label_alt_id"),b=a.rowIndex,_=a.residueIndex,w=a.chainIndex,C=a.entityIndex,x=a.name,I=o.get("label_atom_id"),S=a.elementSymbol,A=o.get("type_symbol"),k=a.occupancy,E=o.get("occupancy"),P=a.tempFactor,T=o.get("B_iso_or_equiv"),F=a.authName,M=o.get("auth_atom_id");var D=o.get("label_asym_id"),N=o.get("label_entity_id"),R=o.get("pdbx_PDB_ins_code"),q=o.get("auth_seq_id"),U=o.get("pdbx_PDB_model_num"),O=0,B=0,L=0;var z=e;for(var j=e;j<s;j++){var V=j-e;v[V]=m.getInteger(j);c[V]=f.getFloat(j);l[V]=h.getFloat(j);d[V]=p.getFloat(j);S[V]=A.getString(j)||r.ElementSymbol;x[V]=I.getString(j)||S[V];F[V]=M.getString(j)||x[V];g[V]=y.getString(j);k[V]=E.getFloat(j);P[V]=T.getFloat(j);var X=false;var Y=!q.areValuesEqual(z,j)||!R.areValuesEqual(z,j);if(!D.areValuesEqual(z,j)){X=true;Y=true}if(!N.areValuesEqual(z,j)){L++;X=true;Y=true}if(Y)B++;if(X)O++;b[V]=j;_[V]=B;w[V]=O;C[V]=L;z=j}var H=!U.isDefined?r.ModelId:U.getString(e)||r.ModelId;return{atoms:a,positions:u,modelId:H,endRow:s}}function u(e,n){var i=n.count,o=n.residueIndex,s=n.chainIndex,a=n.entityIndex;var u=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Residues,n.residueIndex[n.count-1]+1),c=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Chains,n.chainIndex[n.count-1]+1),f=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Entities,n.entityIndex[n.count-1]+1);var l=u.name,h=u.seqNumber,d=u.asymId,p=u.authName,v=u.authSeqNumber,m=u.authAsymId,g=u.insCode,y=u.entityId,b=u.isHet,_=u.atomStartIndex,w=u.atomEndIndex,C=u.chainIndex,x=u.entityIndex;var I=c.asymId,S=c.entityId,A=c.authAsymId,k=c.atomStartIndex,E=c.atomEndIndex,P=c.residueStartIndex,T=c.residueEndIndex,F=c.entityIndex;var M=f.entityId,D=f.type,N=f.atomStartIndex,R=f.atomEndIndex,q=f.residueStartIndex,U=f.residueEndIndex,O=f.chainStartIndex,B=f.chainEndIndex;var L=e.get("label_comp_id"),z=e.get("label_seq_id"),j=e.get("label_asym_id"),V=e.get("auth_comp_id"),X=e.get("auth_seq_id"),Y=e.get("auth_asym_id"),H=e.get("group_PDB"),G=e.get("label_entity_id"),Z=e.get("pdbx_PDB_ins_code");var Q=0,W=0,K=0,J=0,$=0,tt=0,et=0,rt=0,nt=0;var it=0;for(it=0;it<i;it++){if(o[it]!==o[Q]){l[et]=L.getString(Q)||r.ResidueName;h[et]=z.getInteger(Q);d[et]=j.getString(Q)||r.AsymId;p[et]=V.getString(Q)||l[et];v[et]=X.getInteger(Q);m[et]=Y.getString(Q)||d[et];g[et]=Z.getString(Q);y[et]=G.getString(Q)||r.EntityId;b[et]=H.stringEquals(Q,"HETATM")?1:0;_[et]=Q;w[et]=it;C[et]=rt;x[et]=nt;et++;Q=it}if(s[it]!==s[W]){I[rt]=j.getString(W)||r.AsymId;A[rt]=Y.getString(W)||I[rt];S[rt]=G.getString(W)||r.EntityId;P[rt]=tt;T[rt]=et;k[rt]=W;E[rt]=it;F[rt]=nt;rt++;W=it;tt=et}if(a[it]!==a[K]){M[nt]=G.getString(K)||r.EntityId;D[nt]="unknown";N[nt]=K;R[nt]=it;q[nt]=$;U[nt]=et;O[nt]=J;B[nt]=rt;nt++;K=it;J=rt;$=et}}M[nt]=G.getString(K)||r.EntityId;D[nt]="unknown";N[nt]=K;R[nt]=it;q[nt]=$;U[nt]=et+1;O[nt]=J;B[nt]=rt+1;I[rt]=j.getString(W)||r.AsymId;A[rt]=Y.getString(W)||I[rt];S[rt]=G.getString(W)||r.EntityId;P[rt]=tt;T[rt]=et+1;k[rt]=W;E[rt]=it;F[rt]=nt;l[et]=L.getString(Q)||r.ResidueName;h[et]=z.getInteger(Q);d[et]=j.getString(Q)||r.AsymId;p[et]=V.getString(Q)||l[et];v[et]=X.getInteger(Q);m[et]=Y.getString(Q)||d[et];g[et]=Z.getString(Q);_[et]=Q;w[et]=it;C[et]=rt;x[et]=nt;b[et]=H.stringEquals(Q,"HETATM")?1:0;return{residues:u,chains:c,entities:f}}function c(t,e){var n;if(!t){return}var i={},o=t.getColumn("type"),s=t.getColumn("id");for(n=0;n<t.rowCount;n++){var a=(o.getString(n)||"").toLowerCase();var u=s.getString(n)||r.EntityId;switch(a){case"polymer":case"non-polymer":case"water":i[u]=a;break;default:i[u]="unknown";break}}for(n=0;n<e.count;n++){var c=i[e.entityId[n]];if(c!==void 0){e.type[n]=c}}}function f(e,n,i,o){return new t.Structure.PolyResidueIdentifier(n.getString(e)||r.AsymId,i.getInteger(e),o.getString(e))}var l={ALA:true,ARG:true,ASP:true,CYS:true,GLN:true,GLU:true,GLY:true,HIS:true,ILE:true,LEU:true,LYS:true,MET:true,PHE:true,PRO:true,SER:true,THR:true,TRP:true,TYR:true,VAL:true,ASN:true,PYL:true,SEC:true};function h(t,e,r,n){if(r.type[e.entityIndex[n]]!=="polymer")return false;var i=false,o=false,s=t.name,a=0;for(var u=e.atomStartIndex[n],c=e.atomEndIndex[n];u<c;u++){var f=s[u];if(!i&&f==="CA"){i=true;a++}else if(!o&&f==="O"){o=true;a++}if(a===2)break}return i&&o||i&&!e.isHet[n]}function d(t,e,r,n){if(l[e.name[n]]||r.type[e.entityIndex[n]]!=="polymer")return false;var i=t.name,o=0;var s=e.atomStartIndex[n],a=e.atomEndIndex[n];if(a-s===1&&!e.isHet[s]&&i[s]==="P"){return true}for(var u=s;u<a;u++){var c=i[u];if(c==="O5'"||c==="C3'"||c==="N3"||c==="P"){o++}if(o>=3){return true}}return false}function p(e,r,n,i,o,s){var a=r.asymId,u=r.entityIndex,c=0,f=i,l=i,p=o;while(f<p){if(d(e,r,n,f)){l=f+1;while(l<p&&a[f]===a[l]&&u[f]===u[l]&&d(e,r,n,l)){l++}c=5}else if(h(e,r,n,f)){l=f+1;while(l<p&&a[f]===a[l]&&u[f]===u[l]&&h(e,r,n,l)){l++}c=4}else{l=f+1;while(l<p&&a[f]===a[l]&&u[f]===u[l]&&!d(e,r,n,l)&&!h(e,r,n,l)){l++}c=0}var v=new t.Structure.SecondaryStructureElement(c,new t.Structure.PolyResidueIdentifier(r.asymId[f],r.seqNumber[f],r.insCode[f]),new t.Structure.PolyResidueIdentifier(r.asymId[l-1],r.seqNumber[l-1],r.insCode[l-1]));v.startResidueIndex=f;v.endResidueIndex=l;s[s.length]=v;f=l}}function v(e,r){var n=[];var i=e.authSeqNumber;for(var o=0,s=r;o<s.length;o++){var a=s[o];var u=a.startResidueIndex;var c=a.endResidueIndex-1;for(var f=a.startResidueIndex;f<c;f++){if(i[f+1]-i[f]===1)continue;var l=new t.Structure.SecondaryStructureElement(a.type,a.startResidueId,a.endResidueId,a.info);l.startResidueIndex=u;l.endResidueIndex=f+1;n[n.length]=l;u=f+1}if(u===a.startResidueIndex){n[n.length]=a}else{var l=new t.Structure.SecondaryStructureElement(a.type,a.startResidueId,a.endResidueId,a.info);l.startResidueIndex=u;l.endResidueIndex=a.endResidueIndex;n[n.length]=l}}return n}function m(e,r){var n=r.residues,i=n.count,o=n.asymId,s=n.seqNumber,a=n.insCode,u=void 0,c="",f=t.Utils.FastMap.create(),l=t.Utils.FastMap.create();for(var h=0,d=e;h<d.length;h++){var p=d[h];c=p.startResidueId.asymId+" "+p.startResidueId.seqNumber;if(p.startResidueId.insCode)c+=" "+p.startResidueId.insCode;f.set(c,p);c=p.endResidueId.asymId+" "+p.endResidueId.seqNumber;if(p.endResidueId.insCode)c+=" "+p.endResidueId.insCode;l.set(c,p)}for(var v=0;v<i;v++){c=o[v]+" "+s[v];if(a[v])c+=" "+a[v];u=f.get(c);if(u){u.startResidueIndex=v;u.endResidueIndex=v+1}u=l.get(c);if(u){if(u.startResidueIndex<0)u.startResidueIndex=v;u.endResidueIndex=v+1}}if(u){u.endResidueIndex=i}var m=[];for(var y=0,b=e;y<b.length;y++){var p=b[y];if(p.startResidueIndex<0||p.endResidueIndex<0)continue;if(p.type===3&&p.length<3)continue;if(p.endResidueIndex>=0&&p.startResidueIndex>=0)m[m.length]=p}m.sort(function(t,e){return t.startResidueIndex-e.startResidueIndex});for(var v=0;v<m.length-1;v++){if(m[v+1].startResidueIndex-m[v].endResidueIndex===-1){m[v+1].startResidueIndex++}}if(!m.length)return m;var _=[m[0]];for(var v=1;v<m.length;v++){var w=_[_.length-1],C=m[v];if(C.startResidueIndex<w.endResidueIndex){g(w,C)}else{_[_.length]=C}}return _}function g(t,e){if(e.endResidueIndex>t.endResidueIndex){t.endResidueIndex=e.endResidueIndex}}function y(e,r,n){var i=[],o=[];var s=e.getCategory("_struct_conf"),a=e.getCategory("_struct_sheet_range"),u;if(s){var c=s.getColumn("conf_type_id");if(c){var l=s.getColumn("beg_label_asym_id");var h=s.getColumn("beg_label_seq_id");var d=s.getColumn("pdbx_beg_PDB_ins_code");var g=s.getColumn("end_label_asym_id");var y=s.getColumn("end_label_seq_id");var b=s.getColumn("pdbx_end_PDB_ins_code");var _=s.getColumn("pdbx_PDB_helix_class");for(u=0;u<s.rowCount;u++){var w=void 0;switch((c.getString(u)||"").toUpperCase()){case"HELX_P":w=1;break;case"TURN_P":w=2;break}if(!w)continue;i[i.length]=new t.Structure.SecondaryStructureElement(w,f(u,l,h,d),f(u,g,y,b),{helixClass:_.getString(u)})}}}if(a){var l=a.getColumn("beg_label_asym_id");var h=a.getColumn("beg_label_seq_id");var d=a.getColumn("pdbx_beg_PDB_ins_code");var g=a.getColumn("end_label_asym_id");var y=a.getColumn("end_label_seq_id");var b=a.getColumn("pdbx_end_PDB_ins_code");var C=a.getColumn("symmetry");var x=a.getColumn("sheet_id");var I=a.getColumn("id");for(u=0;u<a.rowCount;u++){i[i.length]=new t.Structure.SecondaryStructureElement(3,f(u,l,h,d),f(u,g,y,b),{symmetry:C.getString(u),sheetId:x.getString(u),id:I.getString(u)})}}var S=i.length>0?m(i,n):[];var A=n.residues,k=A.count;if(S.length===0){p(r,A,n.entities,0,k,o);return v(A,o)}var E=S.length-1;if(S[0].startResidueIndex>0){p(r,A,n.entities,0,S[0].startResidueIndex,o)}for(u=0;u<E;u++){o[o.length]=S[u];if(S[u+1].startResidueIndex-S[u].endResidueIndex>0){p(r,A,n.entities,S[u].endResidueIndex,S[u+1].startResidueIndex,o)}}o[o.length]=S[E];if(S[E].endResidueIndex<k){p(r,A,n.entities,S[E].endResidueIndex,k,o)}return v(A,o)}function b(t,e){var r=t.secondaryStructureIndex;var n=0;for(var i=0,o=e;i<o.length;i++){var s=o[i];for(var a=s.startResidueIndex;a<s.endResidueIndex;a++){r[a]=n}n++}return r}function _(t,e,r,n){var i=t.chains,o=i.asymId,s=i.residueStartIndex,a=i.residueEndIndex,u=i.count;var c=t.residues,f=c.seqNumber,l=c.insCode;for(var h=0;h<u;h++){if(o[h]!==e)continue;for(var d=s[h],p=a[h];d<p;d++){if(f[d]===r&&l[d]===n)return d}}return-1}function w(t,e,r,n,i){var o=e.residues,s=o.atomStartIndex,a=o.atomEndIndex;var u=t.name,c=t.altLoc;for(var f=s[r],l=a[r];f<=l;f++){if(u[f]===n&&c[f]===i)return f}return-1}function C(e){var r=e.getCategory("_pdbx_struct_mod_residue");if(!r)return void 0;var n=t.Utils.DataTable.ofDefinition(t.Structure.Tables.ModifiedResidues,r.rowCount);var i=r.getColumn("label_asym_id");var o=r.getColumn("label_seq_id");var s=r.getColumn("PDB_ins_code");var a=r.getColumn("parent_comp_id");var u=r.getColumn("details");var c=n.asymId,f=n.seqNumber,l=n.insCode,h=n.parent,d=n.details;for(var p=0,v=r.rowCount;p<v;p++){c[p]=i.getString(p);f[p]=o.getInteger(p);l[p]=s.getString(p);h[p]=a.getString(p);d[p]=u.getString(p)}return n}function x(e,r,n){var i=e.getCategory("_struct_conn");if(!i)return void 0;var o=function(t){return{label_asym_id:i.getColumn("ptnr"+t+"_label_asym_id"),label_seq_id:i.getColumn("ptnr"+t+"_label_seq_id"),label_atom_id:i.getColumn("ptnr"+t+"_label_atom_id"),label_alt_id:i.getColumn("pdbx_ptnr"+t+"_label_alt_id"),ins_code:i.getColumn("pdbx_ptnr"+t+"_PDB_ins_code"),symmetry:i.getColumn("ptnr"+t+"_symmetry")}};var s=i.getColumn("conn_type_id");var a=i.getColumn("pdbx_dist_value");var u=i.getColumn("pdbx_value_order");var c=o(1);var f=o(2);var l=o(3);var h=function(t,e){if(e.label_asym_id.getValuePresence(t)!==0)return void 0;var i=_(n,e.label_asym_id.getString(t),e.label_seq_id.getInteger(t),e.ins_code.getString(t));if(i<0)return void 0;var o=w(r,n,i,e.label_atom_id.getString(t),e.label_alt_id.getString(t));if(o<0)return void 0;return{residueIndex:i,atomIndex:o,symmetry:e.symmetry.getString(t)||"1_555"}};var d=function(t){var e=[];var r=h(t,c);if(r)e.push(r);r=h(t,f);if(r)e.push(r);r=h(t,l);if(r)e.push(r);return e};var p=[];for(var v=0;v<i.rowCount;v++){var m=d(v);if(m.length<2)continue;var g=s.getString(v);var y=(u.getString(v)||"").toLowerCase();var b=0;switch(y){case"sing":b=1;break;case"doub":b=2;break;case"trip":b=3;break;case"quad":b=4;break}switch(g){case"disulf":b=5;break;case"hydrog":b=8;break;case"metalc":b=6;break;case"saltbr":b=7;break}p.push({bondType:b,distance:a.getFloat(v),partners:m})}return new t.Structure.StructConn(p)}function I(t){var e=/\(?([^\(\)]+)\)?]*/g,r,n=[],i=[];while(r=e.exec(t))n[n.length]=r[1];n.forEach(function(t){var e=[];t.split(",").forEach(function(t){var r=t.indexOf("-");if(r>0){var n=parseInt(t.substring(0,r)),i=parseInt(t.substr(r+1));for(var o=n;o<=i;o++)e[e.length]=o.toString()}else{e[e.length]=t.trim()}});i[i.length]=e});return i}function S(e){var r=e.getCategory("_pdbx_struct_assembly"),i=e.getCategory("_pdbx_struct_assembly_gen"),o=e.getCategory("_pdbx_struct_oper_list");if(!r||!i||!o){return void 0}var s,a={},u=[],c=t.Utils.FastMap.create();var f=i.getColumn("assembly_id");var l=i.getColumn("oper_expression");var h=i.getColumn("asym_id_list");for(s=0;s<i.rowCount;s++){var d=f.getString(s);if(!d){return void 0}var p=c.get(d);if(!p){p=new t.Structure.AssemblyGen(d);c.set(d,p);u.push(p)}p.gens.push(new t.Structure.AssemblyGenEntry(I(l.getString(s)),h.getString(s).split(",")))}var v=o.getColumn("id");var m=o.getColumn("name");for(s=0;s<o.rowCount;s++){var g=n(o,"matrix","vector",s);if(!g){return void 0}var y=new t.Structure.AssemblyOperator(v.getString(s),m.getString(s),g);a[y.id]=y}return new t.Structure.AssemblyInfo(a,u)}function A(e){var r=e.getCategory("_cell"),i=e.getCategory("_symmetry"),o=e.getCategory("_atom_sites");var s="",a=[1,1,1],u=[90,90,90],c=t.Geometry.LinearAlgebra.Matrix4.identity(),f=false;if(!r||!i){return void 0}s=i.getColumn("space_group_name_H-M").getString(0);a=[r.getColumn("length_a").getFloat(0),r.getColumn("length_b").getFloat(0),r.getColumn("length_c").getFloat(0)];u=[r.getColumn("angle_alpha").getFloat(0),r.getColumn("angle_beta").getFloat(0),r.getColumn("angle_gamma").getFloat(0)];if(!s||a.every(function(t){return isNaN(t)||t===0})||a.every(function(t){return isNaN(t)||t===0})){return void 0}var l=function(t){return t*t};var h=function(t){return t*Math.PI/180};var d=a[0],p=a[1],v=a[2],m=h(u[0]),g=h(u[1]),y=h(u[2]),b=d*p*v*Math.sqrt(1-l(Math.cos(m))-l(Math.cos(g))-l(Math.cos(y))+2*Math.cos(m)*Math.cos(g)*Math.cos(y));var _=t.Geometry.LinearAlgebra.Matrix4.ofRows([[d,p*Math.cos(y),v*Math.cos(g),0],[0,p*Math.sin(y),v*(Math.cos(m)-Math.cos(g)*Math.cos(y))/Math.sin(y),0],[0,0,b/(d*p*Math.sin(y)),0],[0,0,0,1]]);var w=t.Geometry.LinearAlgebra.Matrix4.identity();t.Geometry.LinearAlgebra.Matrix4.invert(w,_);if(o){var C=n(o,"fract_transf_matrix","fract_transf_vector",0);if(C){c=C;if(!t.Geometry.LinearAlgebra.Matrix4.areEqual(w,C,1e-4)){f=true}}}else{c=w}return new t.Structure.SymmetryInfo(s,a,u,c,f)}function k(e){if(!e||!e.rowCount)return void 0;var r=new t.Structure.ComponentBondInfo;var n=e.getColumn("comp_id"),i=e.getColumn("atom_id_1"),o=e.getColumn("atom_id_2"),s=e.getColumn("value_order"),a=e.rowCount;var u=r.newEntry(n.getString(0));for(var c=0;c<a;c++){var f=n.getString(c),l=i.getString(c),h=o.getString(c),d=s.getString(c);if(u.id!==f){u=r.newEntry(f)}var p=void 0;switch(d.toLowerCase()){case"sing":p=1;break;case"doub":case"delo":p=2;break;case"trip":p=3;break;case"quad":p=4;break;default:p=0;break}u.add(l,h,p)}return r}function E(e,r,n){var i=a(e,r.getCategory("_atom_site").rowCount,n),o=i.atoms,s=i.positions,f=i.modelId,l=i.endRow,h=u(n,o),d=r.getCategory("_entry"),p;if(d&&d.getColumn("id").isDefined)p=d.getColumn("id").getString(0);else p=r.header;c(r.getCategory("_entity"),h.entities);var v=y(r,o,h);b(h.residues,v);return{model:t.Structure.Molecule.Model.create({id:p,modelId:f,data:{atoms:o,residues:h.residues,chains:h.chains,entities:h.entities,bonds:{structConn:x(r,o,h),component:k(r.getCategory("_chem_comp_bond"))},modifiedResidues:C(r),secondaryStructure:v,symmetryInfo:A(r),assemblyInfo:S(r)},positions:s,source:t.Structure.Molecule.Model.Source.File}),endRow:l}}function P(e){var r=[],n=e.getCategory("_atom_site"),i=0;if(!n){throw"'_atom_site' category is missing in the input."}var o=e.getCategory("_entry"),a=s(n),u;if(o&&o.getColumn("id").isDefined)u=o.getColumn("id").getString(0);else u=e.header;while(i<n.rowCount){var c=E(i,e,a),f=c.model,l=c.endRow;r.push(f);i=l}var h=void 0;var d=e.getCategory("_exptl");if(d){h=d.getColumn("method").getString(0)||void 0}return t.Structure.Molecule.create(u,r,{experimentMethod:h})}e.ofDataBlock=P})(r=e.mmCIF||(e.mmCIF={}))})(r=e.Molecule||(e.Molecule={}))})(e=t.Formats||(t.Formats={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){var r;(function(r){var n;(function(r){"use strict";var n=function(){function t(t,e,r,n){this.header=t;this.crystInfo=e;this.models=r;this.data=n}t.prototype.makeEntities=function(){var t=["data_ent","loop_","_entity.id","_entity.type","_entity.src_method","_entity.pdbx_description","_entity.formula_weight","_entity.pdbx_number_of_molecules","_entity.details","_entity.pdbx_mutation","_entity.pdbx_fragment","_entity.pdbx_ec","1 polymer man polymer 0.0 0 ? ? ? ?","2 non-polymer syn non-polymer 0.0 0 ? ? ? ?","3 water nat water 0.0 0 ? ? ? ?"].join("\n");var r=e.CIF.Text.parse(t);if(r.isError){throw r.toString()}return r.result.dataBlocks[0].getCategory("_entity")};t.prototype.toCifFile=function(){var t={dot:r.Parser.getDotRange(this.data.length),question:r.Parser.getQuestionmarkRange(this.data.length),numberTokens:r.Parser.getNumberRanges(this.data.length),data:this.data};var n=new e.CIF.Text.File(this.data);var i=new e.CIF.Text.DataBlock(this.data,this.header.id);n.dataBlocks.push(i);i.addCategory(this.makeEntities());if(this.crystInfo){var o=this.crystInfo.toCifCategory(this.header.id),s=o.cell,a=o.symm;i.addCategory(s);i.addCategory(a)}i.addCategory(this.models.toCifCategory(i,t));return n};return t}();r.MoleculeData=n;var i=function(){function t(t){this.id=t}return t}();r.Header=i;var o=function(){function t(t){this.record=t}t.prototype.getValue=function(t,e){var r=this.record.substr(6,9).trim();if(!r.length)return".";return r};t.prototype.toCifCategory=function(t){var r=["_cell.entry_id           '"+t+"'","_cell.length_a           "+this.getValue(6,9),"_cell.length_b           "+this.getValue(15,9),"_cell.length_c           "+this.getValue(24,9),"_cell.angle_alpha        "+this.getValue(33,7),"_cell.angle_beta         "+this.getValue(40,7),"_cell.angle_gamma        "+this.getValue(48,7),"_cell.Z_PDB              "+this.getValue(66,4),"_cell.pdbx_unique_axis   ?","_symmetry.entry_id                         '"+t+"'","_symmetry.space_group_name_H-M             '"+this.getValue(55,11)+"'","_symmetry.pdbx_full_space_group_name_H-M   ?","_symmetry.cell_setting                     ?","_symmetry.Int_Tables_number                ?","_symmetry.space_group_name_Hall            ?"].join("\n");var n=e.CIF.Text.parse(r);if(n.isError){throw new Error(n.toString())}return{cell:n.result.dataBlocks[0].getCategory("_cell"),symm:n.result.dataBlocks[0].getCategory("_symmetry")}};return t}();r.CrystStructureInfo=o;var s=function(){function t(t,e){this.helixTokens=t;this.sheetTokens=e}t.prototype.toCifCategory=function(t){return void 0};return t}();r.SecondaryStructure=s;var a=function(){function e(t,e,r){this.idToken=t;this.atomTokens=e;this.atomCount=r}e.prototype.writeToken=function(e,r){t.Utils.ArrayBuilder.add2(r,this.atomTokens[2*e],this.atomTokens[2*e+1])};e.prototype.writeTokenCond=function(e,r,n){var i=this.atomTokens[2*e];var o=this.atomTokens[2*e+1];if(i===o)t.Utils.ArrayBuilder.add2(r,n.start,n.end);else t.Utils.ArrayBuilder.add2(r,i,o)};e.prototype.writeRange=function(e,r){t.Utils.ArrayBuilder.add2(r,e.start,e.end)};e.prototype.tokenEquals=function(t,e,r,n){var i=r.length;if(i!==e-t)return false;for(var o=r.length-1;o>=0;o--){if(n.charCodeAt(o+t)!==r.charCodeAt(o)){return false}}return true};e.prototype.getEntityType=function(t,e){var r=t*14;if(this.tokenEquals(this.atomTokens[2*r],this.atomTokens[2*r+1],"HETATM",e)){var n=this.atomTokens[2*(r+4)],i=this.atomTokens[2*(r+4)+1];if(this.tokenEquals(n,i,"HOH",e)||this.tokenEquals(n,i,"WTR",e)||this.tokenEquals(n,i,"SOL",e)){return 3}return 2}else{return 1}};e.prototype.writeCifTokens=function(t,e,r){var n={RECORD:0,SERIAL:1,ATOM_NAME:2,ALT_LOC:3,RES_NAME:4,CHAIN_ID:5,RES_SEQN:6,INS_CODE:7,X:8,Y:9,Z:10,OCCUPANCY:11,TEMP_FACTOR:12,ELEMENT:13};var i=14;for(var o=0;o<this.atomCount;o++){var s=o*i;this.writeToken(s+n.RECORD,e);this.writeToken(s+n.SERIAL,e);this.writeToken(s+n.ELEMENT,e);this.writeToken(s+n.ATOM_NAME,e);this.writeTokenCond(s+n.ALT_LOC,e,r.dot);this.writeToken(s+n.RES_NAME,e);this.writeToken(s+n.CHAIN_ID,e);this.writeRange(r.numberTokens.get(this.getEntityType(o,r.data)),e);this.writeToken(s+n.RES_SEQN,e);this.writeTokenCond(s+n.INS_CODE,e,r.dot);this.writeToken(s+n.X,e);this.writeToken(s+n.Y,e);this.writeToken(s+n.Z,e);this.writeToken(s+n.OCCUPANCY,e);this.writeToken(s+n.TEMP_FACTOR,e);this.writeRange(r.question,e);this.writeRange(r.question,e);this.writeRange(r.question,e);this.writeRange(r.question,e);this.writeRange(r.question,e);this.writeRange(r.question,e);this.writeToken(s+n.RES_SEQN,e);this.writeToken(s+n.RES_NAME,e);this.writeToken(s+n.CHAIN_ID,e);this.writeToken(s+n.ATOM_NAME,e);this.writeRange(t,e)}};e.COLUMNS=["_atom_site.group_PDB","_atom_site.id","_atom_site.type_symbol","_atom_site.label_atom_id","_atom_site.label_alt_id","_atom_site.label_comp_id","_atom_site.label_asym_id","_atom_site.label_entity_id","_atom_site.label_seq_id","_atom_site.pdbx_PDB_ins_code","_atom_site.Cartn_x","_atom_site.Cartn_y","_atom_site.Cartn_z","_atom_site.occupancy","_atom_site.B_iso_or_equiv","_atom_site.Cartn_x_esd","_atom_site.Cartn_y_esd","_atom_site.Cartn_z_esd","_atom_site.occupancy_esd","_atom_site.B_iso_or_equiv_esd","_atom_site.pdbx_formal_charge","_atom_site.auth_seq_id","_atom_site.auth_comp_id","_atom_site.auth_asym_id","_atom_site.auth_atom_id","_atom_site.pdbx_PDB_model_num"];return e}();r.ModelData=a;var u=function(){function r(t){this.models=t}r.prototype.toCifCategory=function(r,n){var i=0;for(var o=0,s=this.models;o<s.length;o++){var u=s[o];i+=u.atomCount}var c=26;var f=t.Utils.ArrayBuilder.forTokenIndices(i*c);for(var l=0,h=this.models;l<h.length;l++){var u=h[l];u.writeCifTokens(u.idToken,f,n)}return new e.CIF.Text.Category(r.data,"_atom_site",0,0,a.COLUMNS,f.array,i*c)};return r}();r.ModelsData=u})(n=r.PDB||(r.PDB={}))})(r=e.Molecule||(e.Molecule={}))})(e=t.Formats||(t.Formats={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){var r;(function(r){var n;(function(r){"use strict";var n=function(){function t(t){this.data=t;this.trimmedToken={start:0,end:0};this.line=0;this.position=0;this.length=t.length}t.prototype.moveToNextLine=function(){while(this.position<this.length&&this.data.charCodeAt(this.position)!==10){this.position++}this.position++;this.line++;return this.position};t.prototype.moveToEndOfLine=function(){while(this.position<this.length){var t=this.data.charCodeAt(this.position);if(t===10||t===13){return this.position}this.position++}return this.position};t.prototype.startsWith=function(t,e){for(var r=e.length-1;r>=0;r--){if(this.data.charCodeAt(r+t)!==e.charCodeAt(r)){return false}}return true};t.prototype.trim=function(t,e){while(t<e&&this.data.charCodeAt(t)===32)t++;while(e>t&&this.data.charCodeAt(e-1)===32)e--;this.trimmedToken.start=t;this.trimmedToken.end=e};t.prototype.tokenizeAtomRecord=function(t){var r=this.position;var n=this.position;var i=this.moveToEndOfLine();var o=i-n;if(o<60)return false;this.trim(n,n+6);e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end);n=r+6;this.trim(n,n+5);e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end);n=r+12;this.trim(n,n+4);e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end);if(this.data.charCodeAt(r+16)===32){e.TokenIndexBuilder.addToken(t,0,0)}else{e.TokenIndexBuilder.addToken(t,r+16,r+17)}n=r+17;this.trim(n,n+3);e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end);e.TokenIndexBuilder.addToken(t,r+21,r+22);n=r+22;this.trim(n,n+4);e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end);if(this.data.charCodeAt(r+26)===32){e.TokenIndexBuilder.addToken(t,0,0)}else{e.TokenIndexBuilder.addToken(t,r+26,r+27)}n=r+30;this.trim(n,n+8);e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end);n=r+38;this.trim(n,n+8);e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end);n=r+46;this.trim(n,n+8);e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end);n=r+54;this.trim(n,n+6);e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end);if(o>=66){n=r+60;this.trim(n,n+6);e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end)}else{e.TokenIndexBuilder.addToken(t,0,0)}if(o>=78){n=r+76;this.trim(n,n+2);if(this.trimmedToken.start<this.trimmedToken.end){e.TokenIndexBuilder.addToken(t,this.trimmedToken.start,this.trimmedToken.end)}else{e.TokenIndexBuilder.addToken(t,r+12,r+13)}}else{e.TokenIndexBuilder.addToken(t,r+12,r+13)}return true};return t}();var i=function(){function i(){}i.tokenizeAtom=function(t,r){if(r.tokenizeAtomRecord(t)){return void 0}return new e.ParserError("Invalid ATOM/HETATM record.",r.line)};i.tokenize=function(t,o){var s=new n(o);var a=o.length;var u=e.TokenIndexBuilder.create(4096);var c=0;var f=[];var l=void 0;var h={start:0,end:0};while(s.position<a){var d=true;switch(o.charCodeAt(s.position)){case 65:if(s.startsWith(s.position,"ATOM")){if(!u){u=e.TokenIndexBuilder.create(4096)}var p=i.tokenizeAtom(u,s);c++;if(p)return p}break;case 67:if(s.startsWith(s.position,"CRYST1")){var v=s.position;var m=s.moveToEndOfLine();l=new r.CrystStructureInfo(o.substring(v,m))}break;case 69:if(s.startsWith(s.position,"ENDMDL")&&c>0){if(f.length===0){h={start:o.length+3,end:o.length+4}}if(u){f.push(new r.ModelData(h,u.tokens,c))}c=0;u=null}else if(s.startsWith(s.position,"END")){var v=s.position;var m=s.moveToEndOfLine();s.trim(v,m);if(s.trimmedToken.end-s.trimmedToken.start===3){d=false}}break;case 72:if(s.startsWith(s.position,"HETATM")){if(!u){u=e.TokenIndexBuilder.create(4096)}var p=i.tokenizeAtom(u,s);c++;if(p)return p}break;case 77:if(s.startsWith(s.position,"MODEL")){if(c>0){if(f.length===0){h={start:o.length+3,end:o.length+4}}if(u){f.push(new r.ModelData(h,u.tokens,c))}}var v=s.position+6;var m=s.moveToEndOfLine();s.trim(v,m);h={start:s.trimmedToken.start,end:s.trimmedToken.end};if(c>0||!u){u=e.TokenIndexBuilder.create(4096)}c=0}break}s.moveToNextLine();if(!d)break}var g=o+".?0123";if(c>0){if(f.length===0){h={start:o.length+3,end:o.length+4}}if(u){f.push(new r.ModelData(h,u.tokens,c))}}return new r.MoleculeData(new r.Header(t),l,new r.ModelsData(f),g)};i.getDotRange=function(t){return{start:t-6,end:t-5}};i.getNumberRanges=function(e){var r=t.Utils.FastMap.create();for(var n=0;n<4;n++){r.set(n,{start:e-4+n,end:e-3+n})}return r};i.getQuestionmarkRange=function(t){return{start:t-5,end:t-4}};i.parse=function(t,r){var n=i.tokenize(t,r);if(n instanceof e.ParserError){return e.ParserResult.error(n.message,n.line)}else{return e.ParserResult.success(n.toCifFile())}};return i}();r.Parser=i;function o(t,e){return i.parse(t,e)}r.toCifFile=o})(n=r.PDB||(r.PDB={}))})(r=e.Molecule||(e.Molecule={}))})(e=t.Formats||(t.Formats={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){var r;(function(r){var n;(function(r){function n(r,n){var i=r.split(/\r?\n/g);var o=i[0].trim();if(!o.length)o="SDF";var s=i[3];var a=+s.substr(0,3);var u=+s.substr(3,3);return{id:n?n:o,atomCount:a,bondCount:u,atoms:t.Utils.DataTable.ofDefinition(t.Structure.Tables.Atoms,a),positions:t.Utils.DataTable.ofDefinition(t.Structure.Tables.Positions,a),bonds:t.Utils.DataTable.ofDefinition(t.Structure.Tables.Bonds,u),lines:i,currentLine:4,error:void 0,stringPool:e.ShortStringPool.create()}}function i(r,n){var i=n.lines[n.currentLine];var o=n.atoms,s=n.positions;var a=e.ShortStringPool.get(n.stringPool,i.substr(31,3).trim());o.id[r]=r;o.elementSymbol[r]=a;o.name[r]=a;o.authName[r]=a;o.occupancy[r]=1;o.rowIndex[r]=n.currentLine;s.x[r]=t.Utils.FastNumberParsers.parseFloatSkipTrailingWhitespace(i,0,10);s.y[r]=t.Utils.FastNumberParsers.parseFloatSkipTrailingWhitespace(i,10,20);s.z[r]=t.Utils.FastNumberParsers.parseFloatSkipTrailingWhitespace(i,20,30)}function o(t){for(var e=0;e<t.atomCount;e++){i(e,t);t.currentLine++}}function s(e,r){var n=r.lines[r.currentLine];var i=r.bonds;i.atomAIndex[e]=t.Utils.FastNumberParsers.parseIntSkipTrailingWhitespace(n,0,3)-1;i.atomBIndex[e]=t.Utils.FastNumberParsers.parseIntSkipTrailingWhitespace(n,3,6)-1;switch(t.Utils.FastNumberParsers.parseIntSkipTrailingWhitespace(n,6,9)){case 1:i.type[e]=1;break;case 2:i.type[e]=2;break;case 3:i.type[e]=3;break;case 4:i.type[e]=4;break;default:i.type[e]=0;break}}function a(t){for(var e=0;e<t.bondCount;e++){s(e,t);t.currentLine++}}function u(e){var r=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Residues,1),n=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Chains,1),i=t.Utils.DataTable.ofDefinition(t.Structure.Tables.Entities,1);r.isHet[0]=1;r.insCode[0]=null;r.name[0]=r.authName[0]="UNK";r.atomEndIndex[0]=n.atomEndIndex[0]=i.atomEndIndex[0]=e.atomCount;r.asymId[0]=r.authAsymId[0]=n.asymId[0]=n.authAsymId[0]="X";r.entityId[0]=n.entityId[0]=i.entityId[0]="1";n.residueEndIndex[0]=i.residueEndIndex[0]=0;i.chainEndIndex[0]=1;i.type[0]="non-polymer";var o=new t.Structure.PolyResidueIdentifier("X",0,null);var s=[new t.Structure.SecondaryStructureElement(0,o,o)];s[0].startResidueIndex=0;s[0].endResidueIndex=1;return t.Structure.Molecule.Model.create({id:e.id,modelId:"1",data:{atoms:e.atoms,residues:r,chains:n,entities:i,bonds:{input:e.bonds},secondaryStructure:s,symmetryInfo:void 0,assemblyInfo:void 0},positions:e.positions,source:t.Structure.Molecule.Model.Source.File})}function c(r,i){try{var s=n(r,i);o(s);a(s);var c=u(s);if(s.error){return e.ParserResult.error(s.error,s.currentLine+1)}var f=t.Structure.Molecule.create(i?i:s.id,[c]);return e.ParserResult.success(f)}catch(t){return e.ParserResult.error(""+t)}}r.parse=c})(n=r.SDF||(r.SDF={}))})(r=e.Molecule||(e.Molecule={}))})(e=t.Formats||(t.Formats={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){var r;(function(r){function n(n,i){var o=this;return function(s,a){return t.computation(function(t){return u(o,void 0,void 0,function(){var o,u,f;return c(this,function(c){switch(c.label){case 0:return[4,t.updateProgress("Parsing...")];case 1:c.sent();o=i(s,a);if(o.isError){throw o.toString()}u=o.result;if(!u.dataBlocks.length){throw"The "+n+" data does not contain a data block."}return[4,t.updateProgress("Creating representation...")];case 2:c.sent();f=r.mmCIF.ofDataBlock(u.dataBlocks[0]);return[2,e.ParserResult.success(f,u.dataBlocks.length>1?["The input data contains multiple data blocks, only the first one was parsed. To parse all data blocks, use the function 'mmCIF.ofDataBlock' separately for each block."]:void 0)]}})})})}}var i;(function(i){var o=this;i.mmCIF={name:"mmCIF",shortcuts:["mmcif","cif"],extensions:[".cif"],parse:n("CIF",e.CIF.Text.parse)};i.mmBCIF={name:"mmCIF (Binary)",shortcuts:["mmbcif","bcif","binarycif"],extensions:[".bcif"],isBinary:true,parse:n("BinaryCIF",e.CIF.Binary.parse)};i.PDB={name:"PDB",shortcuts:["pdb","ent"],extensions:[".pdb",".ent"],parse:n("PDB",function(t,e){return r.PDB.toCifFile(e&&e.id||"PDB",t)})};i.SDF={name:"SDF",shortcuts:["sdf","mol"],extensions:[".sdf",".mol"],parse:function(n,i){return t.computation(function(t){return u(o,void 0,void 0,function(){var o;return c(this,function(s){switch(s.label){case 0:return[4,t.updateProgress("Parsing...")];case 1:s.sent();o=r.SDF.parse(n,i&&i.id||undefined);if(o.isError)throw o.toString();return[2,e.ParserResult.success(o.result)]}})})})}};i.All=[i.mmCIF,i.mmBCIF,i.PDB,i.SDF]})(i=r.SupportedFormats||(r.SupportedFormats={}))})(r=e.Molecule||(e.Molecule={}))})(e=t.Formats||(t.Formats={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){var e;(function(t){"use strict";function e(t,e){var r=t.length;for(var n=0;n<r;n++){t[n]=e}}var r=function(){function t(t,e){this.data=t;this.dimensions=e;this.len=this.dimensions[0]*this.dimensions[1]*this.dimensions[2];this.nX=this.dimensions[0];this.nY=this.dimensions[1]}Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:true,configurable:true});t.prototype.getAt=function(t){return this.data[t]};t.prototype.setAt=function(t,e){this.data[t]=e};t.prototype.get=function(t,e,r){return this.data[this.nX*(r*this.nY+e)+t|0]};t.prototype.set=function(t,e,r,n){this.data[this.nX*(r*this.nY+e)+t|0]=n};t.prototype.fill=function(t){e(this.data,t)};return t}();t.Field3DZYX=r;function n(t,e,r){var n=Math.PI/180*r[0],i=Math.PI/180*r[1],o=Math.PI/180*r[2];var s=e[0],a=e[1],u=e[2];var c=Math.cos(i),f=(Math.cos(n)-Math.cos(i)*Math.cos(o))/Math.sin(o),l=Math.sqrt(1-c*c-f*f);var h=[s,0,0];var d=[Math.cos(o)*a,Math.sin(o)*a,0];var p=[c*u,f*u,l*u];return{number:t,size:e,angles:r,basis:{x:h,y:d,z:p}}}t.createSpacegroup=n})(e=t.Density||(t.Density={}))})(e=t.Formats||(t.Formats={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){var e;(function(e){var r;(function(r){function n(t){return i.parse(t)}r.parse=n;var i;(function(r){function n(t,e,r){var n=[];for(var i=0;i<r;i++){n[i]=t(e+i)}return n}function i(r){var i=1024,a=new DataView(r,0,i),u=[];var c=false;var f=a.getInt32(3*4,false);if(f!==2){c=true;f=a.getInt32(3*4,true);if(f!==2){return t.ParserResult.error("Only CCP4 mode 2 is supported.")}}var l=function(t){return a.getInt32(t*4,c)},h=function(t){return a.getFloat32(t*4,c)};var d={extent:n(l,0,3),mode:f,nxyzStart:n(l,4,3),grid:n(l,7,3),cellSize:n(h,10,3),cellAngles:n(h,13,3),crs2xyz:n(l,16,3),min:h(19),max:h(20),mean:h(21),spacegroupNumber:l(22),symBytes:l(23),skewFlag:l(24),skewMatrix:n(h,25,9),skewTranslation:n(h,34,3),origin2k:n(h,49,3)};var p=r.byteLength-4*d.extent[0]*d.extent[1]*d.extent[2];if(p!==i+d.symBytes){if(p===i){u.push("File contains bogus symmetry record.")}else if(p<i){return t.ParserResult.error("File appears truncated and doesn't match header.")}else if(p>i&&p<1024*1024){p=i+d.symBytes;u.push("File is larger than expected and doesn't match header. Continuing file load, good luck!")}else{return t.ParserResult.error("File is MUCH larger than expected and doesn't match header.")}}if(d.grid[0]===0&&d.extent[0]>0){d.grid[0]=d.extent[0]-1;u.push("Fixed X interval count.")}if(d.grid[1]===0&&d.extent[1]>0){d.grid[1]=d.extent[1]-1;u.push("Fixed Y interval count.")}if(d.grid[2]===0&&d.extent[2]>0){d.grid[2]=d.extent[2]-1;u.push("Fixed Z interval count.")}if(d.crs2xyz[0]===0&&d.crs2xyz[1]===0&&d.crs2xyz[2]===0){u.push("All crs2xyz records are zero. Setting crs2xyz to 1, 2, 3.");d.crs2xyz=[1,2,3]}if(d.cellSize[0]===0&&d.cellSize[1]===0&&d.cellSize[2]===0){u.push("Cell dimensions are all zero. Setting to 1.0, 1.0, 1.0. Map file will not align with other structures.");d.cellSize[0]=1;d.cellSize[1]=1;d.cellSize[2]=1}var v=[0,0,0];v[d.crs2xyz[0]-1]=0;v[d.crs2xyz[1]-1]=1;v[d.crs2xyz[2]-1]=2;var m;if(d.origin2k[0]===0&&d.origin2k[1]===0&&d.origin2k[2]===0){m=[d.nxyzStart[v[0]],d.nxyzStart[v[1]],d.nxyzStart[v[2]]]}else{m=[d.origin2k[v[0]],d.origin2k[v[1]],d.origin2k[v[2]]]}var g=[d.extent[v[0]],d.extent[v[1]],d.extent[v[2]]];var y=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;var b=c===y?o(new Float32Array(r,i+d.symBytes,g[0]*g[1]*g[2]),c,g,d.extent,v,d.mean):s(new DataView(r,i+d.symBytes),c,g,d.extent,v,d.mean);var _=new e.Field3DZYX(b.data,g);var w={spacegroup:e.createSpacegroup(d.spacegroupNumber,d.cellSize,d.cellAngles),box:{origin:[m[0]/d.grid[0],m[1]/d.grid[1],m[2]/d.grid[2]],dimensions:[g[0]/d.grid[0],g[1]/d.grid[1],g[2]/d.grid[2]],sampleCount:g},data:_,valuesInfo:{min:d.min,max:d.max,mean:d.mean,sigma:b.sigma}};return t.ParserResult.success(w,u)}r.parse=i;function o(t,e,r,n,i,o){var s=new Float32Array(r[0]*r[1]*r[2]),a=[0,0,0],u,c,f,l,h,d,p,v,m=0,g=.1,y=0,b=.1,_=i[0],w=i[1],C=i[2];u=n[0];c=n[1];f=n[2];p=r[0];v=r[0]*r[1];for(d=0;d<f;d++){a[2]=d;for(h=0;h<c;h++){a[1]=h;for(l=0;l<u;l++){a[0]=l;g=t[m];b=g-o;y+=b*b,s[a[_]+a[w]*p+a[C]*v]=g;m+=1}}}y/=u*c*f;y=Math.sqrt(y);return{data:s,sigma:y}}function s(t,e,r,n,i,o){var s=new Float32Array(r[0]*r[1]*r[2]),a=[0,0,0],u,c,f,l,h,d,p,v,m=0,g=.1,y=0,b=.1,_=i[0],w=i[1],C=i[2];u=n[0];c=n[1];f=n[2];p=r[0];v=r[0]*r[1];for(d=0;d<f;d++){a[2]=d;for(h=0;h<c;h++){a[1]=h;for(l=0;l<u;l++){a[0]=l;g=t.getFloat32(m,e);b=g-o;y+=b*b,s[a[_]+a[w]*p+a[C]*v]=g;m+=4}}}y/=u*c*f;y=Math.sqrt(y);return{data:s,sigma:y}}})(i||(i={}))})(r=e.CCP4||(e.CCP4={}))})(e=t.Density||(t.Density={}))})(e=t.Formats||(t.Formats={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){var e;(function(e){var r;(function(r){function n(e){if(e.getCategory("_density_info"))return i.parseLegacy(e);else if(e.getCategory("_volume_data_3d_info"))return i.parse(e);return t.ParserResult.error("Invalid data format.")}r.parse=n;var i;(function(r){function n(r){var n=r.getCategory("_volume_data_3d_info");if(!n)return t.ParserResult.error("_volume_data_3d_info category is missing.");if(!r.getCategory("_volume_data_3d"))return t.ParserResult.error("_volume_data_3d category is missing.");function i(t){var e=[0,0,0];for(var r=0;r<3;r++){e[r]=n.getColumn(t+"["+r+"]").getFloat(0)}return e}function s(t){return n.getColumn(t).getFloat(0)}var a={name:n.getColumn("name").getString(0),axisOrder:i("axis_order"),origin:i("origin"),dimensions:i("dimensions"),sampleCount:i("sample_count"),spacegroupNumber:s("spacegroup_number")|0,cellSize:i("spacegroup_cell_size"),cellAngles:i("spacegroup_cell_angles"),mean:s("mean_sampled"),sigma:s("sigma_sampled")};var u=[0,0,0];u[a.axisOrder[0]]=0;u[a.axisOrder[1]]=1;u[a.axisOrder[2]]=2;function c(t){return[t[u[0]],t[u[1]],t[u[2]]]}var f=c(a.sampleCount);var l=o(r.getCategory("_volume_data_3d").getColumn("values"),f,a.sampleCount,u);var h=new e.Field3DZYX(l.data,f);var d={name:a.name,spacegroup:e.createSpacegroup(a.spacegroupNumber,a.cellSize,a.cellAngles),box:{origin:c(a.origin),dimensions:c(a.dimensions),sampleCount:f},data:h,valuesInfo:{min:l.min,max:l.max,mean:a.mean,sigma:a.sigma}};return t.ParserResult.success(d)}r.parse=n;function i(r){var n=r.getCategory("_density_info");if(!n)return t.ParserResult.error("_density_info category is missing.");if(!r.getCategory("_density_data"))return t.ParserResult.error("_density_data category is missing.");function i(t){var e=[];for(var r=0;r<3;r++){e[r]=n.getColumn(t+"["+r+"]").getFloat(0)}return e}function s(t){return n.getColumn(t).getFloat(0)}var a={name:n.getColumn("name").getString(0),grid:i("grid"),axisOrder:i("axis_order"),extent:i("extent"),origin:i("origin"),cellSize:i("cell_size"),cellAngles:i("cell_angles"),mean:s("mean"),sigma:s("sigma"),spacegroupNumber:s("spacegroup_number")|0};var u=[0,0,0];u[a.axisOrder[0]]=0;u[a.axisOrder[1]]=1;u[a.axisOrder[2]]=2;var c=[a.origin[u[0]],a.origin[u[1]],a.origin[u[2]]];var f=[a.extent[u[0]],a.extent[u[1]],a.extent[u[2]]];var l=o(r.getCategory("_density_data").getColumn("values"),f,a.extent,u);var h=new e.Field3DZYX(l.data,f);var d={name:a.name,spacegroup:e.createSpacegroup(a.spacegroupNumber,a.cellSize,a.cellAngles),box:{origin:[c[0]/a.grid[0],c[1]/a.grid[1],c[2]/a.grid[2]],dimensions:[f[0]/a.grid[0],f[1]/a.grid[1],f[2]/a.grid[2]],sampleCount:f},data:h,valuesInfo:{min:l.min,max:l.max,mean:a.mean,sigma:a.sigma}};return t.ParserResult.success(d)}r.parseLegacy=i;function o(t,e,r,n){var i=new Float32Array(e[0]*e[1]*e[2]);var o=[0,0,0];var s=n[0],a=n[1],u=n[2];var c=r[0],f=r[1],l=r[2];var h=e[0];var d=e[0]*e[1];var p=0;var v=t.getFloat(0),m=v;for(var g=0;g<l;g++){o[2]=g;for(var y=0;y<f;y++){o[1]=y;for(var b=0;b<c;b++){o[0]=b;var _=t.getFloat(p);p+=1;i[o[s]+o[a]*h+o[u]*d]=_;if(_<v)v=_;else if(_>m)m=_}}}return{data:i,min:v,max:m}}})(i||(i={}))})(r=e.CIF||(e.CIF={}))})(e=t.Density||(t.Density={}))})(e=t.Formats||(t.Formats={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){var r;(function(e){function r(e,r,n){var i=this;return t.computation(function(t){return u(i,void 0,void 0,function(){return c(this,function(i){switch(i.label){case 0:return[4,t.updateProgress("Parsing "+r+"...")];case 1:i.sent();return[2,n(e)]}})})})}var n;(function(t){t.CCP4={name:"CCP4",shortcuts:["ccp4","map"],extensions:[".ccp4",".map"],isBinary:true,parse:function(t){return r(t,"CCP4",function(t){return e.CCP4.parse(t)})}};t.All=[t.CCP4]})(n=e.SupportedFormats||(e.SupportedFormats={}))})(r=e.Density||(e.Density={}))})(e=t.Formats||(t.Formats={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){var e;(function(t){/*
                 * This code has been modified from https://github.com/toji/gl-matrix/,
                 * copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.
                 *
                 * Permission is hereby granted, free of charge, to any person obtaining a copy
                 * of this software and associated documentation files (the "Software"), to deal
                 * in the Software without restriction, including without limitation the rights
                 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
                 * copies of the Software, and to permit persons to whom the Software is
                 * furnished to do so, subject to the following conditions:
                 */
function e(){return e.zero()}t.Matrix4=e;(function(t){function e(){var t=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];t[0]=0;return t}t.zero=e;function r(){var t=e();t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t}t.identity=r;function n(t){t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t}t.fromIdentity=n;function i(t){var r=e(),n,i,o;for(n=0;n<4;n++){o=t[n];for(i=0;i<4;i++){r[4*i+n]=o[i]}}return r}t.ofRows=i;function o(t,e,r){for(var n=0;n<16;n++){if(Math.abs(t[n]-e[n])>r){return false}}return true}t.areEqual=o;function s(t,e,r,n){t[4*r+e]=n}t.setValue=s;function a(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t}t.copy=a;function u(e){return t.copy(t.zero(),e)}t.clone=u;function c(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],f=e[8],l=e[9],h=e[10],d=e[11],p=e[12],v=e[13],m=e[14],g=e[15],y=r*a-n*s,b=r*u-i*s,_=r*c-o*s,w=n*u-i*a,C=n*c-o*a,x=i*c-o*u,I=f*v-l*p,S=f*m-h*p,A=f*g-d*p,k=l*m-h*v,E=l*g-d*v,P=h*g-d*m,T=y*P-b*E+_*k+w*A-C*S+x*I;if(!T){return null}T=1/T;t[0]=(a*P-u*E+c*k)*T;t[1]=(i*E-n*P-o*k)*T;t[2]=(v*x-m*C+g*w)*T;t[3]=(h*C-l*x-d*w)*T;t[4]=(u*A-s*P-c*S)*T;t[5]=(r*P-i*A+o*S)*T;t[6]=(m*_-p*x-g*b)*T;t[7]=(f*x-h*_+d*b)*T;t[8]=(s*E-a*A+c*I)*T;t[9]=(n*A-r*E-o*I)*T;t[10]=(p*C-v*_+g*y)*T;t[11]=(l*_-f*C-d*y)*T;t[12]=(a*S-s*k-u*I)*T;t[13]=(r*k-n*S+i*I)*T;t[14]=(v*b-p*w-m*y)*T;t[15]=(f*w-l*b+h*y)*T;return t}t.invert=c;function f(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],f=e[7],l=e[8],h=e[9],d=e[10],p=e[11],v=e[12],m=e[13],g=e[14],y=e[15];var b=r[0],_=r[1],w=r[2],C=r[3];t[0]=b*n+_*a+w*l+C*v;t[1]=b*i+_*u+w*h+C*m;t[2]=b*o+_*c+w*d+C*g;t[3]=b*s+_*f+w*p+C*y;b=r[4];_=r[5];w=r[6];C=r[7];t[4]=b*n+_*a+w*l+C*v;t[5]=b*i+_*u+w*h+C*m;t[6]=b*o+_*c+w*d+C*g;t[7]=b*s+_*f+w*p+C*y;b=r[8];_=r[9];w=r[10];C=r[11];t[8]=b*n+_*a+w*l+C*v;t[9]=b*i+_*u+w*h+C*m;t[10]=b*o+_*c+w*d+C*g;t[11]=b*s+_*f+w*p+C*y;b=r[12];_=r[13];w=r[14];C=r[15];t[12]=b*n+_*a+w*l+C*v;t[13]=b*i+_*u+w*h+C*m;t[14]=b*o+_*c+w*d+C*g;t[15]=b*s+_*f+w*p+C*y;return t}t.mul=f;function l(t,e,r,n){return f(t,f(t,e,r),n)}t.mul3=l;function h(t,e,r){var n=r[0],i=r[1],o=r[2],s,a,u,c,f,l,h,d,p,v,m,g;if(e===t){t[12]=e[0]*n+e[4]*i+e[8]*o+e[12];t[13]=e[1]*n+e[5]*i+e[9]*o+e[13];t[14]=e[2]*n+e[6]*i+e[10]*o+e[14];t[15]=e[3]*n+e[7]*i+e[11]*o+e[15]}else{s=e[0];a=e[1];u=e[2];c=e[3];f=e[4];l=e[5];h=e[6];d=e[7];p=e[8];v=e[9];m=e[10];g=e[11];t[0]=s;t[1]=a;t[2]=u;t[3]=c;t[4]=f;t[5]=l;t[6]=h;t[7]=d;t[8]=p;t[9]=v;t[10]=m;t[11]=g;t[12]=s*n+f*i+p*o+e[12];t[13]=a*n+l*i+v*o+e[13];t[14]=u*n+h*i+m*o+e[14];t[15]=c*n+d*i+g*o+e[15]}return t}t.translate=h;function d(t,e){t[0]=1;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=1;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=1;t[11]=0;t[12]=e[0];t[13]=e[1];t[14]=e[2];t[15]=1;return t}t.fromTranslation=d;function p(t,e,r,n){var i=n[0],o=n[1],s=n[2],a=Math.sqrt(i*i+o*o+s*s),u,c,f,l,h,d,p,v,m,g,y,b,_,w,C,x,I,S,A,k,E,P,T,F;if(Math.abs(a)<1e-6){return null}a=1/a;i*=a;o*=a;s*=a;u=Math.sin(r);c=Math.cos(r);f=1-c;l=e[0];h=e[1];d=e[2];p=e[3];v=e[4];m=e[5];g=e[6];y=e[7];b=e[8];_=e[9];w=e[10];C=e[11];x=i*i*f+c;I=o*i*f+s*u;S=s*i*f-o*u;A=i*o*f-s*u;k=o*o*f+c;E=s*o*f+i*u;P=i*s*f+o*u;T=o*s*f-i*u;F=s*s*f+c;t[0]=l*x+v*I+b*S;t[1]=h*x+m*I+_*S;t[2]=d*x+g*I+w*S;t[3]=p*x+y*I+C*S;t[4]=l*A+v*k+b*E;t[5]=h*A+m*k+_*E;t[6]=d*A+g*k+w*E;t[7]=p*A+y*k+C*E;t[8]=l*P+v*T+b*F;t[9]=h*P+m*T+_*F;t[10]=d*P+g*T+w*F;t[11]=p*P+y*T+C*F;if(e!==t){t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15]}return t}t.rotate=p;function v(t,e,r){var i=r[0],o=r[1],s=r[2],a=Math.sqrt(i*i+o*o+s*s),u,c,f;if(Math.abs(a)<1e-6){return n(t)}a=1/a;i*=a;o*=a;s*=a;u=Math.sin(e);c=Math.cos(e);f=1-c;t[0]=i*i*f+c;t[1]=o*i*f+s*u;t[2]=s*i*f-o*u;t[3]=0;t[4]=i*o*f-s*u;t[5]=o*o*f+c;t[6]=s*o*f+i*u;t[7]=0;t[8]=i*s*f+o*u;t[9]=o*s*f-i*u;t[10]=s*s*f+c;t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t}t.fromRotation=v;function m(t,e,r){var n=r[0],i=r[1],o=r[2];t[0]=e[0]*n;t[1]=e[1]*n;t[2]=e[2]*n;t[3]=e[3]*n;t[4]=e[4]*i;t[5]=e[5]*i;t[6]=e[6]*i;t[7]=e[7]*i;t[8]=e[8]*o;t[9]=e[9]*o;t[10]=e[10]*o;t[11]=e[11]*o;t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t}t.scale=m;function g(t,e){t[0]=e[0];t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=e[1];t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=e[2];t[11]=0;t[12]=0;t[13]=0;t[14]=0;t[15]=1;return t}t.fromScaling=g;function y(t){var e="";for(var r=0;r<4;r++){for(var n=0;n<4;n++){e+=t[4*n+r].toString();if(n<3)e+=" "}if(r<3)e+="\n"}return e}t.makeTable=y;function b(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],f=t[9],l=t[10],h=t[11],d=t[12],p=t[13],v=t[14],m=t[15],g=e*s-r*o,y=e*a-n*o,b=e*u-i*o,_=r*a-n*s,w=r*u-i*s,C=n*u-i*a,x=c*p-f*d,I=c*v-l*d,S=c*m-h*d,A=f*v-l*p,k=f*m-h*p,E=l*m-h*v;return g*E-y*k+b*A+_*S-w*I+C*x}t.determinant=b})(e=t.Matrix4||(t.Matrix4={}));function r(t,e,n){return r.fromValues(t||0,e||0,n||0)}t.Vector3=r;(function(t){function r(){var t=[.1,0,0];t[0]=0;return t}t.zero=r;function n(t){var e=r();e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}t.clone=n;function i(t){return s(t.x,t.y,t.z)}t.fromObj=i;function o(t){return{x:t[0],y:t[1],z:t[2]}}t.toObj=o;function s(t,e,n){var i=r();i[0]=t;i[1]=e;i[2]=n;return i}t.fromValues=s;function a(t,e,r,n){t[0]=e;t[1]=r;t[2]=n;return t}t.set=a;function u(t,e){t[0]=e[0];t[1]=e[1];t[2]=e[2];return t}t.copy=u;function c(t,e,r){t[0]=e[0]+r[0];t[1]=e[1]+r[1];t[2]=e[2]+r[2];return t}t.add=c;function f(t,e,r){t[0]=e[0]-r[0];t[1]=e[1]-r[1];t[2]=e[2]-r[2];return t}t.sub=f;function l(t,e,r){t[0]=e[0]*r;t[1]=e[1]*r;t[2]=e[2]*r;return t}t.scale=l;function h(t,e,r,n){t[0]=e[0]+r[0]*n;t[1]=e[1]+r[1]*n;t[2]=e[2]+r[2]*n;return t}t.scaleAndAdd=h;function d(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(r*r+n*n+i*i)}t.distance=d;function p(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i}t.squaredDistance=p;function v(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}t.magnitude=v;function m(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}t.squaredMagnitude=m;function g(t,e){var r=e[0],n=e[1],i=e[2];var o=r*r+n*n+i*i;if(o>0){o=1/Math.sqrt(o);t[0]=e[0]*o;t[1]=e[1]*o;t[2]=e[2]*o}return t}t.normalize=g;function y(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}t.dot=y;function b(t,e,r){var n=e[0],i=e[1],o=e[2],s=r[0],a=r[1],u=r[2];t[0]=i*u-o*a;t[1]=o*s-n*u;t[2]=n*a-i*s;return t}t.cross=b;function _(t,e,r,n){var i=e[0],o=e[1],s=e[2];t[0]=i+n*(r[0]-i);t[1]=o+n*(r[1]-o);t[2]=s+n*(r[2]-s);return t}t.lerp=_;function w(t,e,r){var n=e[0],i=e[1],o=e[2],s=r[3]*n+r[7]*i+r[11]*o+r[15];s=s||1;t[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/s;t[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/s;t[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/s;return t}t.transformMat4=w;var C=r(),x=r();function I(t,e){u(C,t);u(x,e);g(C,C);g(x,x);var r=y(C,x);if(r>1){return 0}else if(r<-1){return Math.PI}else{return Math.acos(r)}}t.angle=I;var S=r();function A(t,r,n){var i=I(r,n);if(Math.abs(i)<1e-4)return e.fromIdentity(t);var o=b(S,r,n);return e.fromRotation(t,i,o)}t.makeRotation=A})(r=t.Vector3||(t.Vector3={}));function n(t,e,r,i){return n.fromValues(t||0,e||0,r||0,i||0)}t.Vector4=n;(function(t){function e(){var t=[.1,0,0,0];t[0]=0;return t}t.zero=e;function r(t){var r=e();r[0]=t[0];r[1]=t[1];r[2]=t[2];r[3]=t[3];return r}t.clone=r;function n(t,r,n,i){var o=e();o[0]=t;o[1]=r;o[2]=n;o[3]=i;return o}t.fromValues=n;function i(t,e,r,n,i){t[0]=e;t[1]=r;t[2]=n;t[3]=i;return t}t.set=i;function o(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+n*n+i*i+o*o)}t.distance=o;function s(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+i*i+o*o}t.squaredDistance=s;function a(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)}t.norm=a;function u(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}t.squaredNorm=u;function c(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3];t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*s;t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*s;t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*s;t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*s;return t}t.transform=c})(n=t.Vector4||(t.Vector4={}))})(e=t.LinearAlgebra||(t.LinearAlgebra={}))})(e=t.Geometry||(t.Geometry={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){"use strict";var r;(function(r){var n=e.LinearAlgebra.Vector3;function i(t){if(t.normals)return;var e=new Float32Array(t.vertices.length),r=t.vertices,i=t.triangleIndices;var o=n.zero(),s=n.zero(),a=n.zero(),u=n.zero(),c=n.zero(),f=n.zero();for(var l=0;l<i.length;l+=3){var h=3*i[l],d=3*i[l+1],p=3*i[l+2];n.set(o,r[h],r[h+1],r[h+2]);n.set(s,r[d],r[d+1],r[d+2]);n.set(a,r[p],r[p+1],r[p+2]);n.sub(u,a,s);n.sub(c,s,o);n.cross(f,u,c);e[h]+=f[0];e[h+1]+=f[1];e[h+2]+=f[2];e[d]+=f[0];e[d+1]+=f[1];e[d+2]+=f[2];e[p]+=f[0];e[p+1]+=f[1];e[p+2]+=f[2]}for(var l=0;l<e.length;l+=3){var v=e[l];var m=e[l+1];var g=e[l+2];var y=1/Math.sqrt(v*v+m*m+g*g);e[l]*=y;e[l+1]*=y;e[l+2]*=y}t.normals=e}r.computeNormalsImmediate=i;function o(e){var r=this;return t.computation(function(t){return u(r,void 0,void 0,function(){return c(this,function(r){switch(r.label){case 0:if(e.normals){return[2,e]};return[4,t.updateProgress("Computing normals...")];case 1:r.sent();i(e);return[2,e]}})})})}r.computeNormals=o;function s(t,e,r,n){r[3*n]+=t[3*e];r[3*n+1]+=t[3*e+1];r[3*n+2]+=t[3*e+2]}function a(t,e,r,n){var i=t.triangleIndices.length,o=t.vertices;var a=t.triangleIndices;for(var u=0;u<i;u+=3){var c=a[u],f=a[u+1],l=a[u+2];s(o,f,r,c);s(o,l,r,c);s(o,c,r,f);s(o,l,r,f);s(o,c,r,l);s(o,f,r,l)}var h=2*n;for(var u=0,d=t.vertexCount;u<d;u++){var p=e[u]+h;r[3*u]=(r[3*u]+h*o[3*u])/p;r[3*u+1]=(r[3*u+1]+h*o[3*u+1])/p;r[3*u+2]=(r[3*u+2]+h*o[3*u+2])/p}}function f(e,r,n,i){return u(this,void 0,void 0,function(){var o,s,u,f,l,h,f,d,p,v,m;return c(this,function(c){switch(c.label){case 0:return[4,e.updateProgress("Smoothing surface...",true)];case 1:c.sent();o=new Int32Array(r.vertexCount),s=r.triangleIndices.length;u=r.triangleIndices;for(f=0;f<s;f++){o[u[f]]+=2}l=new Float32Array(r.vertices.length);h=t.Utils.PerformanceMonitor.currentTime();return[4,e.updateProgress("Smoothing surface...",true)];case 2:c.sent();f=0;c.label=3;case 3:if(!(f<n))return[3,6];if(f>0){for(d=0,p=l.length;d<p;d++)l[d]=0}r.normals=void 0;a(r,o,l,i);v=r.vertices;r.vertices=l;l=v;m=t.Utils.PerformanceMonitor.currentTime();if(!(m-h>t.Computation.UpdateProgressDelta))return[3,5];h=m;return[4,e.updateProgress("Smoothing surface...",true,f+1,n)];case 4:c.sent();c.label=5;case 5:f++;return[3,3];case 6:return[2,r]}})})}function l(e,r,n){var i=this;if(r===void 0){r=1}if(n===void 0){n=1}if(r<1)r=0;if(r===0)return t.Computation.resolve(e);return t.computation(function(t){return u(i,void 0,void 0,function(){return c(this,function(i){switch(i.label){case 0:return[4,f(t,e,r,1.1*n/1.1)];case 1:return[2,i.sent()]}})})})}r.laplacianSmooth=l;function h(r){var n=this;return t.computation(function(t){return u(n,void 0,void 0,function(){var n,i,o,s,a,u,f,a,u,l,h,d;return c(this,function(c){switch(c.label){case 0:if(r.boundingSphere){return[2,r]}return[4,t.updateProgress("Computing bounding sphere...")];case 1:c.sent();n=r.vertices;i=0,o=0,s=0;for(a=0,u=r.vertices.length;a<u;a+=3){i+=n[a];o+=n[a+1];s+=n[a+2]}i/=r.vertexCount;o/=r.vertexCount;s/=r.vertexCount;f=0;for(a=0,u=n.length;a<u;a+=3){l=i-n[a];h=o-n[a+1];d=s-n[a+2];f=Math.max(f,l*l+h*h+d*d)}r.boundingSphere={center:e.LinearAlgebra.Vector3.fromValues(i,o,s),radius:Math.sqrt(f)};return[2,r]}})})})}r.computeBoundingSphere=h;function d(t,r){var n=e.LinearAlgebra.Vector3.zero();var i=e.LinearAlgebra.Vector3.transformMat4;var o=t.vertices;for(var s=0,a=t.vertices.length;s<a;s+=3){n[0]=o[s];n[1]=o[s+1];n[2]=o[s+2];i(n,n,r);o[s]=n[0];o[s+1]=n[1];o[s+2]=n[2]}t.normals=void 0;t.boundingSphere=void 0}r.transformImmediate=d;function p(e,r){var n=this;return t.computation(function(t){return u(n,void 0,void 0,function(){return c(this,function(n){t.updateProgress("Updating surface...");d(e,r);return[2,e]})})})}r.transform=p})(r=e.Surface||(e.Surface={}))})(e=t.Geometry||(t.Geometry={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){var e;(function(t){var e;(function(t){function e(){return{min:[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],max:[-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE]}}t.createInfinite=e})(e=t.Box3D||(t.Box3D={}));var r;(function(t){function e(t,e,r){var n=t.buffer;n.squaredDistances[n.count]=e;n.elements[n.count++]=n.sourceElements[r]}t.add=e;function r(t){t.count=0}function n(t){return{sourceElements:t,elements:[],count:0,squaredDistances:[]}}function i(t,e,n,i,o){t.pivot[0]=e;t.pivot[1]=n;t.pivot[2]=i;t.radius=o;t.radiusSq=o*o;r(t.buffer)}t.update=i;function o(t,e){return{structure:t,buffer:n(e),pivot:[.1,.1,.1],radius:1.1,radiusSq:1.1*1.1}}t.create=o})(r=t.QueryContext||(t.QueryContext={}));var n;(function(t){function r(t,e,r,n){t.data[t._count++]=e;t.data[t._count++]=r;t.data[t._count++]=n;t.boundsMin[0]=Math.min(e,t.boundsMin[0]);t.boundsMin[1]=Math.min(r,t.boundsMin[1]);t.boundsMin[2]=Math.min(n,t.boundsMin[2]);t.boundsMax[0]=Math.max(e,t.boundsMax[0]);t.boundsMax[1]=Math.max(r,t.boundsMax[1]);t.boundsMax[2]=Math.max(n,t.boundsMax[2])}t.add=r;function n(t){var r=new Float32Array(t*3|0);var n=e.createInfinite();var i=n.min;var o=n.max;return{_count:0,data:r,bounds:n,boundsMin:i,boundsMax:o}}t.create=n;function i(e){var r=t.add;return function(t,n,i){r(e,t,n,i)}}t.createAdder=i})(n||(n={}));function i(t,e){var r=n.create(t.length);var i=new Int32Array(t.length);var o=n.createAdder(r);for(var s=0;s<t.length;s++){i[s]=s;e(t[s],o)}return{elements:t,positions:r.data,bounds:r.bounds,indices:i}}t.createInputData=i})(e=t.Query3D||(t.Query3D={}))})(e=t.Geometry||(t.Geometry={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){var e;(function(t){var e;(function(e){function r(e,r){var n=r.pivot,i=r.structure,o=i.indices,s=i.positions,a=r.radiusSq,u,c,f,l,h,d;for(d=e.startIndex;d<e.endIndex;d++){l=3*o[d];u=n[0]-s[l];c=n[1]-s[l+1];f=n[2]-s[l+2];h=u*u+c*c+f*f;if(h<=a)t.QueryContext.add(r,h,o[d])}}function n(t,e,r){var n=e.pivot[r],o=n<t.splitValue;if(o?n+e.radius>t.splitValue:n-e.radius<t.splitValue){i(t.left,e,(r+1)%3);i(t.right,e,(r+1)%3)}else if(o){i(t.left,e,(r+1)%3)}else{i(t.right,e,(r+1)%3)}}function i(t,e,i){if(t.startIndex===t.endIndex)return;if(isNaN(t.splitValue))r(t,e);else n(t,e,i)}e.nearest=i;function o(t,e,r,n,i){return{splitValue:t,startIndex:e,endIndex:r,left:n,right:i}}e.create=o})(e||(e={}));var r;(function(t){function r(t,n,i,o){var s=i-n+1;if(s<=0){return t.emptyNode}else if(s<=t.leafSize){return e.create(NaN,n,i+1,t.emptyNode,t.emptyNode)}var a=t.bounds.min[o],u=t.bounds.max[o],c=.5*(a+u),f=0,l=n,h=i,d,p,v;while(l<h){d=t.indices[h];t.indices[h]=t.indices[l];t.indices[l]=d;while(l<=i&&t.positions[3*t.indices[l]+o]<=c)l++;while(h>=n&&t.positions[3*t.indices[h]+o]>c)h--}f=l-1;t.bounds.max[o]=c;p=r(t,n,f,(o+1)%3);t.bounds.max[o]=u;t.bounds.min[o]=c;v=r(t,f+1,i,(o+1)%3);t.bounds.min[o]=a;return e.create(c,n,i+1,p,v)}function n(t,n){var i=t.elements,o=t.positions,s=t.bounds,a=t.indices;var u={bounds:s,positions:o,leafSize:n,indices:a,emptyNode:e.create(NaN,-1,-1,void 0,void 0)};var c=r(u,0,a.length-1,0);return{root:c,indices:a,positions:o}}t.build=n})(r||(r={}));function n(n,i){if(i===void 0){i=32}var o=r.build(n,i);return function(){var r=t.QueryContext.create(o,n.elements);return function(n,i,s,a){t.QueryContext.update(r,n,i,s,a);e.nearest(o.root,r,0);return r.buffer}}}t.createSubdivisionTree=n})(e=t.Query3D||(t.Query3D={}))})(e=t.Geometry||(t.Geometry={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2017 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){var e;(function(t){/**
                 * Adapted from https://github.com/arose/ngl
                 * MIT License Copyright (C) 2014+ Alexander Rose
                 */
function e(e){var r=e.structure,n=r.min,i=n[0],o=n[1],s=n[2],a=r.size,u=a[0],c=a[1],f=a[2],l=r.bucketOffset,h=r.bucketCounts,d=r.bucketArray,p=r.grid,v=r.positions;var m=e.radius,g=e.radiusSq,y=e.pivot,b=y[0],_=y[1],w=y[2];var C=Math.max(0,b-m-i>>3);var x=Math.max(0,_-m-o>>3);var I=Math.max(0,w-m-s>>3);var S=Math.min(u,b+m-i>>3);var A=Math.min(c,_+m-o>>3);var k=Math.min(f,w+m-s>>3);for(var E=C;E<=S;E++){for(var P=x;P<=A;P++){for(var T=I;T<=k;T++){var F=(E*c+P)*f+T;var M=p[F];if(M>0){var D=M-1;var N=l[D];var R=h[D];var q=N+R;for(var U=N;U<q;U++){var O=d[U];var B=v[3*O+0]-b;var L=v[3*O+1]-_;var z=v[3*O+2]-w;var j=B*B+L*L+z*z;if(j<=g){t.QueryContext.add(e,j,O)}}}}}}}function r(t){var e=t.bounds,r=t.size,n=r[0],i=r[1],o=r[2],s=t.positions,a=t.indices;var u=n*i*o;var c=a.length;var f=e.min,l=f[0],h=f[1],d=f[2];var p=0;var v=new Uint32Array(u);var m=new Int32Array(c);for(var g=0;g<c;g++){var y=s[3*g+0]-l>>3;var b=s[3*g+1]-h>>3;var _=s[3*g+2]-d>>3;var w=(y*i+b)*o+_;if((v[w]+=1)===1){p+=1}m[g]=w}var C=new Int32Array(p);for(var g=0,x=0;g<u;g++){var I=v[g];if(I>0){v[g]=x+1;C[x]=I;x+=1}}var S=new Uint32Array(c);for(var g=1;g<c;++g){S[g]+=S[g-1]+C[g-1]}var A=new Int32Array(p);var k=new Int32Array(c);for(var g=0;g<c;g++){var E=v[m[g]];if(E>0){var P=E-1;k[S[P]+A[P]]=g;A[P]+=1}}return{size:t.size,bucketArray:k,bucketCounts:C,bucketOffset:S,grid:v,min:t.bounds.min,positions:s}}function n(t){var e=t.elements,n=t.positions,i=t.bounds,o=t.indices;var s=[(i.max[0]-i.min[0]>>3)+1,(i.max[1]-i.min[1]>>3)+1,(i.max[2]-i.min[2]>>3)+1];var a={size:s,positions:n,indices:o,bounds:i};return r(a)}function i(r){var i=n(r);return function(){var n=t.QueryContext.create(i,r.elements);return function(r,i,o,s){t.QueryContext.update(n,r,i,o,s);e(n);return n.buffer}}}t.createSpatialHash=i})(e=t.Query3D||(t.Query3D={}))})(e=t.Geometry||(t.Geometry={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){var r;(function(e){"use strict";function r(e){var r=this;return t.computation(function(t){return u(r,void 0,void 0,function(){var r;return c(this,function(i){switch(i.label){case 0:r=new n(e,t);return[4,r.run()];case 1:return[2,i.sent()]}})})})}e.compute=r;var n=function(){function e(e,r){this.ctx=r;this.minX=0;this.minY=0;this.minZ=0;this.maxX=0;this.maxY=0;this.maxZ=0;var n=t.Utils.extend({},e);if(!n.bottomLeft)n.bottomLeft=[0,0,0];if(!n.topRight)n.topRight=n.scalarField.dimensions;this.state=new i(n),this.minX=n.bottomLeft[0];this.minY=n.bottomLeft[1];this.minZ=n.bottomLeft[2];this.maxX=n.topRight[0]-1;this.maxY=n.topRight[1]-1;this.maxZ=n.topRight[2]-1;this.size=(this.maxX-this.minX)*(this.maxY-this.minY)*(this.maxZ-this.minZ);this.sliceSize=(this.maxX-this.minX)*(this.maxY-this.minY)}e.prototype.doSlices=function(){return u(this,void 0,void 0,function(){var e,r,n,i;return c(this,function(o){switch(o.label){case 0:e=0;r=t.Utils.PerformanceMonitor.currentTime();n=this.minZ;o.label=1;case 1:if(!(n<this.maxZ))return[3,4];this.slice(n);e+=this.sliceSize;i=t.Utils.PerformanceMonitor.currentTime();if(!(i-r>t.Computation.UpdateProgressDelta))return[3,3];return[4,this.ctx.updateProgress("Computing surface...",true,e,this.size)];case 2:o.sent();r=i;o.label=3;case 3:n++;return[3,1];case 4:return[2]}})})};e.prototype.slice=function(t){for(var e=this.minY;e<this.maxY;e++){for(var r=this.minX;r<this.maxX;r++){this.state.processCell(r,e,t)}}this.state.clearEdgeVertexIndexSlice(t)};e.prototype.finish=function(){var e=t.Utils.ChunkedArray.compact(this.state.vertexBuffer);var r=t.Utils.ChunkedArray.compact(this.state.triangleBuffer);this.state.vertexBuffer=void 0;this.state.verticesOnEdges=void 0;var n={vertexCount:e.length/3|0,triangleCount:r.length/3|0,vertices:e,triangleIndices:r,annotation:this.state.annotate?t.Utils.ChunkedArray.compact(this.state.annotationBuffer):void 0};return n};e.prototype.run=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.ctx.updateProgress("Computing surface...",true,0,this.size)];case 1:t.sent();return[4,this.doSlices()];case 2:t.sent();return[4,this.ctx.updateProgress("Finalizing...")];case 3:t.sent();return[2,this.finish()]}})})};return e}();var i=function(){function r(e){this.vertList=[0,0,0,0,0,0,0,0,0,0,0,0];this.i=0;this.j=0;this.k=0;this.nX=e.scalarField.dimensions[0];this.nY=e.scalarField.dimensions[1];this.nZ=e.scalarField.dimensions[2];this.isoLevel=e.isoLevel;this.scalarField=e.scalarField;this.annotationField=e.annotationField;var r=e.topRight[0]-e.bottomLeft[0],n=e.topRight[1]-e.bottomLeft[1],i=e.topRight[2]-e.bottomLeft[2],o=Math.min(262144,Math.max(r*n*i/16,1024)|0),s=Math.min(1<<16,o*4);this.vertexBuffer=t.Utils.ChunkedArray.forVertex3D(o);this.triangleBuffer=t.Utils.ChunkedArray.create(function(t){return new Uint32Array(t)},s,3);this.annotate=!!e.annotationField;if(this.annotate)this.annotationBuffer=t.Utils.ChunkedArray.forInt32(o);this.verticesOnEdges=new Int32Array(3*this.nX*this.nY*2)}r.prototype.get3dOffsetFromEdgeInfo=function(t){return this.nX*((this.k+t.k)%2*this.nY+this.j+t.j)+this.i+t.i};r.prototype.clearEdgeVertexIndexSlice=function(t){var e=t%2===0?0:3*this.nX*this.nY;var r=t%2===0?3*this.nX*this.nY:this.verticesOnEdges.length;for(var n=e;n<r;n++)this.verticesOnEdges[n]=0};r.prototype.interpolate=function(r){var n=e.EdgeIdInfo[r],i=3*this.get3dOffsetFromEdgeInfo(n)+n.e;var o=this.verticesOnEdges[i];if(o>0)return o-1|0;var s=e.CubeEdges[r];var a=s.a,u=s.b;var c=a.i+this.i,f=a.j+this.j,l=a.k+this.k;var h=u.i+this.i,d=u.j+this.j,p=u.k+this.k;var v=this.scalarField.get(c,f,l),m=this.scalarField.get(h,d,p);var g=(this.isoLevel-v)/(v-m);var y=t.Utils.ChunkedArray.add3(this.vertexBuffer,c+g*(c-h),f+g*(f-d),l+g*(l-p))|0;this.verticesOnEdges[i]=y+1;if(this.annotate){var b=g<.5?this.annotationField.get(c,f,l):this.annotationField.get(h,d,p);if(b<0)b=g<.5?this.annotationField.get(h,d,p):this.annotationField.get(c,f,l);t.Utils.ChunkedArray.add(this.annotationBuffer,b)}return y};r.prototype.processCell=function(r,n,i){var o=0;if(this.scalarField.get(r,n,i)<this.isoLevel)o|=1;if(this.scalarField.get(r+1,n,i)<this.isoLevel)o|=2;if(this.scalarField.get(r+1,n+1,i)<this.isoLevel)o|=4;if(this.scalarField.get(r,n+1,i)<this.isoLevel)o|=8;if(this.scalarField.get(r,n,i+1)<this.isoLevel)o|=16;if(this.scalarField.get(r+1,n,i+1)<this.isoLevel)o|=32;if(this.scalarField.get(r+1,n+1,i+1)<this.isoLevel)o|=64;if(this.scalarField.get(r,n+1,i+1)<this.isoLevel)o|=128;if(o===0||o===255)return;this.i=r;this.j=n;this.k=i;var s=e.EdgeTable[o];if((s&1)>0)this.vertList[0]=this.interpolate(0);if((s&2)>0)this.vertList[1]=this.interpolate(1);if((s&4)>0)this.vertList[2]=this.interpolate(2);if((s&8)>0)this.vertList[3]=this.interpolate(3);if((s&16)>0)this.vertList[4]=this.interpolate(4);if((s&32)>0)this.vertList[5]=this.interpolate(5);if((s&64)>0)this.vertList[6]=this.interpolate(6);if((s&128)>0)this.vertList[7]=this.interpolate(7);if((s&256)>0)this.vertList[8]=this.interpolate(8);if((s&512)>0)this.vertList[9]=this.interpolate(9);if((s&1024)>0)this.vertList[10]=this.interpolate(10);if((s&2048)>0)this.vertList[11]=this.interpolate(11);var a=e.TriTable[o];for(var u=0;u<a.length;u+=3){t.Utils.ChunkedArray.add3(this.triangleBuffer,this.vertList[a[u]],this.vertList[a[u+1]],this.vertList[a[u+2]])}};return r}()})(r=e.MarchingCubes||(e.MarchingCubes={}))})(e=t.Geometry||(t.Geometry={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(t){var e;(function(t){var e=function(){function t(t,e,r){this.i=t|0;this.j=e|0;this.k=r|0}return t}();t.Index=e;var r=function(){function t(t,e){this.a=t;this.b=e}return t}();t.IndexPair=r;t.EdgesXY=[[],[0,3],[0,1],[1,3],[1,2],[0,1,1,2,2,3,0,3],[0,2],[2,3],[2,3],[0,2],[0,1,1,2,2,3,0,3],[1,2],[1,3],[0,1],[0,3],[]];t.EdgesXZ=[[],[0,8],[0,9],[9,8],[9,4],[0,9,9,4,4,8,0,8],[0,4],[4,8],[4,8],[0,4],[0,9,9,4,4,8,0,8],[9,4],[9,8],[0,9],[0,8],[]];t.EdgesYZ=[[],[3,8],[3,11],[11,8],[11,7],[3,11,11,7,7,8,3,8],[3,7],[7,8],[7,8],[3,7],[3,11,11,7,7,8,3,8],[11,7],[11,8],[3,11],[3,8],[]];t.CubeVertices=[new e(0,0,0),new e(1,0,0),new e(1,1,0),new e(0,1,0),new e(0,0,1),new e(1,0,1),new e(1,1,1),new e(0,1,1)];t.CubeEdges=[new r(t.CubeVertices[0],t.CubeVertices[1]),new r(t.CubeVertices[1],t.CubeVertices[2]),new r(t.CubeVertices[2],t.CubeVertices[3]),new r(t.CubeVertices[3],t.CubeVertices[0]),new r(t.CubeVertices[4],t.CubeVertices[5]),new r(t.CubeVertices[5],t.CubeVertices[6]),new r(t.CubeVertices[6],t.CubeVertices[7]),new r(t.CubeVertices[7],t.CubeVertices[4]),new r(t.CubeVertices[0],t.CubeVertices[4]),new r(t.CubeVertices[1],t.CubeVertices[5]),new r(t.CubeVertices[2],t.CubeVertices[6]),new r(t.CubeVertices[3],t.CubeVertices[7])];t.EdgeIdInfo=[{i:0,j:0,k:0,e:0},{i:1,j:0,k:0,e:1},{i:0,j:1,k:0,e:0},{i:0,j:0,k:0,e:1},{i:0,j:0,k:1,e:0},{i:1,j:0,k:1,e:1},{i:0,j:1,k:1,e:0},{i:0,j:0,k:1,e:1},{i:0,j:0,k:0,e:2},{i:1,j:0,k:0,e:2},{i:1,j:1,k:0,e:2},{i:0,j:1,k:0,e:2}];t.EdgeTable=[0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0];t.TriTable=[[],[0,8,3],[0,1,9],[1,8,3,9,8,1],[1,2,10],[0,8,3,1,2,10],[9,2,10,0,2,9],[2,8,3,2,10,8,10,9,8],[3,11,2],[0,11,2,8,11,0],[1,9,0,2,3,11],[1,11,2,1,9,11,9,8,11],[3,10,1,11,10,3],[0,10,1,0,8,10,8,11,10],[3,9,0,3,11,9,11,10,9],[9,8,10,10,8,11],[4,7,8],[4,3,0,7,3,4],[0,1,9,8,4,7],[4,1,9,4,7,1,7,3,1],[1,2,10,8,4,7],[3,4,7,3,0,4,1,2,10],[9,2,10,9,0,2,8,4,7],[2,10,9,2,9,7,2,7,3,7,9,4],[8,4,7,3,11,2],[11,4,7,11,2,4,2,0,4],[9,0,1,8,4,7,2,3,11],[4,7,11,9,4,11,9,11,2,9,2,1],[3,10,1,3,11,10,7,8,4],[1,11,10,1,4,11,1,0,4,7,11,4],[4,7,8,9,0,11,9,11,10,11,0,3],[4,7,11,4,11,9,9,11,10],[9,5,4],[9,5,4,0,8,3],[0,5,4,1,5,0],[8,5,4,8,3,5,3,1,5],[1,2,10,9,5,4],[3,0,8,1,2,10,4,9,5],[5,2,10,5,4,2,4,0,2],[2,10,5,3,2,5,3,5,4,3,4,8],[9,5,4,2,3,11],[0,11,2,0,8,11,4,9,5],[0,5,4,0,1,5,2,3,11],[2,1,5,2,5,8,2,8,11,4,8,5],[10,3,11,10,1,3,9,5,4],[4,9,5,0,8,1,8,10,1,8,11,10],[5,4,0,5,0,11,5,11,10,11,0,3],[5,4,8,5,8,10,10,8,11],[9,7,8,5,7,9],[9,3,0,9,5,3,5,7,3],[0,7,8,0,1,7,1,5,7],[1,5,3,3,5,7],[9,7,8,9,5,7,10,1,2],[10,1,2,9,5,0,5,3,0,5,7,3],[8,0,2,8,2,5,8,5,7,10,5,2],[2,10,5,2,5,3,3,5,7],[7,9,5,7,8,9,3,11,2],[9,5,7,9,7,2,9,2,0,2,7,11],[2,3,11,0,1,8,1,7,8,1,5,7],[11,2,1,11,1,7,7,1,5],[9,5,8,8,5,7,10,1,3,10,3,11],[5,7,0,5,0,9,7,11,0,1,0,10,11,10,0],[11,10,0,11,0,3,10,5,0,8,0,7,5,7,0],[11,10,5,7,11,5],[10,6,5],[0,8,3,5,10,6],[9,0,1,5,10,6],[1,8,3,1,9,8,5,10,6],[1,6,5,2,6,1],[1,6,5,1,2,6,3,0,8],[9,6,5,9,0,6,0,2,6],[5,9,8,5,8,2,5,2,6,3,2,8],[2,3,11,10,6,5],[11,0,8,11,2,0,10,6,5],[0,1,9,2,3,11,5,10,6],[5,10,6,1,9,2,9,11,2,9,8,11],[6,3,11,6,5,3,5,1,3],[0,8,11,0,11,5,0,5,1,5,11,6],[3,11,6,0,3,6,0,6,5,0,5,9],[6,5,9,6,9,11,11,9,8],[5,10,6,4,7,8],[4,3,0,4,7,3,6,5,10],[1,9,0,5,10,6,8,4,7],[10,6,5,1,9,7,1,7,3,7,9,4],[6,1,2,6,5,1,4,7,8],[1,2,5,5,2,6,3,0,4,3,4,7],[8,4,7,9,0,5,0,6,5,0,2,6],[7,3,9,7,9,4,3,2,9,5,9,6,2,6,9],[3,11,2,7,8,4,10,6,5],[5,10,6,4,7,2,4,2,0,2,7,11],[0,1,9,4,7,8,2,3,11,5,10,6],[9,2,1,9,11,2,9,4,11,7,11,4,5,10,6],[8,4,7,3,11,5,3,5,1,5,11,6],[5,1,11,5,11,6,1,0,11,7,11,4,0,4,11],[0,5,9,0,6,5,0,3,6,11,6,3,8,4,7],[6,5,9,6,9,11,4,7,9,7,11,9],[10,4,9,6,4,10],[4,10,6,4,9,10,0,8,3],[10,0,1,10,6,0,6,4,0],[8,3,1,8,1,6,8,6,4,6,1,10],[1,4,9,1,2,4,2,6,4],[3,0,8,1,2,9,2,4,9,2,6,4],[0,2,4,4,2,6],[8,3,2,8,2,4,4,2,6],[10,4,9,10,6,4,11,2,3],[0,8,2,2,8,11,4,9,10,4,10,6],[3,11,2,0,1,6,0,6,4,6,1,10],[6,4,1,6,1,10,4,8,1,2,1,11,8,11,1],[9,6,4,9,3,6,9,1,3,11,6,3],[8,11,1,8,1,0,11,6,1,9,1,4,6,4,1],[3,11,6,3,6,0,0,6,4],[6,4,8,11,6,8],[7,10,6,7,8,10,8,9,10],[0,7,3,0,10,7,0,9,10,6,7,10],[10,6,7,1,10,7,1,7,8,1,8,0],[10,6,7,10,7,1,1,7,3],[1,2,6,1,6,8,1,8,9,8,6,7],[2,6,9,2,9,1,6,7,9,0,9,3,7,3,9],[7,8,0,7,0,6,6,0,2],[7,3,2,6,7,2],[2,3,11,10,6,8,10,8,9,8,6,7],[2,0,7,2,7,11,0,9,7,6,7,10,9,10,7],[1,8,0,1,7,8,1,10,7,6,7,10,2,3,11],[11,2,1,11,1,7,10,6,1,6,7,1],[8,9,6,8,6,7,9,1,6,11,6,3,1,3,6],[0,9,1,11,6,7],[7,8,0,7,0,6,3,11,0,11,6,0],[7,11,6],[7,6,11],[3,0,8,11,7,6],[0,1,9,11,7,6],[8,1,9,8,3,1,11,7,6],[10,1,2,6,11,7],[1,2,10,3,0,8,6,11,7],[2,9,0,2,10,9,6,11,7],[6,11,7,2,10,3,10,8,3,10,9,8],[7,2,3,6,2,7],[7,0,8,7,6,0,6,2,0],[2,7,6,2,3,7,0,1,9],[1,6,2,1,8,6,1,9,8,8,7,6],[10,7,6,10,1,7,1,3,7],[10,7,6,1,7,10,1,8,7,1,0,8],[0,3,7,0,7,10,0,10,9,6,10,7],[7,6,10,7,10,8,8,10,9],[6,8,4,11,8,6],[3,6,11,3,0,6,0,4,6],[8,6,11,8,4,6,9,0,1],[9,4,6,9,6,3,9,3,1,11,3,6],[6,8,4,6,11,8,2,10,1],[1,2,10,3,0,11,0,6,11,0,4,6],[4,11,8,4,6,11,0,2,9,2,10,9],[10,9,3,10,3,2,9,4,3,11,3,6,4,6,3],[8,2,3,8,4,2,4,6,2],[0,4,2,4,6,2],[1,9,0,2,3,4,2,4,6,4,3,8],[1,9,4,1,4,2,2,4,6],[8,1,3,8,6,1,8,4,6,6,10,1],[10,1,0,10,0,6,6,0,4],[4,6,3,4,3,8,6,10,3,0,3,9,10,9,3],[10,9,4,6,10,4],[4,9,5,7,6,11],[0,8,3,4,9,5,11,7,6],[5,0,1,5,4,0,7,6,11],[11,7,6,8,3,4,3,5,4,3,1,5],[9,5,4,10,1,2,7,6,11],[6,11,7,1,2,10,0,8,3,4,9,5],[7,6,11,5,4,10,4,2,10,4,0,2],[3,4,8,3,5,4,3,2,5,10,5,2,11,7,6],[7,2,3,7,6,2,5,4,9],[9,5,4,0,8,6,0,6,2,6,8,7],[3,6,2,3,7,6,1,5,0,5,4,0],[6,2,8,6,8,7,2,1,8,4,8,5,1,5,8],[9,5,4,10,1,6,1,7,6,1,3,7],[1,6,10,1,7,6,1,0,7,8,7,0,9,5,4],[4,0,10,4,10,5,0,3,10,6,10,7,3,7,10],[7,6,10,7,10,8,5,4,10,4,8,10],[6,9,5,6,11,9,11,8,9],[3,6,11,0,6,3,0,5,6,0,9,5],[0,11,8,0,5,11,0,1,5,5,6,11],[6,11,3,6,3,5,5,3,1],[1,2,10,9,5,11,9,11,8,11,5,6],[0,11,3,0,6,11,0,9,6,5,6,9,1,2,10],[11,8,5,11,5,6,8,0,5,10,5,2,0,2,5],[6,11,3,6,3,5,2,10,3,10,5,3],[5,8,9,5,2,8,5,6,2,3,8,2],[9,5,6,9,6,0,0,6,2],[1,5,8,1,8,0,5,6,8,3,8,2,6,2,8],[1,5,6,2,1,6],[1,3,6,1,6,10,3,8,6,5,6,9,8,9,6],[10,1,0,10,0,6,9,5,0,5,6,0],[0,3,8,5,6,10],[10,5,6],[11,5,10,7,5,11],[11,5,10,11,7,5,8,3,0],[5,11,7,5,10,11,1,9,0],[10,7,5,10,11,7,9,8,1,8,3,1],[11,1,2,11,7,1,7,5,1],[0,8,3,1,2,7,1,7,5,7,2,11],[9,7,5,9,2,7,9,0,2,2,11,7],[7,5,2,7,2,11,5,9,2,3,2,8,9,8,2],[2,5,10,2,3,5,3,7,5],[8,2,0,8,5,2,8,7,5,10,2,5],[9,0,1,5,10,3,5,3,7,3,10,2],[9,8,2,9,2,1,8,7,2,10,2,5,7,5,2],[1,3,5,3,7,5],[0,8,7,0,7,1,1,7,5],[9,0,3,9,3,5,5,3,7],[9,8,7,5,9,7],[5,8,4,5,10,8,10,11,8],[5,0,4,5,11,0,5,10,11,11,3,0],[0,1,9,8,4,10,8,10,11,10,4,5],[10,11,4,10,4,5,11,3,4,9,4,1,3,1,4],[2,5,1,2,8,5,2,11,8,4,5,8],[0,4,11,0,11,3,4,5,11,2,11,1,5,1,11],[0,2,5,0,5,9,2,11,5,4,5,8,11,8,5],[9,4,5,2,11,3],[2,5,10,3,5,2,3,4,5,3,8,4],[5,10,2,5,2,4,4,2,0],[3,10,2,3,5,10,3,8,5,4,5,8,0,1,9],[5,10,2,5,2,4,1,9,2,9,4,2],[8,4,5,8,5,3,3,5,1],[0,4,5,1,0,5],[8,4,5,8,5,3,9,0,5,0,3,5],[9,4,5],[4,11,7,4,9,11,9,10,11],[0,8,3,4,9,7,9,11,7,9,10,11],[1,10,11,1,11,4,1,4,0,7,4,11],[3,1,4,3,4,8,1,10,4,7,4,11,10,11,4],[4,11,7,9,11,4,9,2,11,9,1,2],[9,7,4,9,11,7,9,1,11,2,11,1,0,8,3],[11,7,4,11,4,2,2,4,0],[11,7,4,11,4,2,8,3,4,3,2,4],[2,9,10,2,7,9,2,3,7,7,4,9],[9,10,7,9,7,4,10,2,7,8,7,0,2,0,7],[3,7,10,3,10,2,7,4,10,1,10,0,4,0,10],[1,10,2,8,7,4],[4,9,1,4,1,7,7,1,3],[4,9,1,4,1,7,0,8,1,8,7,1],[4,0,3,7,4,3],[4,8,7],[9,10,8,10,11,8],[3,0,9,3,9,11,11,9,10],[0,1,10,0,10,8,8,10,11],[3,1,10,11,3,10],[1,2,11,1,11,9,9,11,8],[3,0,9,3,9,11,1,2,9,2,11,9],[0,2,11,8,0,11],[3,2,11],[2,3,8,2,8,10,10,8,9],[9,10,2,0,9,2],[2,3,8,2,8,10,0,1,8,1,10,8],[1,10,2],[1,3,8,9,1,8],[0,9,1],[0,3,8],[]]})(e=t.MarchingCubes||(t.MarchingCubes={}))})(e=t.Geometry||(t.Geometry={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){var r;(function(r){"use strict";var n=function(){function e(e){t.Utils.extend(this,e,{exactBoundary:false,boundaryDelta:{dx:1.5,dy:1.5,dz:1.5},probeRadius:1.4,atomRadii:function(){return 1},density:1.1,interactive:false,smoothingIterations:1});if(this.exactBoundary)this.boundaryDelta={dx:0,dy:0,dz:0};if(this.density<.05)this.density=.05}return e}();var i=function(){function r(t,e){this.inputParameters=t;this.ctx=e;this.minX=Number.MAX_VALUE;this.minY=Number.MAX_VALUE;this.minZ=Number.MAX_VALUE;this.maxX=-Number.MAX_VALUE;this.maxY=-Number.MAX_VALUE;this.maxZ=-Number.MAX_VALUE;this.nX=0;this.nY=0;this.nZ=0;this.dX=.1;this.dY=.1;this.dZ=.1;this.field=new Float32Array(0);this.distanceField=new Float32Array(0);this.proximityMap=new Int32Array(0);this.minIndex={i:0,j:0,k:0};this.maxIndex={i:0,j:0,k:0};this.parameters=new n(t.parameters);var r=t.positions;this.x=r.x;this.y=r.y;this.z=r.z;this.atomIndices=t.atomIndices;if(this.parameters.density>=.99){this.vdwScaleFactor=1.000000001}else{this.vdwScaleFactor=1+(1-this.parameters.density*this.parameters.density)}}r.prototype.findBounds=function(){for(var t=0,e=this.atomIndices;t<e.length;t++){var r=e[t];var n=this.parameters.exactBoundary?0:this.vdwScaleFactor*this.parameters.atomRadius(r)+this.parameters.probeRadius,i=this.x[r],o=this.y[r],s=this.z[r];if(n<0)continue;this.minX=Math.min(this.minX,i-n);this.minY=Math.min(this.minY,o-n);this.minZ=Math.min(this.minZ,s-n);this.maxX=Math.max(this.maxX,i+n);this.maxY=Math.max(this.maxY,o+n);this.maxZ=Math.max(this.maxZ,s+n)}if(this.minX===Number.MAX_VALUE){this.minX=this.minY=this.minZ=-1;this.maxX=this.maxY=this.maxZ=1}this.minX-=this.parameters.boundaryDelta.dx;this.minY-=this.parameters.boundaryDelta.dy;this.minZ-=this.parameters.boundaryDelta.dz;this.maxX+=this.parameters.boundaryDelta.dx;this.maxY+=this.parameters.boundaryDelta.dy;this.maxZ+=this.parameters.boundaryDelta.dz;this.nX=Math.floor((this.maxX-this.minX)*this.parameters.density);this.nY=Math.floor((this.maxY-this.minY)*this.parameters.density);this.nZ=Math.floor((this.maxZ-this.minZ)*this.parameters.density);this.nX=Math.min(this.nX,333);this.nY=Math.min(this.nY,333);this.nZ=Math.min(this.nZ,333);this.dX=(this.maxX-this.minX)/(this.nX-1);this.dY=(this.maxY-this.minY)/(this.nY-1);this.dZ=(this.maxZ-this.minZ)/(this.nZ-1)};r.prototype.initData=function(){var t=this.nX*this.nY*this.nZ;this.field=new Float32Array(t);this.distanceField=new Float32Array(t);this.proximityMap=new Int32Array(t);var e=Number.POSITIVE_INFINITY;for(var r=0,n=this.proximityMap.length;r<n;r++){this.distanceField[r]=e;this.proximityMap[r]=-1}};r.prototype.updateMinIndex=function(t,e,r){this.minIndex.i=Math.max(Math.floor((t-this.minX)/this.dX)|0,0);this.minIndex.j=Math.max(Math.floor((e-this.minY)/this.dY)|0,0);this.minIndex.k=Math.max(Math.floor((r-this.minZ)/this.dZ)|0,0)};r.prototype.updateMaxIndex=function(t,e,r){this.maxIndex.i=Math.min(Math.ceil((t-this.minX)/this.dX)|0,this.nX);this.maxIndex.j=Math.min(Math.ceil((e-this.minY)/this.dY)|0,this.nY);this.maxIndex.k=Math.min(Math.ceil((r-this.minZ)/this.dZ)|0,this.nZ)};r.prototype.addBall=function(t,e){var r=e*e;var n=this.x[t],i=this.y[t],o=this.z[t];this.updateMinIndex(n-e,i-e,o-e);this.updateMaxIndex(n+e,i+e,o+e);var s=this.minIndex.i,a=this.minIndex.j,u=this.minIndex.k;var c=this.maxIndex.i,f=this.maxIndex.j,l=this.maxIndex.k;n=this.minX-n;i=this.minY-i;o=this.minZ-o;for(var h=u;h<l;h++){var d=o+h*this.dZ,p=d*d,v=h*this.nY;for(var m=a;m<f;m++){var g=i+m*this.dY,y=p+g*g,b=this.nX*(v+m);for(var _=s;_<c;_++){var w=n+_*this.dX,C=y+w*w,x=b+_;var I=r/(1e-6+C)-1;if(C<this.distanceField[x]){this.proximityMap[x]=t;this.distanceField[x]=C}if(I>0){this.field[x]+=I}}}}};r.prototype.processChunks=function(){return u(this,void 0,void 0,function(){var e,r,n,i,o,s,a;return c(this,function(u){switch(u.label){case 0:e=1e4;r=t.Utils.PerformanceMonitor.currentTime();return[4,this.ctx.updateProgress("Creating field...",true)];case 1:u.sent();n=0,i=this.atomIndices.length;u.label=2;case 2:if(!(n<i))return[3,5];o=this.atomIndices[n];s=this.vdwScaleFactor*this.parameters.atomRadius(o)+this.parameters.probeRadius;if(s>=0){this.addBall(o,s)}if(!((n+1)%e===0))return[3,4];a=t.Utils.PerformanceMonitor.currentTime();if(!(a-r>t.Computation.UpdateProgressDelta))return[3,4];r=a;return[4,this.ctx.updateProgress("Creating field...",true,n,i)];case 3:u.sent();u.label=4;case 4:n++;return[3,2];case 5:return[2]}})})};r.prototype.finish=function(){var r=e.LinearAlgebra.Matrix4.zero();e.LinearAlgebra.Matrix4.fromTranslation(r,[this.minX,this.minY,this.minZ]);r[0]=this.dX;r[5]=this.dY;r[10]=this.dZ;var n={data:{scalarField:new t.Formats.Density.Field3DZYX(this.field,[this.nX,this.nY,this.nZ]),annotationField:this.parameters.interactive?new t.Formats.Density.Field3DZYX(this.proximityMap,[this.nX,this.nY,this.nZ]):void 0,isoLevel:.05},bottomLeft:e.LinearAlgebra.Vector3.fromValues(this.minX,this.minY,this.minZ),topRight:e.LinearAlgebra.Vector3.fromValues(this.maxX,this.maxY,this.maxZ),transform:r,inputParameters:this.inputParameters,parameters:this.parameters};this.distanceField=null;this.proximityMap=null;return n};r.prototype.run=function(){return u(this,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.ctx.updateProgress("Initializing...")];case 1:t.sent();this.findBounds();this.initData();return[4,this.processChunks()];case 2:t.sent();return[4,this.ctx.updateProgress("Finalizing...",void 0,this.atomIndices.length,this.atomIndices.length)];case 3:t.sent();return[2,this.finish()]}})})};return r}();function o(e){var r=this;return t.computation(function(t){return u(r,void 0,void 0,function(){var r;return c(this,function(n){switch(n.label){case 0:r=new i(e,t);return[4,r.run()];case 1:return[2,n.sent()]}})})})}r.createMolecularIsoFieldAsync=o;function s(r){var n=this;return t.computation(function(t){return u(n,void 0,void 0,function(){var n,i,s,a;return c(this,function(u){switch(u.label){case 0:return[4,o(r).run(t)];case 1:n=u.sent();return[4,e.MarchingCubes.compute(n.data).run(t)];case 2:i=u.sent();return[4,e.Surface.transform(i,n.transform).run(t)];case 3:i=u.sent();s=r.parameters&&r.parameters.smoothingIterations||1;a=1;if(r.parameters&&r.parameters.density<1){a=2/r.parameters.density}return[4,e.Surface.laplacianSmooth(i,s,a).run(t)];case 4:i=u.sent();return[2,{surface:i,usedParameters:n.parameters}]}})})})}r.computeMolecularSurfaceAsync=s})(r=e.MolecularSurface||(e.MolecularSurface={}))})(e=t.Geometry||(t.Geometry={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){"use strict";var r=t.Utils.DataTable;var n=function(){function e(e){this.id=e;this.map=t.Utils.FastMap.create()}e.prototype.add=function(e,r,n,i){if(i===void 0){i=true}var o=this.map.get(e);if(o!==void 0){var s=o.get(r);if(s===void 0){o.set(r,n)}}else{var a=t.Utils.FastMap.create();a.set(r,n);this.map.set(e,a)}if(i)this.add(r,e,n,false)};return e}();e.ComponentBondInfoEntry=n;var i=function(){function e(){this.entries=t.Utils.FastMap.create()}e.prototype.newEntry=function(t){var e=new n(t);this.entries.set(t,e);return e};return e}();e.ComponentBondInfo=i;var o=function(){function t(t,e,r){this.asymId=t;this.seqNumber=e;this.insCode=r}t.areEqual=function(t,e,r,n,i){return t.asymId===r[e]&&t.seqNumber===n[e]&&t.insCode===i[e]};t.compare=function(t,e){if(t.asymId===e.asymId){if(t.seqNumber===e.seqNumber){if(t.insCode===e.insCode)return 0;if(t.insCode===void 0)return-1;if(e.insCode===void 0)return 1;return t.insCode<e.insCode?-1:1}return t.seqNumber<e.seqNumber?-1:1}return t.asymId<e.asymId?-1:1};t.compareResidue=function(t,e,r,n,i){if(t.asymId===r[e]){if(t.seqNumber===n[e]){if(t.insCode===i[e])return 0;if(t.insCode===void 0)return-1;if(i[e]===void 0)return 1;return t.insCode<i[e]?-1:1}return t.seqNumber<n[e]?-1:1}return t.asymId<r[e]?-1:1};return t}();e.PolyResidueIdentifier=o;var s=function(){function t(t,e,r,n){if(n===void 0){n={}}this.type=t;this.startResidueId=e;this.endResidueId=r;this.info=n;this.startResidueIndex=-1;this.endResidueIndex=-1}Object.defineProperty(t.prototype,"length",{get:function(){return this.endResidueIndex-this.startResidueIndex},enumerable:true,configurable:true});return t}();e.SecondaryStructureElement=s;var a=function(){function t(t,e,r,n,i){this.spacegroupName=t;this.cellSize=e;this.cellAngles=r;this.toFracTransform=n;this.isNonStandardCrytalFrame=i}return t}();e.SymmetryInfo=a;var u=function(){function e(t){this.entries=t;this._residuePairIndex=void 0;this._atomIndex=void 0}e._resKey=function(t,e){if(t<e)return t+"-"+e;return e+"-"+t};e.prototype.getResiduePairIndex=function(){if(this._residuePairIndex)return this._residuePairIndex;this._residuePairIndex=t.Utils.FastMap.create();for(var r=0,n=this.entries;r<n.length;r++){var i=n[r];var o=i.partners;var s=o.length;for(var a=0;a<s-1;a++){for(var u=a+a;u<s;u++){var c=e._resKey(o[a].residueIndex,o[u].residueIndex);if(this._residuePairIndex.has(c)){this._residuePairIndex.get(c).push(i)}else{this._residuePairIndex.set(c,[i])}}}}return this._residuePairIndex};e.prototype.getAtomIndex=function(){if(this._atomIndex)return this._atomIndex;this._atomIndex=t.Utils.FastMap.create();for(var e=0,r=this.entries;e<r.length;e++){var n=r[e];for(var i=0,o=n.partners;i<o.length;i++){var s=o[i];var a=s.atomIndex;if(this._atomIndex.has(a)){this._atomIndex.get(a).push(n)}else{this._atomIndex.set(a,[n])}}}return this._atomIndex};e.prototype.getResidueEntries=function(t,r){return this.getResiduePairIndex().get(e._resKey(t,r))||e._emptyEntry};e.prototype.getAtomEntries=function(t){return this.getAtomIndex().get(t)||e._emptyEntry};e._emptyEntry=[];return e}();e.StructConn=u;var c=function(){function t(t,e,r){this.id=t;this.name=e;this.operator=r}return t}();e.AssemblyOperator=c;var f=function(){function t(t,e){this.operators=t;this.asymIds=e}return t}();e.AssemblyGenEntry=f;var l=function(){function t(t){this.name=t;this.gens=[]}return t}();e.AssemblyGen=l;var h=function(){function t(t,e){this.operators=t;this.assemblies=e}return t}();e.AssemblyInfo=h;var d;(function(t){var e=r.typedColumn(Int32Array);var n=r.typedColumn(Float32Array);var i=r.stringColumn;var o=r.stringNullColumn;t.Positions={x:n,y:n,z:n};t.Atoms={id:e,altLoc:i,residueIndex:e,chainIndex:e,entityIndex:e,name:i,elementSymbol:i,occupancy:n,tempFactor:n,authName:i,rowIndex:e};t.Residues={name:i,seqNumber:e,asymId:i,authName:i,authSeqNumber:e,authAsymId:i,insCode:o,entityId:i,isHet:r.typedColumn(Int8Array),atomStartIndex:e,atomEndIndex:e,chainIndex:e,entityIndex:e,secondaryStructureIndex:e};t.Chains={asymId:i,entityId:i,authAsymId:i,atomStartIndex:e,atomEndIndex:e,residueStartIndex:e,residueEndIndex:e,entityIndex:e,sourceChainIndex:void 0,operatorIndex:void 0};t.Entities={entityId:i,type:r.customColumn(),atomStartIndex:e,atomEndIndex:e,residueStartIndex:e,residueEndIndex:e,chainStartIndex:e,chainEndIndex:e};t.Bonds={atomAIndex:e,atomBIndex:e,type:r.typedColumn(Int8Array)};t.ModifiedResidues={asymId:i,seqNumber:e,insCode:o,parent:i,details:o}})(d=e.Tables||(e.Tables={}));var p=function(){function e(t,e,r){this.matrix=t;this.id=e;this.isIdentity=r}e.prototype.apply=function(e){t.Geometry.LinearAlgebra.Vector3.transformMat4(e,e,this.matrix)};e.applyToModelUnsafe=function(e,r){var n=t.Geometry.LinearAlgebra.Vector3.zero();var i=r.positions,o=i.x,s=i.y,a=i.z;for(var u=0,c=r.positions.count;u<c;u++){n[0]=o[u];n[1]=s[u];n[2]=a[u];t.Geometry.LinearAlgebra.Vector3.transformMat4(n,n,e);o[u]=n[0];s[u]=n[1];a[u]=n[2]}};return e}();e.Operator=p;var v;(function(r){function n(t,e,r){if(r===void 0){r={}}return{id:t,models:e,properties:r}}r.create=n;var i;(function(r){function n(r){var n=t.Utils.extend({},r);var i=void 0;Object.defineProperty(n,"queryContext",{enumerable:true,configurable:false,get:function(){if(i)return i;i=e.Query.Context.ofStructure(n);return i}});return n}r.create=n;var i;(function(t){t[t["File"]=0]="File";t[t["Computed"]=1]="Computed"})(i=r.Source||(r.Source={}));function o(e,r,i){var o=e.positions,s=o.x,a=o.y,u=o.z;var c=e.positions.getBuilder(e.positions.count).seal();var f=c.x,l=c.y,h=c.z;var d=t.Geometry.LinearAlgebra.Vector3.zero();for(var p=0,v=e.positions.count;p<v;p++){i(r,s[p],a[p],u[p],d);f[p]=d[0];l[p]=d[1];h[p]=d[2]}return n({id:e.id,modelId:e.modelId,data:e.data,positions:c,parent:e.parent,source:e.source,operators:e.operators})}r.withTransformedXYZ=o})(i=r.Model||(r.Model={}))})(v=e.Molecule||(e.Molecule={}))})(e=t.Structure||(t.Structure={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2017 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){"use strict";function r(t){return t>=0&&t<=5}e.isBondTypeCovalent=r;var n={H:0,h:0,D:0,d:0,T:0,t:0,He:2,HE:2,he:2,Li:3,LI:3,li:3,Be:4,BE:4,be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,f:9,Ne:10,NE:10,ne:10,Na:11,NA:11,na:11,Mg:12,MG:12,mg:12,Al:13,AL:13,al:13,Si:14,SI:14,si:14,P:15,p:15,S:16,s:16,Cl:17,CL:17,cl:17,Ar:18,AR:18,ar:18,K:19,k:19,Ca:20,CA:20,ca:20,Sc:21,SC:21,sc:21,Ti:22,TI:22,ti:22,V:23,v:23,Cr:24,CR:24,cr:24,Mn:25,MN:25,mn:25,Fe:26,FE:26,fe:26,Co:27,CO:27,co:27,Ni:28,NI:28,ni:28,Cu:29,CU:29,cu:29,Zn:30,ZN:30,zn:30,Ga:31,GA:31,ga:31,Ge:32,GE:32,ge:32,As:33,AS:33,as:33,Se:34,SE:34,se:34,Br:35,BR:35,br:35,Kr:36,KR:36,kr:36,Rb:37,RB:37,rb:37,Sr:38,SR:38,sr:38,Y:39,y:39,Zr:40,ZR:40,zr:40,Nb:41,NB:41,nb:41,Mo:42,MO:42,mo:42,Tc:43,TC:43,tc:43,Ru:44,RU:44,ru:44,Rh:45,RH:45,rh:45,Pd:46,PD:46,pd:46,Ag:47,AG:47,ag:47,Cd:48,CD:48,cd:48,In:49,IN:49,in:49,Sn:50,SN:50,sn:50,Sb:51,SB:51,sb:51,Te:52,TE:52,te:52,I:53,i:53,Xe:54,XE:54,xe:54,Cs:55,CS:55,cs:55,Ba:56,BA:56,ba:56,La:57,LA:57,la:57,Ce:58,CE:58,ce:58,Pr:59,PR:59,pr:59,Nd:60,ND:60,nd:60,Pm:61,PM:61,pm:61,Sm:62,SM:62,sm:62,Eu:63,EU:63,eu:63,Gd:64,GD:64,gd:64,Tb:65,TB:65,tb:65,Dy:66,DY:66,dy:66,Ho:67,HO:67,ho:67,Er:68,ER:68,er:68,Tm:69,TM:69,tm:69,Yb:70,YB:70,yb:70,Lu:71,LU:71,lu:71,Hf:72,HF:72,hf:72,Ta:73,TA:73,ta:73,W:74,w:74,Re:75,RE:75,re:75,Os:76,OS:76,os:76,Ir:77,IR:77,ir:77,Pt:78,PT:78,pt:78,Au:79,AU:79,au:79,Hg:80,HG:80,hg:80,Tl:81,TL:81,tl:81,Pb:82,PB:82,pb:82,Bi:83,BI:83,bi:83,Po:84,PO:84,po:84,At:85,AT:85,at:85,Rn:86,RN:86,rn:86,Fr:87,FR:87,fr:87,Ra:88,RA:88,ra:88,Ac:89,AC:89,ac:89,Th:90,TH:90,th:90,Pa:91,PA:91,pa:91,U:92,u:92,Np:93,NP:93,np:93,Pu:94,PU:94,pu:94,Am:95,AM:95,am:95,Cm:96,CM:96,cm:96,Bk:97,BK:97,bk:97,Cf:98,CF:98,cf:98,Es:99,ES:99,es:99,Fm:100,FM:100,fm:100,Md:101,MD:101,md:101,No:102,NO:102,no:102,Lr:103,LR:103,lr:103,Rf:104,RF:104,rf:104,Db:105,DB:105,db:105,Sg:106,SG:106,sg:106,Bh:107,BH:107,bh:107,Hs:108,HS:108,hs:108,Mt:109,MT:109,mt:109};var i={0:1.42,1:1.42,3:2.7,4:2.7,6:1.75,7:1.6,8:1.52,11:2.7,12:2.7,13:2.7,14:1.9,15:1.9,16:1.9,17:1.8,19:2.7,20:2.7,21:2.7,22:2.7,23:2.7,24:2.7,25:2.7,26:2.7,27:2.7,28:2.7,29:2.7,30:2.7,31:2.7,33:2.68,37:2.7,38:2.7,39:2.7,40:2.7,41:2.7,42:2.7,43:2.7,44:2.7,45:2.7,46:2.7,47:2.7,48:2.7,49:2.7,50:2.7,55:2.7,56:2.7,57:2.7,58:2.7,59:2.7,60:2.7,61:2.7,62:2.7,63:2.7,64:2.7,65:2.7,66:2.7,67:2.7,68:2.7,69:2.7,70:2.7,71:2.7,72:2.7,73:2.7,74:2.7,75:2.7,76:2.7,77:2.7,78:2.7,79:2.7,80:2.7,81:2.7,82:2.7,83:2.7,87:2.7,88:2.7,89:2.7,90:2.7,91:2.7,92:2.7,93:2.7,94:2.7,95:2.7,96:2.7,97:2.7,98:2.7,99:2.7,100:2.7,101:2.7,102:2.7,103:2.7,104:2.7,105:2.7,106:2.7,107:2.7,108:2.7,109:2.88};var o={0:.8,20:1.31,27:1.3,35:1.3,44:1.05,54:1,60:1.84,72:1.88,84:1.75,85:1.56,86:1.76,98:1.6,99:1.68,100:1.63,112:1.55,113:1.59,114:1.36,129:1.45,144:1.6,170:1.4,180:1.55,202:2.4,222:2.24,224:1.91,225:1.98,243:2.02,269:2,293:1.9,480:2.3,512:2.3,544:2.3,612:2.1,629:1.54,665:1,813:2.6,854:2.27,894:1.93,896:2.1,937:2.05,938:2.06,981:1.62,1258:2.68,1309:2.33,1484:1,1763:2.14,1823:2.48,1882:2.1,1944:1.72,2380:2.34,3367:2.44,3733:2.11,3819:2.6,3821:2.36,4736:2.75,5724:2.73,5959:2.63,6519:2.84,6750:2.87,8991:2.81};var s=2.001;var a=function(){var e=["LI","NA","K","RB","CS","FR","BE","MG","CA","SR","BA","RA","AL","GA","IN","SN","TL","PB","BI","SC","TI","V","CR","MN","FE","CO","NI","CU","ZN","Y","ZR","NB","MO","TC","RU","RH","PD","AG","CD","LA","HF","TA","W","RE","OS","IR","PT","AU","HG","AC","RF","DB","SG","BH","HS","MT","CE","PR","ND","PM","SM","EU","GD","TB","DY","HO","ER","TM","YB","LU","TH","PA","U","NP","PU","AM","CM","BK","CF","ES","FM","MD","NO","LR"];var r=t.Utils.FastSet.create();for(var i=0,o=e;i<o.length;i++){var s=o[i];r.add(n[s])}return r}();function u(t,e){if(t<e)return(t+e)*(t+e+1)/2+e;else return(t+e)*(t+e+1)/2+t}function c(t){var e=n[t];if(e===void 0)return-1;return e}function f(t,e){if(t<0||e<0)return-1;var r=o[u(t,e)];if(r===void 0)return-1;return r}function l(t){if(t<0)return s;var e=i[t];if(e===void 0)return s;return e}var h=n["H"];function d(t){return t===h}function p(t){var e=n[t];if(e===void 0)return false;return a.has(e)}function v(r,n){var i=r.data.bonds.input;if(n.length===r.data.atoms.count)return i;var o=t.Utils.Mask.ofIndices(r.data.atoms.count,n);var s=i.atomAIndex,a=i.atomBIndex,u=i.type;var c=0;for(var f=0,l=i.count;f<l;f++){if(!o.has(s[f])||!o.has(a[f]))continue;c++}var h=t.Utils.DataTable.ofDefinition(e.Tables.Bonds,c);var d=h.atomAIndex,v=h.atomBIndex,m=h.type;var g=r.data.atoms.elementSymbol;var y=0;for(var f=0,l=i.count;f<l;f++){var b=s[f],_=a[f];if(!o.has(b)||!o.has(_))continue;d[y]=b;v[y]=_;var w=p(g[b])||p(g[_]);m[y]=w?6:u[f];y++}return h}var m=t.Utils.ChunkedArray.add;function g(t,e){var r=t.model,n=t.mask,i=t.atomA,o=t.atomB,s=t.type;var a=r.data.residues,u=a.atomStartIndex,c=a.atomEndIndex,f=a.name;var l=r.data.atoms,h=l.name,d=l.altLoc,v=l.elementSymbol;var g=r.data.bonds.component.entries.get(f[e]).map;var y=u[e],b=c[e];for(var _=y;_<b-1;_++){if(!n.has(_))continue;var w=g.get(h[_]);if(!w)continue;var C=d[_];var x=p(v[_]);for(var I=_+1;I<b;I++){if(!n.has(I))continue;var S=d[I];if(C&&S&&C!==S)continue;var A=w.get(h[I]);if(A===void 0)continue;var k=x||p(v[I]);m(i,_);m(o,I);m(s,k?6:A)}}}function y(e,r,n){var i=3;var o=e.data.bonds,s=o.structConn,u=o.component;var h=e.positions,p=h.x,v=h.y,y=h.z;var b=e.data.atoms,_=b.elementSymbol,w=b.residueIndex,C=b.altLoc;var x=e.data.residues.name;var I=e.queryContext.lookup3d();var S=t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},r.length*1.33|0,1);var A=t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},r.length*1.33|0,1);var k=t.Utils.ChunkedArray.create(function(t){return new Uint8Array(t)},r.length*1.33|0,1);var E=t.Utils.Mask.ofIndices(e.data.atoms.count,r);var P={model:e,mask:E,atomA:S,atomB:A,type:k};var T=-1;var F=false;for(var M=0,D=r;M<D.length;M++){var N=D[M];var R=w[N];if(!n.forceCompute&&R!==T){F=!!u&&u.entries.has(x[R]);if(F){g(P,R)}}T=R;var q=c(_[N]);var U=I(p[N],v[N],y[N],i),O=U.elements,B=U.count,L=U.squaredDistances;var z=d(q);var j=l(q);var V=C[N];var X=a.has(q);var Y=n.forceCompute?void 0:s&&s.getAtomEntries(N);for(var H=0;H<B;H++){var G=O[H];if(G<=N||!E.has(G))continue;var Z=C[G];if(V&&Z&&V!==Z)continue;var Q=w[G];if(R===Q&&F)continue;var W=c(_[G]);var K=d(W);if(z&&K)continue;var J=Math.sqrt(L[H]);if(J===0)continue;if(Y){var $=false;for(var tt=0,et=Y;tt<et.length;tt++){var rt=et[tt];for(var nt=0,it=rt.partners;nt<it.length;nt++){var ot=it[nt];if(ot.atomIndex===G){m(S,N);m(A,G);m(k,rt.bondType);$=true;break}}if($)break}if($)continue}if(z||K){if(J<n.maxHbondLength){m(S,N);m(A,G);m(k,1)}continue}var st=f(q,W);var at=st>0?st:W<0?j:Math.max(j,l(W));var ut=a.has(W);if(J<=at){m(S,N);m(A,G);m(k,X||ut?6:1)}}}var ct=t.Utils.DataTable.builder(S.elementCount);ct.addRawColumn("atomAIndex",function(t){return new Int32Array(t)},t.Utils.ChunkedArray.compact(S));ct.addRawColumn("atomBIndex",function(t){return new Int32Array(t)},t.Utils.ChunkedArray.compact(A));ct.addRawColumn("type",function(t){return new Uint8Array(t)},t.Utils.ChunkedArray.compact(k));var ft=ct.seal();return ft}function b(t,e,r){if(t.data.bonds.input)return v(t,e);return y(t,e,{maxHbondLength:r&&r.maxHbondLength||1.15,forceCompute:!!(r&&r.forceCompute)})}e.computeBonds=b})(e=t.Structure||(t.Structure={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){"use strict";var r=t.Geometry.LinearAlgebra.Matrix4;var n=t.Geometry.LinearAlgebra.Vector4;var i=function(){function t(t){this.info=t;this.temp=r.zero();this.tempV=new Float64Array(4);if(o.Spacegroup[t.spacegroupName]===void 0){throw"'"+t.spacegroupName+"' is not a spacegroup recognized by the library."}this.space=this.getSpace();this.operators=this.getOperators()}Object.defineProperty(t.prototype,"operatorCount",{get:function(){return this.operators.length},enumerable:true,configurable:true});t.prototype.getOperatorMatrix=function(t,e,n,i,o){this.tempV[0]=e;this.tempV[1]=n;this.tempV[2]=i;r.fromTranslation(this.temp,this.tempV);r.mul(o,r.mul(o,r.mul(o,this.space.fromFrac,this.temp),this.operators[t]),this.space.toFrac);return o};t.prototype.getSpace=function(){var t=this.info.toFracTransform,e=r.zero();r.invert(e,t);return{toFrac:t,fromFrac:e,baseX:n.transform(n.zero(),n.fromValues(1,0,0,1),t),baseY:n.transform(n.zero(),n.fromValues(0,1,0,1),t),baseZ:n.transform(n.zero(),n.fromValues(0,0,1,1),t)}};t.getOperator=function(t){var e=o.Transform[t[0]],n=o.Transform[t[1]],i=o.Transform[t[2]];return r.ofRows([e,n,i,[0,0,0,1]])};t.prototype.getOperators=function(){var e=o.Group[o.Spacegroup[this.info.spacegroupName]];return e.map(function(e){return t.getOperator(o.Operator[e])})};return t}();e.Spacegroup=i;var o;(function(t){t.Transform=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[-1,0,0,0],[0,-1,0,0],[0,0,-1,0],[0,1,0,.5],[1,0,0,.5],[-1,0,0,.5],[0,0,1,.5],[0,-1,0,.5],[0,0,-1,.5],[1,0,0,.25],[0,-1,0,.25],[0,0,1,.25],[-1,0,0,.25],[0,1,0,.25],[0,-1,0,.75],[0,0,1,.75],[0,1,0,.75],[1,0,0,.75],[-1,0,0,.75],[0,0,-1,.25],[0,0,-1,.75],[1,-1,0,0],[-1,1,0,0],[0,0,1,.333333333333333],[0,0,1,.666666666666667],[1,0,0,.666666666666667],[0,1,0,.333333333333333],[0,-1,0,.666666666666667],[1,-1,0,.333333333333333],[-1,1,0,.666666666666667],[-1,0,0,.333333333333333],[1,0,0,.333333333333333],[0,1,0,.666666666666667],[0,-1,0,.333333333333333],[1,-1,0,.666666666666667],[-1,1,0,.333333333333333],[-1,0,0,.666666666666667],[0,0,-1,.333333333333333],[0,0,-1,.666666666666667],[0,0,1,.833333333333333],[0,0,1,.166666666666667],[0,0,-1,.833333333333333],[0,0,-1,.166666666666667]];t.Operator=[[0,1,2],[3,4,5],[3,1,5],[3,6,5],[7,6,2],[8,6,5],[0,4,2],[0,4,9],[7,10,2],[7,10,9],[0,10,2],[8,10,5],[3,1,11],[3,6,11],[0,10,9],[8,6,11],[3,4,2],[0,4,5],[3,4,9],[7,10,5],[8,4,9],[8,10,9],[8,10,2],[0,6,9],[3,10,9],[0,10,11],[7,1,9],[8,1,11],[7,4,11],[7,6,9],[7,10,11],[3,10,2],[8,1,5],[0,4,11],[3,1,2],[3,1,9],[7,4,2],[8,1,2],[8,1,9],[3,6,9],[7,4,9],[8,6,2],[8,6,9],[3,6,2],[12,13,14],[15,16,14],[12,17,18],[15,19,18],[20,13,18],[21,16,18],[20,17,14],[21,19,14],[0,1,5],[8,10,11],[7,6,11],[7,6,5],[8,4,2],[7,4,5],[7,1,5],[7,1,11],[0,10,5],[0,1,11],[0,6,11],[0,6,5],[3,10,11],[8,4,11],[15,13,22],[12,16,22],[15,17,23],[12,19,23],[21,13,23],[20,16,23],[21,17,22],[20,19,22],[4,0,2],[1,3,2],[4,0,14],[1,3,18],[4,0,9],[1,3,9],[4,0,18],[1,3,14],[10,7,9],[6,8,9],[4,7,14],[6,3,18],[10,0,18],[1,8,14],[1,3,5],[4,0,5],[6,8,11],[10,7,11],[1,3,11],[4,0,11],[10,7,2],[6,8,2],[3,10,22],[7,1,23],[8,4,23],[0,6,22],[1,0,5],[4,3,5],[1,0,23],[4,3,22],[10,7,14],[6,8,18],[8,6,22],[7,10,23],[4,3,11],[1,0,11],[1,0,22],[4,3,23],[10,7,18],[6,8,14],[8,6,23],[7,10,22],[6,7,11],[10,8,11],[8,1,23],[0,10,22],[3,6,22],[7,4,23],[4,3,2],[1,0,2],[10,8,2],[6,7,2],[4,3,9],[1,0,9],[10,8,9],[6,7,9],[4,8,14],[6,0,18],[10,3,18],[1,7,14],[4,8,18],[6,0,14],[10,3,14],[1,7,18],[6,7,5],[10,8,5],[6,8,5],[10,7,5],[8,1,22],[0,10,23],[3,6,23],[7,4,22],[4,24,2],[25,3,2],[4,24,26],[25,3,27],[4,24,27],[25,3,26],[28,29,26],[30,31,26],[32,33,26],[34,35,27],[36,37,27],[38,39,27],[2,0,1],[1,2,0],[1,25,5],[24,0,5],[39,36,40],[35,38,40],[37,34,40],[33,30,41],[29,32,41],[31,28,41],[5,3,4],[4,5,3],[25,1,5],[0,24,5],[24,4,5],[3,25,5],[4,3,41],[25,1,40],[24,4,41],[3,25,40],[4,3,40],[25,1,41],[24,4,40],[3,25,41],[35,34,40],[37,36,40],[39,38,40],[29,28,41],[31,30,41],[33,32,41],[3,5,4],[5,4,3],[25,1,2],[0,24,2],[24,4,2],[3,25,2],[25,1,9],[0,24,9],[24,4,9],[3,25,9],[30,33,26],[32,29,26],[28,31,26],[36,39,27],[38,35,27],[34,37,27],[0,2,1],[2,1,0],[30,33,42],[32,29,42],[28,31,42],[36,39,43],[38,35,43],[34,37,43],[7,9,6],[9,6,7],[25,1,11],[0,24,11],[24,4,11],[3,25,11],[35,34,44],[37,36,44],[39,38,44],[29,28,45],[31,30,45],[33,32,45],[8,11,10],[11,10,8],[1,25,2],[24,0,2],[1,25,42],[24,0,43],[1,25,43],[24,0,42],[1,25,27],[24,0,26],[1,25,26],[24,0,27],[1,25,9],[24,0,9],[4,24,5],[25,3,5],[4,24,11],[25,3,11],[1,0,40],[4,3,44],[0,24,45],[1,0,41],[4,3,45],[0,24,44],[0,24,40],[0,24,41],[2,3,4],[5,3,1],[5,0,4],[4,2,3],[1,5,3],[4,5,0],[2,7,6],[2,8,10],[5,8,6],[5,7,10],[1,9,7],[4,9,8],[1,11,8],[4,11,7],[9,0,6],[9,3,10],[11,3,6],[11,0,10],[6,2,7],[10,2,8],[6,5,8],[10,5,7],[9,7,1],[9,8,4],[11,8,1],[11,7,4],[6,9,0],[10,9,3],[6,11,3],[10,11,0],[9,7,6],[9,8,10],[11,8,6],[11,7,10],[6,9,7],[10,9,8],[6,11,8],[10,11,7],[2,3,10],[5,8,1],[11,0,4],[10,2,3],[1,5,8],[4,11,0],[5,0,1],[2,0,4],[2,3,1],[1,5,0],[4,2,0],[1,2,3],[11,8,10],[11,7,6],[9,7,10],[9,8,6],[10,11,8],[6,11,7],[10,9,7],[6,9,8],[5,8,10],[5,7,6],[2,7,10],[2,8,6],[4,11,8],[1,11,7],[4,9,7],[1,9,8],[11,3,10],[11,0,6],[9,0,10],[9,3,6],[10,5,8],[6,5,7],[10,2,7],[6,2,8],[11,8,4],[11,7,1],[9,7,4],[9,8,1],[10,11,3],[6,11,0],[10,9,0],[6,9,3],[22,15,13],[22,12,16],[14,12,13],[14,15,16],[13,22,15],[16,22,12],[13,14,12],[16,14,15],[22,21,17],[22,20,19],[14,20,17],[14,21,19],[13,23,21],[16,23,20],[13,18,20],[16,18,21],[23,15,17],[23,12,19],[18,12,17],[18,15,19],[17,22,21],[19,22,20],[17,14,20],[19,14,21],[23,21,13],[23,20,16],[18,20,13],[18,21,16],[17,23,15],[19,23,12],[17,18,12],[19,18,15],[5,0,6],[2,7,4],[9,3,1],[6,5,0],[4,2,7],[1,9,3],[0,2,4],[3,2,1],[0,5,1],[2,1,3],[2,4,0],[5,1,0],[7,9,10],[8,9,6],[7,11,6],[9,6,8],[9,10,7],[11,6,7],[1,7,11],[4,8,11],[1,8,9],[4,7,9],[0,9,10],[3,9,6],[3,11,10],[0,11,6],[2,6,8],[2,10,7],[5,6,7],[5,10,8],[6,0,11],[10,3,11],[6,3,9],[10,0,9],[7,2,10],[8,2,6],[8,5,10],[7,5,6],[9,1,8],[9,4,7],[11,1,7],[11,4,8],[7,9,4],[8,9,1],[8,11,4],[7,11,1],[9,6,3],[9,10,0],[11,6,0],[11,10,3],[19,12,23],[13,15,22],[16,21,18],[17,20,14],[20,14,17],[21,18,16],[15,22,13],[12,23,19],[18,16,21],[14,17,20],[23,19,12],[22,13,15],[19,20,22],[13,21,23],[16,15,14],[17,12,18],[20,18,13],[21,14,19],[15,23,17],[12,22,16],[18,19,15],[14,13,12],[23,16,20],[22,17,21],[16,12,22],[17,15,23],[19,21,14],[13,20,18],[12,14,13],[15,18,19],[21,22,17],[20,23,16],[14,16,15],[18,17,12],[22,19,20],[23,13,21],[16,20,23],[17,21,22],[19,15,18],[13,12,14],[12,18,17],[15,14,16],[21,23,13],[20,22,19],[14,19,21],[18,13,20],[22,16,12],[23,17,15],[19,12,22],[17,21,23],[16,15,18],[13,20,14],[20,14,13],[15,18,16],[21,23,17],[12,22,19],[18,16,15],[14,13,20],[22,19,12],[23,17,21],[3,2,4],[3,5,1],[0,5,4],[2,4,3],[5,1,3],[5,4,0],[1,7,9],[4,8,9],[1,8,11],[4,7,11],[0,9,6],[3,9,10],[3,11,6],[0,11,10],[2,6,7],[2,10,8],[5,6,8],[5,10,7],[6,0,9],[10,3,9],[6,3,11],[10,0,11],[7,2,6],[8,2,10],[8,5,6],[7,5,10],[9,1,7],[9,4,8],[11,1,8],[11,4,7],[7,9,1],[8,9,4],[8,11,1],[7,11,4],[9,6,0],[9,10,3],[11,6,3],[11,10,0],[8,9,10],[8,11,6],[7,11,10],[9,10,8],[11,6,8],[11,10,7],[6,0,2],[10,3,2],[6,3,5],[10,0,5],[7,2,1],[8,2,4],[8,5,1],[7,5,4],[9,1,0],[9,4,3],[11,1,3],[11,4,0],[1,7,2],[4,8,2],[1,8,5],[4,7,5],[0,9,1],[3,9,4],[3,11,1],[0,11,4],[2,6,0],[2,10,3],[5,6,3],[5,10,0],[0,2,6],[3,2,10],[3,5,6],[0,5,10],[2,1,7],[2,4,8],[5,1,8],[5,4,7],[16,12,14],[13,21,18],[19,15,23],[17,20,22],[12,14,16],[21,18,13],[15,23,19],[20,22,17],[14,16,12],[18,13,21],[23,19,15],[22,17,20],[19,20,18],[17,15,14],[16,21,22],[13,12,23],[20,18,19],[15,14,17],[21,22,16],[12,23,13],[18,19,20],[14,17,15],[22,16,21],[23,13,12],[6,0,5],[10,3,5],[6,3,2],[10,0,2],[7,2,4],[8,2,1],[8,5,4],[7,5,1],[9,1,3],[9,4,0],[11,1,0],[11,4,3],[1,7,5],[4,8,5],[1,8,2],[4,7,2],[0,9,4],[3,9,1],[3,11,4],[0,11,1],[2,6,3],[2,10,0],[5,6,0],[5,10,3],[0,2,10],[3,2,6],[3,5,10],[0,5,6],[2,1,8],[2,4,7],[5,1,7],[5,4,8],[21,17,23],[20,16,22],[12,13,18],[15,19,14],[23,21,17],[22,20,16],[18,12,13],[14,15,19],[17,23,21],[16,22,20],[13,18,12],[19,14,15],[21,13,22],[20,19,23],[12,17,14],[15,16,18],[23,15,13],[22,12,19],[18,20,17],[14,21,16],[17,22,15],[16,23,12],[13,14,20],[19,18,21],[15,17,22],[12,16,23],[20,13,14],[21,19,18],[22,21,13],[23,20,19],[14,12,17],[18,15,16],[13,23,15],[19,22,12],[17,18,20],[16,14,21],[15,13,23],[12,19,22],[20,17,18],[21,16,14],[22,15,17],[23,12,16],[14,20,13],[18,21,19],[13,22,21],[19,23,20],[17,14,12],[16,18,15],[6,5,3],[4,9,3],[9,3,4],[5,7,4],[4,5,7],[5,3,6]];t.Group=[[0],[0,1],[0,2],[0,3],[0,2,4,5],[0,6],[0,7],[0,6,4,8],[0,7,4,9],[0,6,2,1],[0,3,1,10],[0,6,2,1,4,8,5,11],[0,12,1,7],[0,1,13,14],[0,12,1,7,4,15,11,9],[0,16,2,17],[0,18,12,17],[0,16,5,19],[0,20,13,19],[0,18,12,17,4,21,15,19],[0,16,2,17,4,22,5,19],[0,16,2,17,23,24,13,25,26,20,27,28,4,22,5,19],[0,16,17,2,29,21,30,15],[0,20,13,19,29,31,32,33],[0,16,6,34],[0,18,7,34],[0,16,7,35],[0,16,36,37],[0,18,36,38],[0,16,14,39],[0,20,40,34],[0,16,8,41],[0,18,8,42],[0,16,9,42],[0,16,6,34,4,22,8,41],[0,18,7,34,4,21,9,41],[0,16,7,35,4,22,9,42],[0,16,6,34,23,24,14,39],[0,16,10,43,23,24,7,35],[0,16,36,37,23,24,9,42],[0,16,8,41,23,24,40,38],[0,16,6,34,23,24,14,39,26,20,40,38,4,22,8,41],[0,16,44,45,23,24,46,47,26,20,48,49,4,22,50,51],[0,16,6,34,29,21,9,42],[0,16,8,41,29,21,7,35],[0,16,36,37,29,21,14,39],[0,16,2,17,1,52,6,34],[0,16,2,17,53,54,9,42],[0,16,12,33,1,52,7,35],[0,16,2,17,11,55,8,41],[0,56,2,57,1,58,6,37],[0,56,15,25,1,58,9,39],[0,20,27,17,1,59,40,34],[0,56,12,28,1,58,7,38],[0,16,5,19,1,52,8,41],[0,22,13,28,1,55,14,38],[0,18,13,60,1,61,14,43],[0,16,15,30,1,52,9,42],[0,16,5,19,11,55,6,34],[0,21,12,19,1,54,7,41],[0,20,13,19,1,59,14,41],[0,20,3,30,1,59,10,42],[0,18,12,17,1,61,7,34,4,21,15,19,11,54,9,41],[0,24,13,17,1,62,14,34,4,20,27,19,11,59,40,41],[0,16,2,17,1,52,6,34,4,22,5,19,11,55,8,41],[0,16,12,33,1,52,7,35,4,22,15,30,11,55,9,42],[0,31,3,17,1,63,10,34,4,56,32,19,11,58,36,41],[0,22,2,19,64,59,14,38,4,16,5,17,65,62,40,39],[0,16,2,17,1,52,6,34,23,24,13,25,64,62,14,39,26,20,27,28,65,59,40,38,4,22,5,19,11,55,8,41],[0,16,2,17,66,67,44,45,23,24,13,25,68,69,46,47,26,20,27,28,70,71,48,49,4,22,5,19,72,73,50,51],[0,16,2,17,1,52,6,34,29,21,15,30,53,54,9,42],[0,16,5,19,1,52,8,41,29,21,12,33,53,54,7,35],[0,20,13,19,1,59,14,41,29,31,32,33,53,63,36,35],[0,31,3,17,1,63,10,34,29,20,27,30,53,59,40,42],[0,16,74,75],[0,18,76,77],[0,16,78,79],[0,18,80,81],[0,16,74,75,29,21,82,83],[0,21,84,85,29,16,86,87],[0,16,88,89],[0,16,88,89,29,21,90,91],[0,16,74,75,1,52,88,89],[0,16,78,79,1,52,92,93],[0,16,94,95,11,55,88,89],[0,16,82,83,53,54,88,89],[0,16,74,75,1,52,88,89,29,21,82,83,53,54,90,91],[0,21,84,85,96,97,88,91,29,16,86,87,98,99,90,89],[0,16,74,75,2,17,100,101],[0,16,94,95,5,19,100,101],[0,18,76,77,2,33,102,103],[0,18,104,105,106,107,100,108],[0,16,78,79,2,17,109,108],[0,16,82,83,15,30,100,101],[0,18,80,81,2,33,110,111],[0,18,112,113,114,115,100,108],[0,16,74,75,2,17,100,101,29,21,82,83,15,30,116,117],[0,21,84,85,118,119,116,101,29,16,86,87,120,121,100,117],[0,16,74,75,6,34,122,123],[0,16,74,75,8,41,124,125],[0,16,78,79,7,35,122,123],[0,16,82,83,9,42,122,123],[0,16,74,75,7,35,126,127],[0,16,74,75,9,42,128,129],[0,16,78,79,6,34,126,127],[0,16,78,79,8,41,128,129],[0,16,74,75,6,34,122,123,29,21,82,83,9,42,128,129],[0,16,74,75,7,35,126,127,29,21,82,83,8,41,124,125],[0,21,84,85,6,42,130,131,29,16,86,87,9,34,132,133],[0,21,84,85,7,41,134,135,29,16,86,87,8,35,136,137],[0,16,89,88,2,17,122,123],[0,16,89,88,12,33,126,127],[0,16,89,88,5,19,124,125],[0,16,89,88,15,30,128,129],[0,16,88,89,6,34,100,101],[0,16,89,88,7,35,109,108],[0,16,89,88,8,41,138,139],[0,16,89,88,9,42,116,117],[0,16,89,88,6,34,100,101,29,21,91,90,9,42,116,117],[0,16,89,88,7,35,109,108,29,21,91,90,8,41,138,139],[0,16,89,88,2,17,122,123,29,21,91,90,15,30,128,129],[0,16,89,88,118,121,132,131,29,21,91,90,120,119,130,133],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127],[0,16,74,75,2,17,100,101,11,55,140,141,8,41,124,125],[0,16,74,75,2,17,100,101,53,54,90,91,9,42,128,129],[0,16,74,75,5,19,138,139,1,52,88,89,8,41,124,125],[0,16,74,75,15,30,116,117,1,52,88,89,9,42,128,129],[0,16,94,95,5,19,100,101,11,55,88,89,6,34,124,125],[0,16,94,95,15,30,109,108,11,55,88,89,7,35,128,129],[0,16,78,79,2,17,109,108,1,52,92,93,6,34,126,127],[0,16,78,79,12,33,100,101,1,52,92,93,7,35,122,123],[0,16,82,83,12,33,138,139,53,54,88,89,8,41,126,127],[0,16,82,83,2,17,116,117,53,54,88,89,9,42,122,123],[0,16,78,79,5,19,116,117,1,52,92,93,8,41,128,129],[0,16,82,83,15,30,100,101,1,52,90,91,9,42,122,123],[0,16,82,83,15,30,100,101,53,54,88,89,6,34,128,129],[0,16,82,83,5,19,109,108,53,54,88,89,7,35,124,125],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123,29,21,82,83,15,30,116,117,53,54,90,91,9,42,128,129],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127,29,21,82,83,5,19,138,139,53,54,90,91,8,41,124,125],[0,21,84,85,118,119,116,101,96,97,88,91,9,34,132,133,29,16,86,87,120,121,100,117,98,99,90,89,6,42,130,131],[0,21,84,85,142,143,138,108,96,97,88,91,8,35,136,137,29,16,86,87,144,145,109,139,98,99,90,89,7,41,134,135],[0,146,147],[0,148,149],[0,150,151],[0,146,147,152,153,154,155,156,157],[0,158,159],[0,146,147,1,160,161],[0,146,147,1,160,161,152,153,154,162,163,164,155,156,157,165,166,167],[0,158,159,1,168,169],[0,146,147,101,170,171],[0,146,147,100,172,173],[0,148,149,174,175,171],[0,148,149,100,176,177],[0,150,151,178,179,171],[0,150,151,100,180,181],[0,146,147,100,172,173,152,153,154,182,183,184,155,156,157,185,186,187],[0,158,159,101,188,189],[0,146,147,122,190,191],[0,146,147,123,192,193],[0,146,147,126,194,195],[0,146,147,127,196,197],[0,146,147,122,190,191,152,153,154,198,199,200,155,156,157,201,202,203],[0,158,159,123,204,205],[0,146,147,126,194,195,152,153,154,206,207,208,155,156,157,209,210,211],[0,158,159,129,212,213],[0,146,147,101,170,171,1,160,161,123,192,193],[0,146,147,108,214,215,1,160,161,127,196,197],[0,146,147,100,172,173,1,160,161,122,190,191],[0,146,147,109,216,217,1,160,161,126,194,195],[0,146,147,100,172,173,1,160,161,122,190,191,152,153,154,182,183,184,162,163,164,198,199,200,155,156,157,185,186,187,165,166,167,201,202,203],[0,158,159,101,188,189,1,168,169,123,204,205],[0,146,147,109,216,217,1,160,161,126,194,195,152,153,154,218,219,220,162,163,164,206,207,208,155,156,157,221,222,223,165,166,167,209,210,211],[0,158,159,117,224,225,1,168,169,129,212,213],[0,146,147,16,226,227],[0,148,149,18,228,229],[0,150,151,18,230,231],[0,150,151,16,232,233],[0,148,149,16,234,235],[0,146,147,18,236,237],[0,146,147,52,238,239],[0,146,147,16,226,227,1,160,161,52,238,239],[0,146,147,18,236,237,1,160,161,61,240,241],[0,146,147,16,226,227,100,172,173,101,170,171],[0,148,149,18,228,229,242,172,181,243,214,244],[0,150,151,18,230,231,245,172,177,246,214,247],[0,150,151,16,232,233,245,172,177,174,170,248],[0,148,149,16,234,235,242,172,181,178,170,249],[0,146,147,18,236,237,100,172,173,108,214,215],[0,146,147,16,226,227,122,190,191,123,192,193],[0,146,147,16,226,227,126,194,195,127,196,197],[0,146,147,18,236,237,126,194,195,123,192,193],[0,146,147,18,236,237,122,190,191,127,196,197],[0,146,147,52,238,239,122,190,191,101,170,171],[0,146,147,61,240,241,126,194,195,101,170,171],[0,146,147,52,238,239,100,172,173,123,192,193],[0,146,147,61,240,241,100,172,173,127,196,197],[0,146,147,16,226,227,100,172,173,101,170,171,1,160,161,52,239,238,122,190,191,123,192,193],[0,146,147,16,226,227,109,216,217,108,214,215,1,160,161,52,239,238,126,194,195,127,196,197],[0,146,147,18,236,237,109,216,217,101,170,171,1,160,161,61,241,240,126,194,195,123,192,193],[0,146,147,18,236,237,100,172,173,108,214,215,1,160,161,61,241,240,122,190,191,127,196,197],[0,16,2,17,158,250,251,252,159,253,254,255],[0,16,2,17,158,250,251,252,159,253,254,255,23,24,13,25,256,257,258,259,260,261,262,263,26,20,27,28,264,265,266,267,268,269,270,271,4,22,5,19,272,273,274,275,276,277,278,279],[0,16,2,17,158,250,251,252,159,253,254,255,29,21,15,30,280,281,282,283,284,285,286,287],[0,20,13,19,158,273,266,259,159,261,278,271],[0,20,13,19,158,273,266,259,159,261,278,271,29,31,32,33,280,288,289,290,284,291,292,293],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299],[0,16,2,17,158,250,251,252,159,253,254,255,53,54,9,42,300,301,302,303,304,305,306,307],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,23,24,13,25,256,257,258,259,260,261,262,263,64,62,14,39,308,309,310,311,312,313,314,315,26,20,27,28,264,265,266,267,268,269,270,271,65,59,40,38,316,317,318,319,320,321,322,323,4,22,5,19,272,273,274,275,276,277,278,279,11,55,8,41,324,325,326,327,328,329,330,331],[0,16,2,17,158,250,251,252,159,253,254,255,66,67,44,45,332,333,334,335,336,337,338,339,23,24,13,25,256,257,258,259,260,261,262,263,68,69,46,47,340,341,342,343,344,345,346,347,26,20,27,28,264,265,266,267,268,269,270,271,70,71,48,49,348,349,350,351,352,353,354,355,4,22,5,19,272,273,274,275,276,277,278,279,72,73,50,51,356,357,358,359,360,361,362,363],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,29,21,15,30,280,281,282,283,284,285,286,287,53,54,9,42,300,301,302,303,304,305,306,307],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323,29,31,32,33,280,288,289,290,284,291,292,293,53,63,36,35,300,364,365,366,304,367,368,369],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225],[0,20,13,19,158,273,266,259,159,261,278,271,450,415,440,429,454,431,420,445,458,447,436,425],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,23,24,13,25,256,257,258,259,260,261,262,263,480,481,482,483,484,485,486,487,488,489,490,491,26,20,27,28,264,265,266,267,268,269,270,271,492,493,494,495,496,497,498,499,500,501,502,503,4,22,5,19,272,273,274,275,276,277,278,279,125,124,140,141,504,505,506,507,508,509,510,511],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,29,21,15,30,280,281,282,283,284,285,286,287,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517,23,24,13,25,256,257,258,259,260,261,262,263,518,519,520,521,522,523,524,525,526,527,528,529,26,20,27,28,264,265,266,267,268,269,270,271,530,531,532,533,534,535,536,537,538,539,540,541,4,22,5,19,272,273,274,275,276,277,278,279,127,126,92,93,542,543,544,545,546,547,548,549],[0,20,13,19,158,273,266,259,159,261,278,271,550,551,552,553,554,555,556,557,558,559,560,561,29,31,32,33,280,288,289,290,284,291,292,293,562,563,564,565,566,567,568,569,570,571,572,573],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,64,62,14,39,308,309,310,311,312,313,314,315,481,480,483,482,486,487,484,485,491,490,489,488,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,65,59,40,38,316,317,318,319,320,321,322,323,493,492,495,494,498,499,496,497,503,502,501,500,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413,11,55,8,41,324,325,326,327,328,329,330,331,124,125,141,140,506,507,504,505,511,510,509,508],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213,23,24,13,25,256,257,258,259,260,261,262,263,574,575,576,577,578,579,580,581,582,583,584,585,64,62,14,39,308,309,310,311,312,313,314,315,519,518,521,520,524,525,522,523,529,528,527,526,26,20,27,28,264,265,266,267,268,269,270,271,586,587,588,589,590,591,592,593,594,595,596,597,65,59,40,38,316,317,318,319,320,321,322,323,531,530,533,532,536,537,534,535,541,540,539,538,4,22,5,19,272,273,274,275,276,277,278,279,109,108,79,78,598,599,600,601,602,603,604,605,11,55,8,41,324,325,326,327,328,329,330,331,126,127,93,92,544,545,542,543,549,548,547,546],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,66,69,50,49,332,349,342,359,336,361,354,347,493,123,483,140,498,507,204,485,503,490,509,205,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,68,67,48,51,340,357,334,351,344,353,362,339,124,480,89,494,506,499,484,474,511,478,501,488,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,70,73,46,45,348,333,358,343,352,345,338,363,122,492,141,482,475,487,496,505,479,510,489,500,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,72,71,44,47,356,341,350,335,360,337,346,355,481,125,495,88,486,476,504,497,491,502,477,508],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,606,607,608,609,610,611,612,613,614,615,616,617,531,129,521,92,536,545,212,523,541,528,547,213,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,618,619,620,621,622,623,624,625,626,627,628,629,126,518,91,532,544,537,522,512,549,516,539,526,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,630,631,632,633,634,635,636,637,638,639,640,641,128,530,93,520,513,525,534,543,517,548,527,538,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,642,643,644,645,646,647,648,649,650,651,652,653,519,127,533,90,524,514,542,535,529,540,515,546],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,1,59,14,41,168,325,318,311,169,313,330,323,551,550,553,552,556,557,554,555,561,560,559,558,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425,53,63,36,35,300,364,365,366,304,367,368,369,563,562,565,564,568,569,566,567,573,572,571,570],[0,16],[0,18],[0,16,26,20],[0,2,23,13],[0,3,4,32],[0,2,29,15],[0,3,29,27],[0,52],[0,63],[0,52,26,59],[0,63,26,54],[0,52,16,1],[0,18,1,61],[0,52,16,1,26,59,20,65],[0,31,1,63],[0,1,24,62],[0,31,1,63,26,21,65,54],[0,2,57,56],[0,60,3,16],[0,22,57,3],[0,2,28,20],[0,17,13,24],[0,20,19,13,4,24,17,27],[0,22,57,3,4,16,60,32],[0,22,57,3,23,20,30,12,26,24,33,15,4,16,60,32],[0,22,57,3,29,18,27,25],[0,22,3,57,1,55,10,37],[0,22,385,396,3,57,109,117],[0,22,57,3,159,279,654,655,158,274,656,657,29,18,25,27,284,658,262,269,280,659,257,267]];t.Spacegroup={"P 1":0,"P -1":1,"P 1 2 1":2,"P 1 21 1":3,"C 1 2 1":4,"P 1 m 1":5,"P 1 c 1":6,"C 1 m 1":7,"C 1 c 1":8,"P 1 2/m 1":9,"P 1 21/m 1":10,"C 1 2/m 1":11,"P 1 2/c 1":12,"P 1 21/c 1":13,"C 1 2/c 1":14,"P 2 2 2":15,"P 2 2 21":16,"P 21 21 2":17,"P 21 21 21":18,"C 2 2 21":19,"C 2 2 2":20,"F 2 2 2":21,"I 2 2 2":22,"I 21 21 21":23,"P m m 2":24,"P m c 21":25,"P c c 2":26,"P m a 2":27,"P c a 21":28,"P n c 2":29,"P m n 21":30,"P b a 2":31,"P n a 21":32,"P n n 2":33,"C m m 2":34,"C m c 21":35,"C c c 2":36,"A m m 2":37,"A b m 2":38,"A m a 2":39,"A b a 2":40,"F m m 2":41,"F d d 2":42,"I m m 2":43,"I b a 2":44,"I m a 2":45,"P 2/m 2/m 2/m":46,"P m m m":46,"P 2/n 2/n 2/n":47,"P n n n":47,"P 2/c 2/c 2/m":48,"P c c m":48,"P 2/b 2/a 2/n":49,"P b a n":49,"P 21/m 2/m 2/a":50,"P m m a":50,"P 2/n 21/n 2/a":51,"P n n a":51,"P 2/m 2/n 21/a":52,"P m n a":52,"P 21/c 2/c 2/a":53,"P c c a":53,"P 21/b 21/a 2/m":54,"P b a m":54,"P 21/c 21/c 2/n":55,"P c c n":55,"P 2/b 21/c 21/m":56,"P b c m":56,"P 21/n 21/n 2/m":57,"P n n m":57,"P 21/m 21/m 2/n":58,"P m m n":58,"P 21/b 2/c 21/n":59,"P b c n":59,"P 21/b 21/c 21/a":60,"P b c a":60,"P 21/n 21/m 21/a":61,"P n m a":61,"C 2/m 2/c 21/m":62,"C m c m":62,"C 2/m 2/c 21/a":63,"C m c a":63,"C 2/m 2/m 2/m":64,"C m m m":64,"C 2/c 2/c 2/m":65,"C c c m":65,"C 2/m 2/m 2/a":66,"C m m a":66,"C 2/c 2/c 2/a":67,"C c c a":67,"F 2/m 2/m 2/m":68,"F m m m":68,"F 2/d 2/d 2/d":69,"F d d d":69,"I 2/m 2/m 2/m":70,"I m m m":70,"I 2/b 2/a 2/m":71,"I b a m":71,"I 21/b 21/c 21/a":72,"I b c a":72,"I 21/m 21/m 21/a":73,"I m m a":73,"P 4":74,"P 41":75,"P 42":76,"P 43":77,"I 4":78,"I 41":79,"P -4":80,"I -4":81,"P 4/m":82,"P 42/m":83,"P 4/n":84,"P 42/n":85,"I 4/m":86,"I 41/a":87,"P 4 2 2":88,"P 4 21 2":89,"P 41 2 2":90,"P 41 21 2":91,"P 42 2 2":92,"P 42 21 2":93,"P 43 2 2":94,"P 43 21 2":95,"I 4 2 2":96,"I 41 2 2":97,"P 4 m m":98,"P 4 b m":99,"P 42 c m":100,"P 42 n m":101,"P 4 c c":102,"P 4 n c":103,"P 42 m c":104,"P 42 b c":105,"I 4 m m":106,"I 4 c m":107,"I 41 m d":108,"I 41 c d":109,"P -4 2 m":110,"P -4 2 c":111,"P -4 21 m":112,"P -4 21 c":113,"P -4 m 2":114,"P -4 c 2":115,"P -4 b 2":116,"P -4 n 2":117,"I -4 m 2":118,"I -4 c 2":119,"I -4 2 m":120,"I -4 2 d":121,"P 4/m 2/m 2/m":122,"P4/m m m":122,"P 4/m 2/c 2/c":123,"P4/m c c":123,"P 4/n 2/b 2/m":124,"P4/n b m":124,"P 4/n 2/n 2/c":125,"P4/n n c":125,"P 4/m 21/b 2/m":126,"P4/m b m":126,"P 4/m 21/n 2/c":127,"P4/m n c":127,"P 4/n 21/m 2/m":128,"P4/n m m":128,"P 4/n 2/c 2/c":129,"P4/n c c":129,"P 42/m 2/m 2/c":130,"P42/m m c":130,"P 42/m 2/c 2/m":131,"P42/m c m":131,"P 42/n 2/b 2/c":132,"P42/n b c":132,"P 42/n 2/n 2/m":133,"P42/n n m":133,"P 42/m 21/b 2/c":134,"P42/m b c":134,"P 42/m 21/n 2/m":135,"P42/m n m":135,"P 42/n 21/m 2/c":136,"P42/n m c":136,"P 42/n 21/c 2/m":137,"P42/n c m":137,"I 4/m 2/m 2/m":138,"I4/m m m":138,"I 4/m 2/c 2/m":139,"I4/m c m":139,"I 41/a 2/m 2/d":140,"I41/a m d":140,"I 41/a 2/c 2/d":141,"I41/a c d":141,"P 3":142,"P 31":143,"P 32":144,"H 3":145,"R 3":146,"P -3":147,"H -3":148,"R -3":149,"P 3 1 2":150,"P 3 2 1":151,"P 31 1 2":152,"P 31 2 1":153,"P 32 1 2":154,"P 32 2 1":155,"H 3 2":156,"R 3 2":157,"P 3 m 1":158,"P 3 1 m":159,"P 3 c 1":160,"P 3 1 c":161,"H 3 m":162,"R 3 m":163,"H 3 c":164,"R 3 c":165,"P -3 1 2/m":166,"P -3 1 m":166,"P -3 1 2/c":167,"P -3 1 c":167,"P -3 2/m 1":168,"P -3 m 1":168,"P -3 2/c 1":169,"P -3 c 1":169,"H -3 2/m":170,"H -3 m":170,"R -3 2/m":171,"R -3 m":171,"H -3 2/c":172,"H -3 c":172,"R -3 2/c":173,"R -3 c":173,"P 6":174,"P 61":175,"P 65":176,"P 62":177,"P 64":178,"P 63":179,"P -6":180,"P 6/m":181,"P 63/m":182,"P 6 2 2":183,"P 61 2 2":184,"P 65 2 2":185,"P 62 2 2":186,"P 64 2 2":187,"P 63 2 2":188,"P 6 m m":189,"P 6 c c":190,"P 63 c m":191,"P 63 m c":192,"P -6 m 2":193,"P -6 c 2":194,"P -6 2 m":195,"P -6 2 c":196,"P 6/m 2/m 2/m":197,"P 6/m m m":197,"P 6/m 2/c 2/c":198,"P 6/m c c":198,"P 63/m 2/c 2/m":199,"P 63/m c m":199,"P 63/m 2/m 2/c":200,"P 63/m m c":200,"P 2 3":201,"F 2 3":202,"I 2 3":203,"P 21 3":204,"I 21 3":205,"P 2/m -3":206,"P m -3":206,"P 2/n -3":207,"P n -3":207,"F 2/m -3":208,"F m -3":208,"F 2/d -3":209,"F d -3":209,"I 2/m -3":210,"I m -3":210,"P 21/a -3":211,"P a -3":211,"I 21/a -3":212,"I a -3":212,"P 4 3 2":213,"P 42 3 2":214,"F 4 3 2":215,"F 41 3 2":216,"I 4 3 2":217,"P 43 3 2":218,"P 41 3 2":219,"I 41 3 2":220,"P -4 3 m":221,"F -4 3 m":222,"I -4 3 m":223,"P -4 3 n":224,"F -4 3 c":225,"I -4 3 d":226,"P 4/m -3 2/m":227,"P m -3 m":227,"P 4/n -3 2/n":228,"P n -3 n":228,"P 42/m -3 2/n":229,"P m -3 n":229,"P 42/n -3 2/m":230,"P n -3 m":230,"F 4/m -3 2/m":231,"F m -3 m":231,"F 4/m -3 2/c":232,"F m -3 c":232,"F 41/d -3 2/m":233,"F d -3 m":233,"F 41/d -3 2/c":234,"F d -3 c":234,"I 4/m -3 2/m":235,"I m -3 m":235,"I 41/a -3 2/d":236,"I a -3 d":236,"P 1 1 2":237,"P 1 1 21":238,"B 1 1 2":239,"B 2":239,"A 1 2 1":240,"C 1 21 1":241,"I 1 2 1":242,"I 2":242,"I 1 21 1":243,"P 1 1 m":244,"P 1 1 b":245,"B 1 1 m":246,"B 1 1 b":247,"P 1 1 2/m":248,"P 1 1 21/m":249,"B 1 1 2/m":250,"P 1 1 2/b":251,"P 1 1 21/b":252,"B 1 1 2/b":253,"P 21 2 2":254,"P 2 21 2":255,"P 21 21 2 (a)":256,"P 21 2 21":257,"P 2 21 21":258,"C 2 2 21a)":259,"C 2 2 2a":260,"F 2 2 2a":261,"I 2 2 2a":262,"P 21/m 21/m 2/n a":263,"P 42 21 2a":264,"I 2 3a":265}})(o=e.SpacegroupTables||(e.SpacegroupTables={}))})(e=t.Structure||(t.Structure={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){"use strict";var r=t.Utils.DataTable;var n;(function(n){var i=t.Geometry.LinearAlgebra.Matrix4;var o=t.Geometry.LinearAlgebra.Vector3;function s(t,e){var r=t.x,n=t.y,i=t.z;var s=o.zero();for(var a=0,u=e;a<u.length;a++){var c=u[a];s[0]+=r[c];s[1]+=n[c];s[2]+=i[c]}var l=e.length>0?e.length:1;s[0]/=l;s[1]/=l;s[2]/=l;var h=0;for(var d=0,p=e;d<p.length;d++){var c=p[d];h=Math.max(f(c,s,t),h)}return{center:s,radius:Math.sqrt(h)}}function a(t,e,r){return o.distance(t,r.center)-(e+r.radius)}function u(t,e,r,n,i,s){s[0]=r.x[e];s[1]=r.y[e];s[2]=r.z[e];o.transformMat4(s,s,n);return a(s,r.r[e],t)<=i}function c(t,e,r){var n=r.x[t]-r.cX[e],i=r.y[t]-r.cY[e],o=r.z[t]-r.cZ[e];return n*n+i*i+o*o}function f(t,e,r){var n=r.x[t]-e[0],i=r.y[t]-e[1],o=r.z[t]-e[2];return n*n+i*i+o*o}function l(t,e,r,n){return{model:t,boundingInfo:e,spacegroup:r,radius:n,transform:i.zero(),transformed:o.zero(),i:0,j:0,k:0,op:0}}function h(t,e){return o.transformMat4(t.transformed,e,t.transform)}function d(t){return p(t.i,t.j,t.k,t.op,i.clone(t.transform))}function p(t,e,r,n,i){return{isIdentity:!t&&!e&&!r&&!n,id:n+1+"_"+(5+t)+(5+e)+(5+r),transform:i}}function v(t,e){var r=true;for(var n=0;n<4;n++){for(var i=0;i<4;i++){var o=e[4*i+n];if(n===i){if(Math.abs(o-1)>1e-7){r=false;break}}else if(Math.abs(o)>1e-7){r=false;break}}if(!r)break}return{isIdentity:r,id:t.toString(),transform:e}}function m(t,e){var n=t.data.atoms,i=t.data.residues,s=t.data.chains,a=t.data.entities,u=t.positions,l=u.x,h=u.y,d=u.z;var p=r.builder(a.count),v=p.addColumn("x",function(t){return new Float64Array(t)}),m=p.addColumn("y",function(t){return new Float64Array(t)}),g=p.addColumn("z",function(t){return new Float64Array(t)}),y=p.addColumn("r",function(t){return new Float64Array(t)}),b=r.builder(s.count),_=b.addColumn("x",function(t){return new Float64Array(t)}),w=b.addColumn("y",function(t){return new Float64Array(t)}),C=b.addColumn("z",function(t){return new Float64Array(t)}),x=b.addColumn("r",function(t){return new Float64Array(t)}),I=r.builder(i.count),S=I.addColumn("x",function(t){return new Float64Array(t)}),A=I.addColumn("y",function(t){return new Float64Array(t)}),k=I.addColumn("z",function(t){return new Float64Array(t)}),E=I.addColumn("r",function(t){return new Float64Array(t)});var P=o.zero(),T=0,F=o.zero(),M=0,D=0,N=o.zero(),R=0,q=o.zero(),U=0,O=o.zero(),B=0;for(var L=0,z=a.count;L<z;L++){o.set(N,0,0,0);for(var j=a.chainStartIndex[L],V=a.chainEndIndex[L];j<V;j++){o.set(q,0,0,0);for(var X=s.residueStartIndex[j],Y=s.residueEndIndex[j];X<Y;X++){o.set(O,0,0,0);for(var H=i.atomStartIndex[X],G=i.atomEndIndex[X];H<G;H++){O[0]+=l[H];O[1]+=h[H];O[2]+=d[H]}o.add(P,P,O);D=i.atomEndIndex[X]-i.atomStartIndex[X];o.add(q,q,O);S[X]=O[0]/D;A[X]=O[1]/D;k[X]=O[2]/D}o.add(N,N,q);D=s.atomEndIndex[j]-s.atomStartIndex[j];_[j]=q[0]/D;w[j]=q[1]/D;C[j]=q[2]/D}D=a.atomEndIndex[L]-a.atomStartIndex[L];v[L]=N[0]/D;m[L]=N[1]/D;g[L]=N[2]/D}P[0]/=n.count;P[1]/=n.count;P[2]/=n.count;for(var Z=0,Q=e;Z<Q.length;Z++){var H=Q[Z];F[0]+=l[H];F[1]+=h[H];F[2]+=d[H]}var W=e.length>0?e.length:1;F[0]/=W;F[1]/=W;F[2]/=W;var K={x:l,y:h,z:d,cX:v,cY:m,cZ:g},J={x:l,y:h,z:d,cX:_,cY:w,cZ:C},$={x:l,y:h,z:d,cX:S,cY:A,cZ:k};for(var L=0,z=a.count;L<z;L++){R=0;for(var j=a.chainStartIndex[L],V=a.chainEndIndex[L];j<V;j++){U=0;for(var X=s.residueStartIndex[j],Y=s.residueEndIndex[j];X<Y;X++){B=0;for(var H=i.atomStartIndex[X],G=i.atomEndIndex[X];H<G;H++){B=Math.max(B,c(H,X,$));U=Math.max(U,c(H,j,J));R=Math.max(R,c(H,L,K));T=Math.max(T,f(H,P,$))}B=Math.sqrt(B);E[X]=B}U=Math.sqrt(U);x[j]=U}R=Math.sqrt(R);y[L]=R}T=Math.sqrt(T);for(var tt=0,et=e;tt<et.length;tt++){var H=et[tt];M=Math.max(M,f(H,F,$))}M=Math.sqrt(M);return{entities:p.seal(),chains:b.seal(),residues:I.seal(),allAtoms:{center:P,radius:T},target:{center:F,radius:M}}}function g(t){var e=t.boundingInfo,r=t.spacegroup;var n=[];t.transform=i.identity();n[0]=d(t);for(var o=-3;o<=3;o++){for(var s=-3;s<=3;s++){for(var u=-3;u<=3;u++){for(var c=o===0&&s===0&&u===0?1:0,f=r.operatorCount;c<f;c++){r.getOperatorMatrix(c,o,s,u,t.transform);t.i=o;t.k=u;t.j=s;t.op=c;var l=h(t,e.allAtoms.center),p=a(l,e.allAtoms.radius,e.target);if(p<t.radius){n[n.length]=d(t)}}}}}return n}function y(e,r){var n=e.boundingInfo,i=e.radius,s=n.target;var a=e.model,c=a.data.residues,f=a.data.chains,l=a.data.entities;var h=t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},c.count,1),d=t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},c.count,1);var p=o.zero(),v=0;var m=0,g=0,y=0;for(var b=0,_=l.count;b<_;b++){v=0;var w=false;for(var C=0,x=r;C<x.length;C++){var I=x[C];for(var S=l.chainStartIndex[b],A=l.chainEndIndex[b];S<A;S++){if(!u(s,S,n.chains,I.transform,i,p))continue;var k=false;for(var E=f.residueStartIndex[S],P=f.residueEndIndex[S];E<P;E++){if(!u(s,E,n.residues,I.transform,i,p))continue;t.Utils.ChunkedArray.add(h,E);t.Utils.ChunkedArray.add(d,v);m+=c.atomEndIndex[E]-c.atomStartIndex[E];k=true}if(k){g+=1;w=true}}v++}if(w){y++}}return{residues:t.Utils.ChunkedArray.compact(h),operators:t.Utils.ChunkedArray.compact(d),atomCount:m,chainCount:g,entityCount:y}}function b(t,e,r,n,i){for(var o=0;o<i;o++){r[o][n]=t[o][e]}}function _(n,i,s){var a=n.data.residues,u=a.chainIndex,c=a.entityIndex,f=a.atomStartIndex,l=a.atomEndIndex,h=n.data.atoms,d=n.positions,p=d.x,v=d.y,m=d.z;var g=r.builder(i.atomCount),y,_,x,I,S=[];var A=r.ofDefinition(e.Tables.Positions,i.atomCount),k=A.x,E=A.y,P=A.z;var T=n.data.entities.getBuilder(i.entityCount),F=T,M=n.data.entities.getRawData(),D=F.getRawData(),N=F.chainStartIndex,R=F.chainEndIndex,q=F.residueStartIndex,U=F.residueEndIndex,O=F.atomStartIndex,B=F.atomEndIndex,L=0;var z=n.data.chains.getBuilder(i.chainCount),j=z,V=n.data.chains.getRawData(),X=j.getRawData(),Y=j.residueStartIndex,H=j.residueEndIndex,G=j.atomStartIndex,Z=j.atomEndIndex,Q=j.asymId,W=j.authAsymId,K=j.entityIndex,J=z.addColumn("sourceChainIndex",function(t){return new Int32Array(t)}),$=z.addColumn("operatorIndex",function(t){return new Int32Array(t)}),tt=0;var et=n.data.residues.getBuilder(i.residues.length),rt=et,nt=n.data.residues.getRawData(),it=rt.getRawData(),ot=rt.atomStartIndex,st=rt.atomEndIndex,at=rt.asymId,ut=rt.authAsymId,ct=rt.chainIndex,ft=rt.entityIndex;for(var lt=0,ht=n.data.atoms.columns;lt<ht.length;lt++){var dt=ht[lt];var pt=g.addColumn(dt.name,dt.creator);if(dt.name==="residueIndex")_=pt;else if(dt.name==="chainIndex")x=pt;else if(dt.name==="entityIndex")I=pt;else if(dt.name==="id")y=pt;else{S[S.length]={src:h[dt.name],target:pt}}}var vt=i.residues,mt=i.operators,gt=t.Geometry.LinearAlgebra.Vector3.zero(),yt=0;var bt=vt[0],_t=u[bt],wt=c[bt],Ct=mt[0],xt,It;b(M,c[bt],D,0,M.length);N[0]=0;q[0]=0;O[0]=0;b(V,u[bt],X,0,V.length);K[0]=0;Y[0]=0;G[0]=0;xt=n.data.chains.asymId[u[bt]];It=n.data.chains.authAsymId[u[bt]];var St=s[mt[0]];if(St&&!St.isIdentity){Q[tt]=n.data.chains.asymId[u[bt]]+"-"+St.id;W[tt]=n.data.chains.authAsymId[u[bt]]+"-"+St.id;J[tt]=u[bt];$[tt]=Ct;xt=Q[tt];It=W[tt]}for(var At=0,kt=vt.length;At<kt;At++){bt=vt[At];var Et=mt[At];St=s[Et];b(nt,bt,it,At,it.length);var Pt=c[bt],Tt=u[bt];var Ft=false;if(Pt!==wt){H[tt]=At;Z[tt]=yt;tt+=1;R[L]=tt;U[L]=At;B[L]=yt;L+=1;b(M,Pt,D,L,M.length);N[L]=tt;q[L]=At;O[L]=yt;Ft=true}else if(Tt!==_t){H[tt]=At;Z[tt]=yt;tt+=1;Ft=true}else if(Et!==Ct){H[tt]=At;Z[tt]=yt;tt+=1;Ft=true}if(Ft){b(V,Tt,X,tt,V.length);K[tt]=L;Y[tt]=At;G[tt]=yt;if(!St.isIdentity){Q[tt]=n.data.chains.asymId[Tt]+"-"+St.id;W[tt]=n.data.chains.authAsymId[Tt]+"-"+St.id}J[tt]=Tt;$[tt]=Et;xt=Q[tt];It=W[tt]}_t=Tt;wt=Pt;Ct=Et;ct[At]=tt;ft[At]=L;ot[At]=yt;at[At]=xt;ut[At]=It;for(var Mt=f[bt],Dt=l[bt];Mt<Dt;Mt++){o.set(gt,p[Mt],v[Mt],m[Mt]);o.transformMat4(gt,gt,St.transform);k[yt]=gt[0];E[yt]=gt[1];P[yt]=gt[2];y[yt]=yt+1;_[yt]=At;x[yt]=tt;I[yt]=L;for(var Nt=0,Rt=S;Nt<Rt.length;Nt++){var pt=Rt[Nt];pt.target[yt]=pt.src[Mt]}yt++}st[At]=yt}R[L]=tt+1;U[L]=vt.length;B[L]=yt;H[tt]=vt.length;Z[tt]=yt;var qt=g.seal(),Ut=et.seal(),Ot=z.seal(),Bt=T.seal();var Lt=C(n,i,Ut);var zt=n.data.bonds.structConn?w(n.data.bonds.structConn,s,i.residues,i.operators,n.data.residues,Ut):void 0;return e.Molecule.Model.create({id:n.id,modelId:n.modelId,data:{atoms:qt,residues:Ut,chains:Ot,entities:Bt,bonds:{structConn:zt,component:n.data.bonds.component},secondaryStructure:Lt},positions:A,parent:n,source:e.Molecule.Model.Source.Computed,operators:s.map(function(t){return new e.Operator(t.transform,t.id,t.isIdentity)})})}function w(r,n,i,o,s,a){var u=r.entries;var c=t.Utils.FastMap.create();for(var f=0,l=n.length;f<l;f++){c.set(n[f].id,f)}var h=t.Utils.FastMap.create();for(var d=0,p=u;d<p.length;d++){var v=p[d];for(var m=0,g=v.partners;m<g.length;m++){var y=g[m];if(!h.has(y.residueIndex)){h.set(y.residueIndex,t.Utils.FastMap.create())}}}for(var f=0,l=i.length;f<l;f++){var b=i[f];if(!h.has(b))continue;h.get(b).set(o[f],f)}var _=s.atomStartIndex;var w=a.atomStartIndex;var C=[];for(var x=0,I=u;x<I.length;x++){var v=I[x];var S=true;for(var A=0,k=v.partners;A<k.length;A++){var y=k[A];if(y.symmetry!=="1_555"){S=false;break}}if(S){var E=function(t,e){var r=true;for(var n=0,i=v.partners;n<i.length;n++){var o=i[n];if(!h.get(o.residueIndex).has(t)){r=false;break}}if(!r)return"continue";C.push({bondType:v.bondType,distance:v.distance,partners:v.partners.map(function(e){var r=h.get(e.residueIndex).get(t);return{residueIndex:r,atomIndex:w[r]+(e.atomIndex-_[e.residueIndex]),symmetry:e.symmetry}})})};for(var P=0,T=n.length;P<T;P++){E(P,T)}}else{var F=[];for(var M=0,D=v.partners;M<D.length;M++){var y=D[M];if(!c.has(y.symmetry))break;var N=c.get(y.symmetry);var R=h.get(y.residueIndex);if(!R.has(N))break;var q=R.get(N);F.push({residueIndex:q,atomIndex:w[q]+(y.atomIndex-_[y.residueIndex]),symmetry:y.symmetry})}if(F.length===v.partners.length){C.push({bondType:v.bondType,distance:v.distance,partners:F})}}}return new e.StructConn(C)}function C(t,r,n){var i=t.data.residues.secondaryStructureIndex;var o=t.data.secondaryStructure;var s=n.asymId,a=n.seqNumber,u=n.insCode,c=n.secondaryStructureIndex;var f=r.residues,l=r.operators;var h=f.length;var d=[];var p=0;while(p<h){var v=p;var m=i[f[p]],g=l[p];while(v<h&&l[v]==g&&i[f[v]]==m)v++;var y=o[m];var b=new e.SecondaryStructureElement(y.type,new e.PolyResidueIdentifier(s[p],a[p],u[p]),new e.PolyResidueIdentifier(s[v-1],a[v-1],u[v-1]),y.info);b.startResidueIndex=p;b.endResidueIndex=v;var _=d.length;for(var w=p;w<v;w++){c[w]=_}d[_]=b;p=v}return d}function x(t,r,n){var i=t.data.symmetryInfo;if(!i||i.cellSize[0]<1.1&&i.cellSize[1]<1.1&&i.cellSize[2]<1.1){return t}var o;if(!n)o=t.data.atoms.indices;else o=e.Query.apply(n,t).unionAtomIndices();var s=m(t,o),a=new e.Spacegroup(i),u=l(t,s,a,r);var c=g(u),f=y(u,c);return _(t,f,c)}n.buildPivotGroupSymmetry=x;function I(t,r){var n=s(t.positions,t.positions.indices);var u=new e.Spacegroup(t.data.symmetryInfo);var c=i.zero();var f=o.zero();var l=[];for(var h=-3;h<=3;h++){for(var d=-3;d<=3;d++){for(var v=-3;v<=3;v++){for(var m=0;m<u.operatorCount;m++){u.getOperatorMatrix(m,h,d,v,c);o.transformMat4(f,n.center,c);if(a(f,n.radius,n)>r)continue;var g=i.zero();i.copy(g,c);l.push(p(h,d,v,m,g))}}}}return l}function S(e,r){var n=e.data,i=n.atoms,o=n.chains,s=n.entities,a=n.residues;var u=t.Utils.ArrayBuilder.create(function(t){return new Int32Array(t)},a.count*r.length,1),c=t.Utils.ArrayBuilder.create(function(t){return new Int32Array(t)},a.count*r.length,1);var f=r.length*i.count;var l=r.length*o.count;var h=s.count;for(var d=0,p=s.count;d<p;d++){for(var v=0;v<r.length;v++){for(var m=s.chainStartIndex[d],g=s.chainEndIndex[d];m<g;m++){for(var y=o.residueStartIndex[m],b=o.residueEndIndex[m];y<b;y++){t.Utils.ArrayBuilder.add(u,y);t.Utils.ArrayBuilder.add(c,v)}}}}return{residues:u.array,operators:c.array,atomCount:f,chainCount:l,entityCount:h}}function A(t,e){var r=t.data.symmetryInfo;if(!r||r.cellSize[0]<1.1&&r.cellSize[1]<1.1&&r.cellSize[2]<1.1){return t}var n=I(t,e);var i=S(t,n);return _(t,i,n)}n.buildMates=A;function k(t,e,r,n){if(r<0){e[e.length]=n.slice(0);return}var i=t[r],o=i.length;for(var s=0;s<o;s++){n[r]=i[s];k(t,e,r-1,n)}}function E(t,e,r){var n=t.data.assemblyInfo;var o=[];var s=r;for(var a=0,u=e;a<u.length;a++){var c=u[a];var f=i.identity();for(var l=0;l<c.length;l++){i.mul(f,f,n.operators[c[l]].operator)}s++;o[o.length]=v(s,f)}return o}function P(e,r,n,i,o){var s=e.data,a=s.chains,u=s.entities,c=s.residues;var f=i.residueIndices,l=i.operatorIndices;var h=0,d=0,p=0;for(var v=0,m=u.count;v<m;v++){var g=o;var y=false;for(var b=0,_=n;b<_.length;b++){var w=_[b];for(var C=u.chainStartIndex[v],x=u.chainEndIndex[v];C<x;C++){var I=false;for(var S=a.residueStartIndex[C],A=a.residueEndIndex[C];S<A;S++){if(!r[S])continue;t.Utils.ChunkedArray.add(f,S);t.Utils.ChunkedArray.add(l,g);h+=c.atomEndIndex[S]-c.atomStartIndex[S];I=true}if(I){d+=1;y=true}}g++}if(y){p++}}i.atomCount+=h;i.chainCount+=d;i.entityCount+=p}function T(e,r,n){var i=[],o=[];for(var s=0;s<r.operators.length;s++)o[s]="";k(r.operators,i,r.operators.length-1,o);var a=n.transforms.length;var u=E(e,i,n.transforms.length);(p=n.transforms).push.apply(p,u);var c=t.Utils.FastSet.create();r.asymIds.forEach(function(t){return c.add(t)});var f=e.data.residues.asymId;var l=e.data.residues.count;var h=n.mask;for(var d=0;d<l;d++){h[d]=c.has(f[d])}P(e,h,u,n,a);var p}n.buildAssemblyEntry=T;function F(e,r){var n={atomCount:0,chainCount:0,entityCount:0,transforms:[],mask:new Int8Array(e.data.residues.count),residueIndices:t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},e.data.residues.count,1),operatorIndices:t.Utils.ChunkedArray.create(function(t){return new Int32Array(t)},e.data.residues.count,1)};for(var i=0,o=r.gens;i<o.length;i++){var s=o[i];T(e,s,n)}var a={residues:t.Utils.ChunkedArray.compact(n.residueIndices),operators:t.Utils.ChunkedArray.compact(n.operatorIndices),atomCount:n.atomCount,chainCount:n.chainCount,entityCount:n.entityCount};return _(e,a,n.transforms)}n.buildAssembly=F})(n||(n={}));function i(t,e,r){return n.buildPivotGroupSymmetry(t,e,r)}e.buildPivotGroupSymmetry=i;function o(t,e){return n.buildMates(t,e)}e.buildSymmetryMates=o;function s(t,e){return n.buildAssembly(t,e)}e.buildAssembly=s})(e=t.Structure||(t.Structure={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){var r;(function(e){function r(t,r){return e.Builder.toQuery(t)(r.queryContext)}e.apply=r;var n=function(){function e(t,e){this.mask=e;this.structure=t}Object.defineProperty(e.prototype,"atomCount",{get:function(){return this.mask.size},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"isComplete",{get:function(){return this.mask.size===this.structure.data.atoms.count},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"lookup3d",{get:function(){if(!this.lazyLoopup3d)this.makeLookup3d();return this.lazyLoopup3d},enumerable:true,configurable:true});e.prototype.hasAtom=function(t){return!!this.mask.has(t)};e.prototype.hasRange=function(t,e){for(var r=t;r<e;r++){if(this.mask.has(r))return true}return false};e.ofStructure=function(r){return new e(r,t.Utils.Mask.ofStructure(r))};e.ofFragments=function(r){return new e(r.context.structure,t.Utils.Mask.ofFragments(r))};e.ofAtomIndices=function(r,n){return new e(r,t.Utils.Mask.ofIndices(r.data.atoms.count,n))};e.prototype.makeLookup3d=function(){var e=new Int32Array(this.mask.size),r=0,n=this.structure.positions,i=n.x,o=n.y,s=n.z;for(var a=0,u=this.structure.positions.count;a<u;a++){if(this.mask.has(a))e[r++]=a}var c=t.Geometry.Query3D.createInputData(e,function(t,e){return e(i[t],o[t],s[t])});this.lazyLoopup3d=t.Geometry.Query3D.createSpatialHash(c)};return e}();e.Context=n;var i=function(){function r(t,e,r){this._hashCode=0;this._hashComputed=false;this.context=t;this.tag=e;this.atomIndices=r}Object.defineProperty(r.prototype,"hashCode",{get:function(){if(this._hashComputed)return this._hashCode;var t=23;for(var e=0,r=this.atomIndices;e<r.length;e++){var n=r[e];t=31*t+n|0}this._hashCode=t;this._hashComputed=true;return t},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"id",{get:function(){return this.context.structure.id+"_"+this.tag},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"atomCount",{get:function(){return this.atomIndices.length},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"isHet",{get:function(){var t=this.context.structure.data.atoms.residueIndex[this.tag];return this.context.structure.data.residues.isHet[t]},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"fingerprint",{get:function(){if(this._fingerprint)return this._fingerprint;var t=this.residueIndices,e=this.context.structure.data.residues,r=e.name,n=e.asymId,i=e.seqNumber,o=e.insCode,s=[];for(var a=0,u=t;a<u.length;a++){var c=u[a];var f=r[c]+" "+n[c]+" "+i[c];if(o[c])f+=" i:"+o[c];s[s.length]=f}return s.join("-")},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"authFingerprint",{get:function(){if(this._authFingerprint)return this._authFingerprint;var t=this.residueIndices,e=this.context.structure.data.residues,r=e.authName,n=e.authAsymId,i=e.authSeqNumber,o=e.insCode,s=[];for(var a=0,u=t;a<u.length;a++){var c=u[a];var f=r[c]+" "+n[c]+" "+i[c];if(o[c])f+=" i:"+o[c];s[s.length]=f}return s.join("-")},enumerable:true,configurable:true});r.prototype.find=function(t){var r=n.ofFragments(new o(this.context,[this]));return e.Builder.toQuery(t)(r)};r.prototype.computeIndices=function(){if(this._residueIndices)return;var e=t.Utils.FastSet.create(),r=t.Utils.FastSet.create(),n=t.Utils.FastSet.create(),i=this.context.structure.data.atoms.residueIndex,o=this.context.structure.data.residues.chainIndex,s=this.context.structure.data.chains.entityIndex;for(var a=0,u=this.atomIndices;a<u.length;a++){var c=u[a];e.add(i[c])}this._residueIndices=t.Utils.integerSetToSortedTypedArray(e);for(var f=0,l=this._residueIndices;f<l.length;f++){var c=l[f];r.add(o[c])}this._chainIndices=t.Utils.integerSetToSortedTypedArray(r);for(var h=0,d=this._chainIndices;h<d.length;h++){var c=d[h];n.add(s[c])}this._entityIndices=t.Utils.integerSetToSortedTypedArray(n)};Object.defineProperty(r.prototype,"residueIndices",{get:function(){this.computeIndices();return this._residueIndices},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"chainIndices",{get:function(){this.computeIndices();return this._chainIndices},enumerable:true,configurable:true});Object.defineProperty(r.prototype,"entityIndices",{get:function(){this.computeIndices();return this._entityIndices},enumerable:true,configurable:true});r.areEqual=function(t,e){if(t.atomCount!==e.atomCount)return false;var r=t.atomIndices,n=e.atomIndices;for(var i=0;i<r.length;i++){if(r[i]!==n[i])return false}return t.tag===e.tag};r.ofSet=function(t,e){var n=new Int32Array(e.size);e.forEach(function(t,e){e.array[e.index++]=t},{array:n,index:0});Array.prototype.sort.call(n,function(t,e){return t-e});return new r(t,n[0],n)};r.ofArray=function(t,e,n){return new r(t,e,n)};r.ofIndex=function(t,e){var n=new Int32Array(1);n[0]=e;return new r(t,e,n)};r.ofIndexRange=function(t,e,n){var i=0;for(var o=e;o<n;o++){if(t.hasAtom(o))i++}var s=new Int32Array(i),a=0;for(var o=e;o<n;o++){if(t.hasAtom(o))s[a++]=o}return new r(t,e,s)};return r}();e.Fragment=i;var o=function(){function t(t,e){this.context=t;this.fragments=e}t.empty=function(e){return new t(e,[])};Object.defineProperty(t.prototype,"length",{get:function(){return this.fragments.length},enumerable:true,configurable:true});t.prototype.unionAtomIndices=function(){if(!this.length)return[];if(this.length===1)return this.fragments[0].atomIndices;var t=new Int8Array(this.context.structure.data.atoms.count),e=0;for(var r=0,n=this.fragments;r<n.length;r++){var i=n[r];for(var o=0,s=i.atomIndices;o<s.length;o++){var a=s[o];t[a]=1}}for(var u=0,c=t;u<c.length;u++){var a=c[u];e+=a}var f=new Int32Array(e),l=0;for(var a=0,h=t.length;a<h;a++){if(t[a])f[l++]=a}return f};t.prototype.unionFragment=function(){if(!this.length)return new i(this.context,0,new Int32Array(0));if(this.length===1)return this.fragments[0];var t=this.unionAtomIndices();return new i(this.context,t[0],t)};return t}();e.FragmentSeq=o;var s=function(){function t(t){this.ctx=t;this.fragments=[]}t.prototype.add=function(t){this.fragments[this.fragments.length]=t};t.prototype.getSeq=function(){return new o(this.ctx,this.fragments)};return t}();e.FragmentSeqBuilder=s;var a=function(){function e(e){this.ctx=e;this.fragments=[];this.byHash=t.Utils.FastMap.create()}e.prototype.add=function(t){var e=t.hashCode;if(this.byHash.has(e)){var r=this.byHash.get(e);for(var n=0,o=r;n<o.length;n++){var s=o[n];if(i.areEqual(t,s))return this}this.fragments[this.fragments.length]=t;r[r.length]=t}else{this.fragments[this.fragments.length]=t;this.byHash.set(e,[t])}return this};e.prototype.getSeq=function(){return new o(this.ctx,this.fragments)};return e}();e.HashFragmentSeqBuilder=a})(r=e.Query||(e.Query={}))})(e=t.Structure||(t.Structure={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){var r;(function(e){var r;(function(t){t.BuilderPrototype={};function e(e,r){t.BuilderPrototype[e]=function(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return r.call.apply(r,[void 0,this].concat(t))}}t.registerModifier=e;function r(e){return Object.create(t.BuilderPrototype,{compile:{writable:false,configurable:false,value:e}})}t.build=r;function n(t){return!!t.compile}function i(t){if(typeof window==="undefined")throw"parse can only be called from a browser.";((function(){})(),eval)("with (LiteMol.Core.Structure.Query) { window.__LiteMol_query = "+t+"; }");var e=window.__LiteMol_query;window.__LiteMol_query=void 0;return e.compile()}t.parse=i;function o(t){var e;if(n(t))e=t.compile();else if(typeof t==="string"||t instanceof String)e=i(t);else e=t;return e}t.toQuery=o})(r=e.Builder||(e.Builder={}));function n(){return r.build(function(){return q.compileAllAtoms()})}e.allAtoms=n;function i(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return r.build(function(){return q.compileAtoms(t,function(t){return t.data.atoms.elementSymbol})})}e.atomsByElement=i;function o(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return r.build(function(){return q.compileAtoms(t,function(t){return t.data.atoms.name})})}e.atomsByName=o;function s(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return r.build(function(){return q.compileAtoms(t,function(t){return t.data.atoms.id})})}e.atomsById=s;function a(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return r.build(function(){return q.compileAtomRanges(false,t,function(t){return t.data.residues})})}e.residues=a;function u(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return r.build(function(){return q.compileAtomRanges(false,t,function(t){return t.data.chains})})}e.chains=u;function c(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return r.build(function(){return q.compileAtomRanges(false,t,function(t){return t.data.entities})})}e.entities=c;function f(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return r.build(function(){return q.compileAtomRanges(true,t,function(t){return t.data.entities})})}e.notEntities=f;function l(){return r.build(function(){return q.compileEverything()})}e.everything=l;function h(t){return r.build(function(){return q.compileFromIndices(false,t,function(t){return t.data.entities})})}e.entitiesFromIndices=h;function d(t){return r.build(function(){return q.compileFromIndices(false,t,function(t){return t.data.chains})})}e.chainsFromIndices=d;function p(t){return r.build(function(){return q.compileFromIndices(false,t,function(t){return t.data.residues})})}e.residuesFromIndices=p;function v(t){return r.build(function(){return q.compileAtomIndices(t)})}e.atomsFromIndices=v;function m(t,e,n,i){return r.build(function(){return q.compileSequence(t,e,n,i)})}e.sequence=m;function g(){return r.build(function(){return q.compileHetGroups()})}e.hetGroups=g;function y(){return r.build(function(){return q.compileNonHetPolymer()})}e.nonHetPolymer=y;function b(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return r.build(function(){return q.compilePolymerNames(t,false)})}e.polymerTrace=b;function _(){return I(r.build(function(){return q.compilePolymerNames(["CA","O","O5'","C3'","N3"],false)}),g(),c({type:"water"}))}e.cartoons=_;function w(){return r.build(function(){return q.compilePolymerNames(["N","CA","C","O","P","OP1","OP2","O3'","O5'","C3'","C5'","C4"],false)})}e.backbone=w;function C(){return r.build(function(){return q.compilePolymerNames(["N","CA","C","O","P","OP1","OP2","O3'","O5'","C3'","C5'","C4"],true)})}e.sidechain=C;function x(t,e){return r.build(function(){return q.compileAtomsInBox(t,e)})}e.atomsInBox=x;function I(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return r.build(function(){return q.compileOr(t)})}e.or=I;r.registerModifier("complement",S);function S(t){return r.build(function(){return q.compileComplement(t)})}e.complement=S;r.registerModifier("ambientResidues",A);function A(t,e){return r.build(function(){return q.compileAmbientResidues(t,e)})}e.ambientResidues=A;r.registerModifier("wholeResidues",k);function k(t){return r.build(function(){return q.compileWholeResidues(t)})}e.wholeResidues=k;r.registerModifier("union",E);function E(t){return r.build(function(){return q.compileUnion(t)})}e.union=E;r.registerModifier("inside",P);function P(t,e){return r.build(function(){return q.compileInside(t,e)})}e.inside=P;r.registerModifier("intersectWith",T);function T(t,e){return r.build(function(){return q.compileIntersectWith(t,e)})}e.intersectWith=T;r.registerModifier("flatten",F);function F(t,e){return r.build(function(){return q.compileFlatten(t,e)})}e.flatten=F;r.registerModifier("except",M);function M(t,e){return r.build(function(){return q.compileExcept(t,e)})}e.except=M;function D(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return a.apply(void 0,t.map(function(t){return{name:t}}))}e.residuesByName=D;function N(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return a.apply(void 0,t.map(function(t){return{authSeqNumber:t}}))}e.residuesById=N;function R(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}return u.apply(void 0,t.map(function(t){return{authAsymId:t}}))}e.chainsById=R;var q;(function(n){var i=function(){function t(t,e){this.columns=[];for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];if(t[i]!==void 0&&!!e[i]){this.columns.push({value:t[i],array:e[i]})}}}t.prototype.isSatisfied=function(t){for(var e=0,r=this.columns;e<r.length;e++){var n=r[e];if(n.value!==n.array[t])return false}return true};return t}();function o(){return function(t){if(t.isComplete){var r=t.structure.data.atoms.indices;return new e.FragmentSeq(t,[new e.Fragment(t,r[0],r)])}var n=new Int32Array(t.atomCount);var i=0;for(var o=0,s=t.structure.data.atoms.indices;o<s.length;o++){var a=s[o];if(t.hasAtom(a))n[i++]=a}return new e.FragmentSeq(t,[e.Fragment.ofArray(t,n[0],n)])}}n.compileEverything=o;function s(){return function(t){var r=new e.FragmentSeqBuilder(t);for(var n=0,i=t.structure.data.atoms.count;n<i;n++){if(t.hasAtom(n))r.add(e.Fragment.ofIndex(t,n))}return r.getSeq()}}n.compileAllAtoms=s;function a(r,n){return function(i){var o=t.Utils.FastSet.ofArray(r),s=n(i.structure),a=new e.FragmentSeqBuilder(i);for(var u=0,c=s.length;u<c;u++){if(i.hasAtom(u)&&o.has(s[u]))a.add(e.Fragment.ofIndex(i,u))}return a.getSeq()}}n.compileAtoms=a;function u(t){return function(r){var n=0;for(var i=0,o=t;i<o.length;i++){var s=o[i];if(r.hasAtom(s))n++}if(!n)return e.FragmentSeq.empty(r);if(n===t.length)return new e.FragmentSeq(r,[e.Fragment.ofArray(r,t[0],t)]);var a=0;var u=new Int32Array(n);for(var c=0,f=t;c<f.length;c++){var s=f[c];if(r.hasAtom(s))u[a++]=s}return new e.FragmentSeq(r,[e.Fragment.ofArray(r,u[0],u)])}}n.compileAtomIndices=u;function c(r,n,i){return function(o){var s=i(o.structure),a=s.atomStartIndex,u=s.atomEndIndex,c=new e.FragmentSeqBuilder(o);if(r){var f=t.Utils.FastSet.ofArray(n);var l=s.count;for(var h=0;h<l;h++){if(f.has(h))continue;if(!o.hasRange(a[h],u[h]))continue;c.add(e.Fragment.ofIndexRange(o,a[h],u[h]))}}else{for(var d=0,p=n;d<p.length;d++){var h=p[d];if(!o.hasRange(a[h],u[h]))continue;c.add(e.Fragment.ofIndexRange(o,a[h],u[h]))}}return c.getSeq()}}n.compileFromIndices=c;function f(t,r,n){return function(o){var s=n(o.structure),a=s.atomStartIndex,u=s.atomEndIndex,c=new e.FragmentSeqBuilder(o),f=s.count,l=false;var h=r.map(function(t){return new i(t,s)});var d=h.length===0;for(var p=0;p<f;p++){if(!o.hasRange(a[p],u[p]))continue;l=d;for(var v=0,m=h;v<m.length;v++){var g=m[v];if(g.isSatisfied(p)){l=true;break}}if(t)l=!l;if(l){c.add(e.Fragment.ofIndexRange(o,a[p],u[p]))}}return c.getSeq()}}n.compileAtomRanges=f;function l(t,r,n,o){return function(s){var a=s.structure.data,u=a.residues,c=a.chains,f=u.seqNumber,l=u.atomStartIndex,h=u.atomEndIndex,d=c.entityId,p=c.count,v=c.residueStartIndex,m=c.residueEndIndex,g=new e.FragmentSeqBuilder(s);var y=s.structure.parent,b=c.sourceChainIndex,_=y&&b;var w=typeof r==="string"?{asymId:r}:r;var C=new i(w,_?y.data.chains:c);for(var x=0;x<p;x++){if(d[x]!==t||!C.isSatisfied(_?b[x]:x)){continue}var I=v[x],S=m[x],A=-1,k=-1;for(;I<S;I++){if(f[I]>=n.seqNumber){A=I;break}}if(I===S)continue;for(I=A;I<S;I++){if(f[I]>=o.seqNumber){break}}k=I;if(s.hasRange(l[A],h[k])){g.add(e.Fragment.ofIndexRange(s,l[A],h[k]))}}return g.getSeq()}}n.compileSequence=l;function h(){return function(t){var r=t.structure.data.residues,n=r.atomStartIndex,i=r.atomEndIndex,o=r.isHet,s=r.entityIndex,a=r.count,u=t.structure.data.entities.type,c="water",f=new e.FragmentSeqBuilder(t);for(var l=0;l<a;l++){if(!t.hasRange(n[l],i[l]))continue;if(u[s[l]]===c)continue;if(o[l]){f.add(e.Fragment.ofIndexRange(t,n[l],i[l]))}}return f.getSeq()}}n.compileHetGroups=h;function d(){return function(t){var r=t.structure.data.residues,n=r.atomStartIndex,i=r.atomEndIndex,o=t.structure.data.entities,s=o.type,a=o.count,u=o.residueStartIndex,c=o.residueEndIndex,f="polymer",l=0;for(var h=0;h<a;h++){if(s[h]!==f)continue;for(var d=u[h],p=c[h];d<p;d++){for(var v=n[d],m=i[d];v<m;v++){if(t.hasAtom(v))l++}}}if(!l)return e.FragmentSeq.empty(t);var g=new Int32Array(l),y=0;for(var h=0;h<a;h++){if(s[h]!==f)continue;for(var d=u[h],p=c[h];d<p;d++){for(var v=n[d],m=i[d];v<m;v++){if(t.hasAtom(v))g[y++]=v}}}return new e.FragmentSeq(t,[e.Fragment.ofArray(t,g[0],g)])}}n.compileNonHetPolymer=d;function p(t,r){return function(n){var i=n.structure.positions,o=i.x,s=i.y,a=i.z,u=i.count,c=[];for(var f=0;f<u;f++){if(!n.hasAtom(f))continue;var l=o[f],h=s[f],d=a[f];if(l>=t.x&&l<=r.x&&h>=t.y&&h<=r.y&&d>=t.z&&d<=r.z){c[c.length]=f}}if(!c.length)return e.FragmentSeq.empty(n);return new e.FragmentSeq(n,[new e.Fragment(n,c[0],c)])}}n.compileAtomsInBox=p;function v(t,n){var i=r.toQuery(t);var o=r.toQuery(n);return function(t){return new e.FragmentSeq(t,i(e.Context.ofFragments(o(t))).fragments)}}n.compileInside=v;function m(t,r,n){var i=0;for(var o=0,s=r.atomIndices;o<s.length;o++){var a=s[o];if(n.has(a))i++}if(!i)return void 0;var u=new Int32Array(i);var c=0;for(var f=0,l=r.atomIndices;f<l.length;f++){var a=l[f];if(n.has(a))u[c++]=a}return e.Fragment.ofArray(t,u[0],u)}function g(n,i){var o=r.toQuery(n);var s=r.toQuery(i);return function(r){var n=o(r);var i=t.Utils.Mask.ofFragments(s(r));var a=new e.FragmentSeqBuilder(r);for(var u=0,c=n.fragments;u<c.length;u++){var f=c[u];var l=m(r,f,i);if(l)a.add(l)}return a.getSeq()}}n.compileIntersectWith=g;function y(t,n){var i=r.toQuery(t);return function(t){var r=i(t).fragments,o=new e.FragmentSeqBuilder(t),s;for(var a=0;a<r.length;a++){s=r[a];if(n(s))o.add(s)}return o.getSeq()}}n.compileFilter=y;function b(n){var i=r.toQuery(n);return function(r){var n=t.Utils.Mask.ofFragments(i(r)),o=0,s=0;for(var a=0,u=r.structure.data.atoms.count;a<u;a++){if(r.hasAtom(a)&&!n.has(a))o++}if(!o)return e.FragmentSeq.empty(r);var c=new Int32Array(o);for(var a=0,u=r.structure.data.atoms.count;a<u;a++){if(r.hasAtom(a)&&!n.has(a))c[s++]=a}return new e.FragmentSeq(r,[e.Fragment.ofArray(r,c[0],c)])}}n.compileComplement=b;function _(t){var n=t.map(function(t){return r.toQuery(t)});return function(t){var r=new e.HashFragmentSeqBuilder(t);for(var i=0,o=n;i<o.length;i++){var s=o[i];var a=s(t);for(var u=0,c=a.fragments;u<c.length;u++){var f=c[u];r.add(f)}}return r.getSeq()}}n.compileOr=_;function w(n){var i=r.toQuery(n);return function(r){var n=i(r).fragments,o=t.Utils.FastSet.create(),s=0,a;for(var u=0;u<n.length;u++){a=n[u].atomIndices;for(s=0;s<a.length;s++)o.add(a[s])}if(o.size===0)return e.FragmentSeq.empty(r);return new e.FragmentSeq(r,[e.Fragment.ofSet(r,o)])}}n.compileUnion=w;function C(r,n){return function(i){var o=i.structure,s=o.data.entities,a=o.data.atoms.name,u=[],c=0;var f=t.Utils.FastSet.ofArray(r);if(n){for(var l=0;l<o.data.entities.count;l++){if(s.type[l]!=="polymer")continue;var h=s.atomStartIndex[l],d=s.atomEndIndex[l];for(var p=h;p<d;p++){if(i.hasAtom(p)&&!f.has(a[p]))u[c++]=p}}}else{for(var l=0;l<s.count;l++){if(s.type[l]!=="polymer")continue;var h=s.atomStartIndex[l],d=s.atomEndIndex[l];for(var p=h;p<d;p++){if(i.hasAtom(p)&&f.has(a[p]))u[c++]=p}}}if(!u.length)return e.FragmentSeq.empty(i);return new e.FragmentSeq(i,[e.Fragment.ofArray(i,u[0],new Int32Array(u))])}}n.compilePolymerNames=C;function x(n,i){var o=r.toQuery(n);return function(r){var n=o(r),s=r.lookup3d(),a=new e.HashFragmentSeqBuilder(r),u=r.structure.positions,c=u.x,f=u.y,l=u.z,h=r.structure.data.atoms.residueIndex,d=r.structure.data.residues.atomStartIndex,p=r.structure.data.residues.atomEndIndex;for(var v=0,m=n.fragments;v<m.length;v++){var g=m[v];var y=t.Utils.FastSet.create();for(var b=0,_=g.atomIndices;b<_.length;b++){var w=_[b];y.add(h[w]);var C=s(c[w],f[w],l[w],i),x=C.elements,I=C.count;for(var S=0;S<I;S++){y.add(h[x[S]])}}var A={count:0,start:d,end:p};y.forEach(function(t,e){e.count+=e.end[t]-e.start[t]},A);var k=new Int32Array(A.count),E={indices:k,offset:0,start:d,end:p};y.forEach(function(t,e){for(var r=e.start[t],n=e.end[t];r<n;r++){e.indices[e.offset++]=r}},E);Array.prototype.sort.call(k,function(t,e){return t-e});a.add(e.Fragment.ofArray(r,k[0],k))}return a.getSeq()}}n.compileAmbientResidues=x;function I(n){var i=r.toQuery(n);return function(r){var n=i(r),o=new e.HashFragmentSeqBuilder(r),s=r.structure.data.atoms.residueIndex,a=r.structure.data.residues.atomStartIndex,u=r.structure.data.residues.atomEndIndex;for(var c=0,f=n.fragments;c<f.length;c++){var l=f[c];var h=t.Utils.FastSet.create();for(var d=0,p=l.atomIndices;d<p.length;d++){var v=p[d];h.add(s[v])}var m={count:0,start:a,end:u};h.forEach(function(t,e){e.count+=e.end[t]-e.start[t]},m);var g=new Int32Array(m.count),y={indices:g,offset:0,start:a,end:u};h.forEach(function(t,e){for(var r=e.start[t],n=e.end[t];r<n;r++){e.indices[e.offset++]=r}},y);Array.prototype.sort.call(g,function(t,e){return t-e});o.add(e.Fragment.ofArray(r,g[0],g))}return o.getSeq()}}n.compileWholeResidues=I;function S(t,n){var i=r.toQuery(t);return function(t){var r=i(t);var o=new e.HashFragmentSeqBuilder(t);for(var s=0,a=r.fragments;s<a.length;s++){var u=a[s];var c=n(u);for(var f=0,l=c.fragments;f<l.length;f++){var h=l[f];o.add(h)}}return o.getSeq()}}n.compileFlatten=S;function A(n,i){var o=r.toQuery(n);var s=r.toQuery(i);return function(r){var n=o(r);var i=t.Utils.Mask.ofFragments(s(r));var a=new e.HashFragmentSeqBuilder(r);for(var u=0,c=n.fragments;u<c.length;u++){var f=c[u];var l=0;for(var h=0,d=f.atomIndices;h<d.length;h++){var p=d[h];if(!i.has(p))l++}if(!l)continue;var v=new Int32Array(l);var m=0;for(var g=0,y=f.atomIndices;g<y.length;g++){var p=y[g];if(!i.has(p))v[m++]=p}a.add(e.Fragment.ofArray(r,v[0],v))}return a.getSeq()}}n.compileExcept=A})(q=e.Compiler||(e.Compiler={}))})(r=e.Query||(e.Query={}))})(e=t.Structure||(t.Structure={}))})(e=t.Core||(t.Core={}))})(a||(a={}));/*
 * Copyright (c) 2016 - now David Sehnal, licensed under Apache 2.0, See LICENSE file for more info.
 */
var a;(function(t){var e;(function(t){var e;(function(e){var r;(function(e){var r;(function(r){function n(t){return function(e){return function(r,n){return t(e(r,n))}}}function i(t){return function(e,r){return function(n,i){return t(e(n,i),r(n,i))}}}r.not=n(function(t){return!t});r.and=i(function(t,e){return t&&e});r.or=i(function(t,e){return t||e});var o=t.Utils.FastSet.ofArray(["N","CA","C","O","P","OP1","OP2","O3'","O5'","C3'","C5'","C4"]);r.backbone=function(t,e){return r.entityType(t,e)==="polymer"&&o.has(r.atomName(t,e))};r.sidechain=function(t,e){return r.entityType(t,e)==="polymer"&&!o.has(r.atomName(t,e))};function s(t){return function(e,r){return function(n,i){return t(e(n,i),r(n,i))}}}r.equal=s(function(t,e){return t===e});r.notEqual=s(function(t,e){return t!==e});r.greater=s(function(t,e){return t>e});r.lesser=s(function(t,e){return t<e});r.greaterEqual=s(function(t,e){return t>=e});r.lesserEqual=s(function(t,e){return t<=e});function a(t,e,r){return function(n,i){var o=t(n,i);return o>=e&&o<=r}}r.inRange=a;function u(t){return function(){return t}}r.value=u;function c(t,e,r){return function(n,i){var o=n.structure;return r(e(o))[t(o.data.atoms)[i]]}}r.residueSeqNumber=c(function(t){return t.residueIndex},function(t){return t.data.residues},function(t){return t.seqNumber});r.residueName=c(function(t){return t.residueIndex},function(t){return t.data.residues},function(t){return t.name});r.elementSymbol=c(function(t){return t.indices},function(t){return t.data.atoms},function(t){return t.elementSymbol});r.atomName=c(function(t){return t.indices},function(t){return t.data.atoms},function(t){return t.name});r.entityType=c(function(t){return t.entityIndex},function(t){return t.data.entities},function(t){return t.type});function f(t){return e.Builder.build(function(){return function(r){var n=[];for(var i=0,o=r.structure.data.atoms.count;i<o;i++){if(r.hasAtom(i)&&t(r,i))n[n.length]=i}if(!n.length)return e.FragmentSeq.empty(r);return new e.FragmentSeq(r,[e.Fragment.ofArray(r,n[0],new Int32Array(n))])}})}r.query=f})(r=e.Algebraic||(e.Algebraic={}))})(r=e.Query||(e.Query={}))})(e=t.Structure||(t.Structure={}))})(e=t.Core||(t.Core={}))})(a||(a={}));return a.Core};if(typeof module==="object"&&typeof module.exports==="object"){module.exports=__LiteMol_Core()}else if(typeof define==="function"&&define.amd){define(["require"],function(t){return __LiteMol_Core()})}else{var __target=!!window?window:this;if(!__target.LiteMol)__target.LiteMol={};__target.LiteMol.Core=__LiteMol_Core()}