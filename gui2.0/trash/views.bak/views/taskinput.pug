mixin folder(key)
	tr
		td=key['descr_short']
		td
			input.argument(
				id="key"+key['key']
				data-key=key['key']
				type="text"
			)
		td
			img(
				src="img/folder.png"
				onclick="fileselector.target = \'" + "key" + key['key'] + "\'; fileselector.action = fileselector.setValue; fileselector.showFolder(true)"
			)
		td
			img(
				src="img/help.png"
				onclick="taskselector.showHelp(" + key['descr_long'] + ")"
			)

mixin file(key)
	tr
		td=key['descr_short']
		td
			input.argument(
				id="key"+key['key']
				data-key=key['key']
				type="text"
			)
		td
			img(
				src="img/folder.png"
				onclick="fileselector.target = \'" + "key" + key['key'] + "\'; fileselector.action = fileselector.setValue; fileselector.show(true)"
			)
		td
			img(
				src="img/help.png"
				onclick="taskselector.showHelp(" + key['descr_long'] + ")"
			)

mixin check(key)
	tr
		td=key['descr_short']
		td
			input.argument(
				id="key"+key['key']
				type="checkbox"
			)
		td
		td
			img(
				src="img/help.png"
				onclick="taskselector.showHelp(" + key['descr_long'] + ")"
			)

mixin text(key)
	tr
		td=key['descr_short']
		td
			input.argument(
				id="key"+key['key']
				type="text"
			)
		td
		td
			img(
				src="img/help.png"
				onclick="taskselector.showHelp(" + key['descr_long'] + ")"
			)
		
mixin number(key)
	tr
		td=key['descr_short']
		td
			input.argument(
				id="key"+key['key']
				type="text"
			)
		td
		td
			img(
				src="img/help.png"
				onclick="taskselector.showHelp(" + key['descr_long'] + ")"
			)

mixin binary(key)
	tr
		td=key['descr_short']
		td
			select.argument(
				id="key"+key['key']
			)
				option(
					selected
					value=""
				)=""
				option(
					value="true"
				)="True"
				option(
					value="false"
				)="False"
		td
		td
			img(
				src="img/help.png"
				onclick="taskselector.showHelp(" + key['descr_long'] + ")"
			)

mixin multi(key)
	tr
		td=key['descr_short']
		td
			select.argument(
				id="key"+key['key']
			)
				option(
					selected
					value=""
				)=""
				for opt in key['options']
					option(
						value=opt
					)=opt
		td
		td
			img(
				src="img/help.png"
				onclick="taskselector.showHelp(" + key['descr_long'] + ")"
			)

div
	h="New Task - " + taskarray['moduletitle'] + " - " + taskarray['name']
	input#fnc(
		type="hidden"
		value=taskarray['executable']
	)
	input#mod(
		type="hidden"
		value=taskarray['modulename']
	)
	input#type(
		type="hidden"
		value=taskarray['name']
	)
	img#closebutton(
		src="img/close.png"
		onclick="taskselector.hide()"
	)

each page, index in taskarray['pages']
	div.inputpage(
		id="inputpage" + index
	)
		h=page["title"]
		table
			each key in page['keys']
				if key['keytype'] == "folder"
					+folder(key)
				else if key['keytype'] == "file"
					+file(key)
				else if key['keytype'] == "check"
					+check(key)
				else if key['keytype'] == "binary"
					+binary(key)
				else if key['keytype'] == "text" || key['keytype'] == "str"
					+text(key)
				else if key['keytype'] == "num"
					+number(key)
				else if key['keytype'] == "multi"
					+multi(key)
		if index != 0
			button(
				onclick="taskselector.changepage(" + (index - 1) + ")"
			)="Back"

		if index != (taskarray['pages'].length - 1)
			button(
				onclick="taskselector.changepage(" + (index + 1) + ")"
			)="Next"
			
		if index == (taskarray['pages'].length - 1)
			button(
				onclick="taskselector.startTask()"
			)="Start"	

if taskarray.widget
	div#widget(
		data-execute=taskarray['widget']['execute']
	)

	
